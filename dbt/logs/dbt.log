[0m15:12:08.725977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103919fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102407890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa3d90>]}


============================== 15:12:08.728290 | 251a4271-1620-402e-a5b8-a2b4aa0bdc2c ==============================
[0m15:12:08.728290 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m15:12:08.728520 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/nithya/Documents/Airflow/dbt/logs', 'log_cache_events': 'False', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'warn_error': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/nithya/Documents/Airflow/dbt', 'static_parser': 'True', 'no_print': 'None', 'target_path': 'None', 'quiet': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False'}
[0m15:12:08.838776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '251a4271-1620-402e-a5b8-a2b4aa0bdc2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dec770>]}
[0m15:12:08.848529 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:12:08.848802 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:12:08.850368 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15673913, "process_in_blocks": "0", "process_kernel_time": 0.101686, "process_mem_max_rss": "122585088", "process_out_blocks": "0", "process_user_time": 0.555324}
[0m15:12:08.850524 [debug] [MainThread]: Command `dbt deps` succeeded at 15:12:08.850488 after 0.16 seconds
[0m15:12:08.850638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ccf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051cd590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050cd150>]}
[0m15:12:08.850741 [debug] [MainThread]: Flushing usage events
[0m15:12:09.303900 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:00:06.561195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3faf1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ad0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b14b30>]}


============================== 02:00:06.564154 | 38f8a926-9606-48c6-beca-f79adbb0fe96 ==============================
[0m02:00:06.564154 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:00:06.564679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:00:06.567742 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m02:00:06.568321 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.0281765, "process_user_time": 0.984513, "process_kernel_time": 0.046881, "process_mem_max_rss": "219484", "process_in_blocks": "4608", "process_out_blocks": "1354", "command_success": false}
[0m02:00:06.568557 [debug] [MainThread]: Command `dbt run` failed at 02:00:06.568502 after 0.03 seconds
[0m02:00:06.568719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b14350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ad8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46efc80>]}
[0m02:00:06.568888 [debug] [MainThread]: Flushing usage events
[0m02:08:12.055341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8063d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8063e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8063fb30>]}


============================== 02:08:12.058342 | e3c21f84-e240-45b2-8b09-0f7e74cb2cf3 ==============================
[0m02:08:12.058342 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:08:12.058773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:08:12.419366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3c21f84-e240-45b2-8b09-0f7e74cb2cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80636570>]}
[0m02:08:12.449543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3c21f84-e240-45b2-8b09-0f7e74cb2cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b467230>]}
[0m02:08:12.449918 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m02:08:12.453304 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m02:08:12.453793 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:08:12.454100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e3c21f84-e240-45b2-8b09-0f7e74cb2cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b39eab0>]}
[0m02:08:13.009931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3c21f84-e240-45b2-8b09-0f7e74cb2cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5a94bbf0>]}
[0m02:08:13.015932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3c21f84-e240-45b2-8b09-0f7e74cb2cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b0a71a0>]}
[0m02:08:13.016241 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m02:08:13.016672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3c21f84-e240-45b2-8b09-0f7e74cb2cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5a94a660>]}
[0m02:08:13.017581 [info ] [MainThread]: 
[0m02:08:13.018070 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:08:13.018739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:08:13.024003 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:08:13.024385 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:08:13.024579 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:08:13.024978 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:08:13.025939 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:08:13.026148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:08:13.027034 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:08:13.027243 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:08:13.028517 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:08:13.028704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:08:13.028950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:08:15.714424 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:08:15.714800 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:08:15.715172 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:08:15.715811 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:08:15.716485 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:08:15.716711 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:08:15.716988 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:08:15.717246 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:08:15.717517 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:08:15.717804 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:08:15.718069 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:08:15.718297 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:08:15.718858 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:08:15.719114 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:08:15.719358 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:08:15.720209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:08:15.720678 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:08:15.720885 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:08:15.721089 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:08:15.721302 [info ] [MainThread]: 
[0m02:08:15.721678 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m02:08:15.721951 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "USER_DB_JACKAL"
  Database Error
    250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[0m02:08:15.722557 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6882327, "process_user_time": 3.322206, "process_kernel_time": 0.329792, "process_mem_max_rss": "231076", "process_in_blocks": "816", "process_out_blocks": "9181", "command_success": false}
[0m02:08:15.722876 [debug] [MainThread]: Command `dbt run` failed at 02:08:15.722806 after 3.69 seconds
[0m02:08:15.723107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853bb260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5a5b1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ad89580>]}
[0m02:08:15.723349 [debug] [MainThread]: Flushing usage events
[0m02:11:58.887951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2b7fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb16000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaddb4110>]}


============================== 02:11:58.890846 | db685e7e-66d1-48ac-afbf-4da6f5b293d1 ==============================
[0m02:11:58.890846 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:11:58.891130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:11:59.229668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db685e7e-66d1-48ac-afbf-4da6f5b293d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce36ff0>]}
[0m02:11:59.260347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db685e7e-66d1-48ac-afbf-4da6f5b293d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d45ecf0>]}
[0m02:11:59.263165 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m02:11:59.267452 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m02:11:59.297998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:11:59.298287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:11:59.301477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db685e7e-66d1-48ac-afbf-4da6f5b293d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cee3050>]}
[0m02:11:59.308126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db685e7e-66d1-48ac-afbf-4da6f5b293d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9b6a80>]}
[0m02:11:59.308370 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m02:11:59.308559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db685e7e-66d1-48ac-afbf-4da6f5b293d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d624770>]}
[0m02:11:59.309431 [info ] [MainThread]: 
[0m02:11:59.309820 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:11:59.310406 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:11:59.316267 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:11:59.316685 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:11:59.316946 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:11:59.317248 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:11:59.318439 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:11:59.318772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:11:59.319737 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:11:59.319924 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:11:59.321277 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:11:59.321731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:11:59.322138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:12:00.890509 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:12:00.891977 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:12:00.892330 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:12:00.892839 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:12:00.893203 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:12:00.893420 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:12:00.893663 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:12:00.893925 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:12:00.894207 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:12:00.894497 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:12:00.894756 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:12:00.894980 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:12:00.895575 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:12:00.895871 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:12:00.896125 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:12:00.896995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:12:00.897192 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:12:00.897384 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:12:00.897581 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:12:00.897800 [info ] [MainThread]: 
[0m02:12:00.898028 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m02:12:00.898470 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "USER_DB_JACKAL"
  Database Error
    250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[0m02:12:00.899172 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.031471, "process_user_time": 2.244701, "process_kernel_time": 0.128211, "process_mem_max_rss": "219356", "process_out_blocks": "1013", "command_success": false, "process_in_blocks": "0"}
[0m02:12:00.899736 [debug] [MainThread]: Command `dbt run` failed at 02:12:00.899659 after 2.03 seconds
[0m02:12:00.899967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae0f9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9f3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb06600>]}
[0m02:12:00.900200 [debug] [MainThread]: Flushing usage events
[0m02:15:27.194294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4bc2e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb496fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb490bb90>]}


============================== 02:15:27.198257 | ab64efc1-336f-4989-9d7a-b4ab4430204e ==============================
[0m02:15:27.198257 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:15:27.198704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:15:27.552958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab64efc1-336f-4989-9d7a-b4ab4430204e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb157e090>]}
[0m02:15:27.585968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab64efc1-336f-4989-9d7a-b4ab4430204e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb48773e0>]}
[0m02:15:27.586335 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m02:15:27.589849 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m02:15:27.607139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:15:27.607369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:15:27.609748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab64efc1-336f-4989-9d7a-b4ab4430204e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8e8260>]}
[0m02:15:27.615999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab64efc1-336f-4989-9d7a-b4ab4430204e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f46ec30>]}
[0m02:15:27.616238 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m02:15:27.616602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab64efc1-336f-4989-9d7a-b4ab4430204e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998319a0>]}
[0m02:15:27.617405 [info ] [MainThread]: 
[0m02:15:27.617813 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:15:27.618445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:15:27.623344 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:15:27.623697 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:15:27.623943 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:15:27.624268 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:15:27.625317 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:15:27.625523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:15:27.626690 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:15:27.626888 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:15:27.628114 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:15:27.628354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:15:27.628675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:15:29.267203 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:15:29.267894 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:15:29.268376 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:15:29.268783 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:15:29.269073 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:15:29.269362 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:15:29.269650 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:15:29.269927 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:15:29.270223 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:15:29.270525 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:15:29.270907 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:15:29.271164 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:15:29.271424 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:15:29.272072 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:15:29.272402 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:15:29.273339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:15:29.273559 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:15:29.273768 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:15:29.273967 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:15:29.274186 [info ] [MainThread]: 
[0m02:15:29.274585 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m02:15:29.274886 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "USER_DB_JACKAL"
  Database Error
    250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[0m02:15:29.275533 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1021976, "process_user_time": 2.280405, "process_kernel_time": 0.160993, "process_mem_max_rss": "219188", "process_out_blocks": "1013", "command_success": false, "process_in_blocks": "0"}
[0m02:15:29.275891 [debug] [MainThread]: Command `dbt run` failed at 02:15:29.275812 after 2.10 seconds
[0m02:15:29.276146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4cdb5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb46e6930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f6c9ac0>]}
[0m02:15:29.276406 [debug] [MainThread]: Flushing usage events
[0m02:25:34.931630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2575520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb299d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb24e0380>]}


============================== 02:25:34.934922 | c7226cc2-5710-4180-b5d4-27fdcd00af73 ==============================
[0m02:25:34.934922 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:25:34.935243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:25:34.936463 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'stock_analytics'
[0m02:25:34.936905 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.026238125, "process_user_time": 0.962552, "process_kernel_time": 0.047977, "process_mem_max_rss": "218164", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m02:25:34.937216 [debug] [MainThread]: Command `dbt run` failed at 02:25:34.937144 after 0.03 seconds
[0m02:25:34.937409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25752e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb249a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb72c7260>]}
[0m02:25:34.937582 [debug] [MainThread]: Flushing usage events
[0m02:27:51.151381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93025d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff934dd1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93409700>]}


============================== 02:27:51.154590 | e7b93872-2700-49cb-ad21-0025fd181338 ==============================
[0m02:27:51.154590 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:27:51.154897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:27:51.157873 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_TYPE'
[0m02:27:51.158423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.028004792, "process_user_time": 0.971107, "process_kernel_time": 0.029003, "process_mem_max_rss": "218168", "process_out_blocks": "18", "command_success": false, "process_in_blocks": "0"}
[0m02:27:51.158671 [debug] [MainThread]: Command `dbt run` failed at 02:27:51.158613 after 0.03 seconds
[0m02:27:51.158841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f4a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93456c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9305e030>]}
[0m02:27:51.159022 [debug] [MainThread]: Flushing usage events
[0m02:29:09.564337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa69402c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6919b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d4e4b0>]}


============================== 02:29:09.567725 | d3c8f321-3cdc-49c9-b0eb-6ce85e310201 ==============================
[0m02:29:09.567725 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:29:09.568200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:29:09.570811 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_TYPE'
[0m02:29:09.571304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.028732667, "process_user_time": 0.990104, "process_kernel_time": 0.052058, "process_mem_max_rss": "218184", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m02:29:09.571643 [debug] [MainThread]: Command `dbt run` failed at 02:29:09.571585 after 0.03 seconds
[0m02:29:09.571808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60531a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6cfe930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61b6de0>]}
[0m02:29:09.571978 [debug] [MainThread]: Flushing usage events
[0m02:31:52.413936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921ae330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff924fc560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff924ffc80>]}


============================== 02:31:52.418230 | 3c8ea782-eedf-46d9-8b95-793c312a9527 ==============================
[0m02:31:52.418230 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:31:52.418682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m02:31:52.421085 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_TYPE'
[0m02:31:52.421535 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.0287245, "process_user_time": 0.949309, "process_kernel_time": 0.046063, "process_mem_max_rss": "218168", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m02:31:52.421868 [debug] [MainThread]: Command `dbt run` failed at 02:31:52.421814 after 0.03 seconds
[0m02:31:52.422035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff926b0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92244e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9463f830>]}
[0m02:31:52.422204 [debug] [MainThread]: Flushing usage events
[0m02:35:23.420594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c36ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c66c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c66c140>]}


============================== 02:35:23.425484 | cb690a13-9f2b-4bac-ab30-424d2ef2d328 ==============================
[0m02:35:23.425484 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:35:23.426044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m02:35:23.768846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb690a13-9f2b-4bac-ab30-424d2ef2d328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81533350>]}
[0m02:35:23.799743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb690a13-9f2b-4bac-ab30-424d2ef2d328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76fbf3e0>]}
[0m02:35:23.800116 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m02:35:23.803601 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m02:35:23.809585 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:35:23.809880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cb690a13-9f2b-4bac-ab30-424d2ef2d328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76dce420>]}
[0m02:35:24.365515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb690a13-9f2b-4bac-ab30-424d2ef2d328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff765cd7f0>]}
[0m02:35:24.371999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb690a13-9f2b-4bac-ab30-424d2ef2d328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7709a8d0>]}
[0m02:35:24.372253 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m02:35:24.372601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb690a13-9f2b-4bac-ab30-424d2ef2d328', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76f89af0>]}
[0m02:35:24.373479 [info ] [MainThread]: 
[0m02:35:24.373950 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:35:24.374591 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:35:24.379657 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:35:24.379994 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:35:24.380216 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:35:24.380553 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:35:24.381460 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:35:24.381708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:24.382535 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:35:24.387243 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:35:24.388401 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:35:24.388825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:24.389054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:24.572064 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:35:24.572445 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:35:24.572767 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:35:24.573022 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:35:24.573325 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:35:24.574828 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:35:24.575144 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:35:24.575442 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:35:24.575702 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:35:24.575996 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:35:24.579713 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:35:24.579975 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:35:24.580252 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:35:24.580487 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:35:24.580771 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:35:24.581463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:35:24.581710 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:35:24.581935 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:35:24.582158 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:35:24.582405 [info ] [MainThread]: 
[0m02:35:24.582862 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m02:35:24.583190 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "USER_DB_JACKAL"
  Database Error
    250001 (08001): Failed to connect to DB: sfedu02-lvb17920.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m02:35:24.583764 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.184779, "process_user_time": 2.775444, "process_kernel_time": 0.126111, "process_mem_max_rss": "225196", "process_out_blocks": "3262", "command_success": false, "process_in_blocks": "0"}
[0m02:35:24.584086 [debug] [MainThread]: Command `dbt run` failed at 02:35:24.584011 after 1.19 seconds
[0m02:35:24.584344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c3c2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75950260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76f89af0>]}
[0m02:35:24.584607 [debug] [MainThread]: Flushing usage events
[0m02:39:44.019042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e8af650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d9f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e8af4a0>]}


============================== 02:39:44.022276 | ac4da7bf-4fb0-46a9-ac0a-8459756684e8 ==============================
[0m02:39:44.022276 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:39:44.022681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:39:44.387316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac4da7bf-4fb0-46a9-ac0a-8459756684e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e675cd0>]}
[0m02:39:44.421465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac4da7bf-4fb0-46a9-ac0a-8459756684e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d7495e0>]}
[0m02:39:44.421992 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m02:39:44.426312 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m02:39:44.433784 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:39:44.434281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac4da7bf-4fb0-46a9-ac0a-8459756684e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d5e6030>]}
[0m02:39:45.029205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac4da7bf-4fb0-46a9-ac0a-8459756684e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c3f42c0>]}
[0m02:39:45.035718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac4da7bf-4fb0-46a9-ac0a-8459756684e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c3f5a00>]}
[0m02:39:45.035986 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m02:39:45.036433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac4da7bf-4fb0-46a9-ac0a-8459756684e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d5063c0>]}
[0m02:39:45.037344 [info ] [MainThread]: 
[0m02:39:45.037798 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:39:45.038480 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:39:45.044009 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:39:45.044401 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:39:45.044651 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:39:45.044963 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:39:45.045941 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:39:45.046148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:45.047162 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:39:45.047391 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:39:45.048681 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:39:45.048934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:45.049187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:45.294701 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:39:45.295005 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:39:45.295259 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:39:45.295450 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:39:45.295661 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:39:45.324080 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:39:45.324350 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:39:45.324581 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:39:45.324763 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:39:45.324986 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:39:45.373205 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:39:45.373462 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:39:45.373672 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:39:45.373845 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:39:45.374058 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:39:45.374573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:39:45.374757 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:39:45.374936 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:39:45.375112 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:39:45.375303 [info ] [MainThread]: 
[0m02:39:45.375676 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m02:39:45.375953 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "USER_DB_JACKAL"
  Database Error
    250001 (08001): Failed to connect to DB: sfedu02-lvb17920.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
[0m02:39:45.376478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3796911, "process_user_time": 2.787847, "process_kernel_time": 0.109993, "process_mem_max_rss": "224740", "process_out_blocks": "3262", "command_success": false, "process_in_blocks": "0"}
[0m02:39:45.376792 [debug] [MainThread]: Command `dbt run` failed at 02:39:45.376735 after 1.38 seconds
[0m02:39:45.377000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e8f9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d5063c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c3c60c0>]}
[0m02:39:45.377229 [debug] [MainThread]: Flushing usage events
[0m02:40:19.355867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb136bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb187a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb179e180>]}


============================== 02:40:19.360186 | 79980c0c-f09f-474c-83a3-99f8cdb21351 ==============================
[0m02:40:19.360186 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:40:19.360613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:40:19.702780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79980c0c-f09f-474c-83a3-99f8cdb21351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9075b6b0>]}
[0m02:40:19.732620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79980c0c-f09f-474c-83a3-99f8cdb21351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91a36f90>]}
[0m02:40:19.732983 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m02:40:19.736133 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m02:40:19.752818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:40:19.753032 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:40:19.755568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79980c0c-f09f-474c-83a3-99f8cdb21351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91957e30>]}
[0m02:40:19.762160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79980c0c-f09f-474c-83a3-99f8cdb21351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf02e70>]}
[0m02:40:19.762394 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m02:40:19.762695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79980c0c-f09f-474c-83a3-99f8cdb21351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902a7530>]}
[0m02:40:19.763455 [info ] [MainThread]: 
[0m02:40:19.763847 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:40:19.764433 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:40:19.769301 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:40:19.769623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:40:19.769856 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:40:19.770173 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:40:19.771257 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:40:19.771481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:19.772403 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:40:19.772601 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:40:19.773848 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:40:19.774097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:19.774410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:20.029044 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:40:20.029981 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:40:20.030655 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:40:20.031157 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:40:20.031681 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:40:20.044041 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:40:20.044583 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:40:20.045108 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:40:20.045544 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:40:20.046082 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:40:20.079251 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:40:20.080080 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:40:20.080674 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m02:40:20.081080 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:40:20.081514 [debug] [ThreadPool]: On list_USER_DB_JACKAL: No close available on handle
[0m02:40:20.082884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:40:20.083373 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:40:20.083801 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:40:20.084193 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL' was properly closed.
[0m02:40:20.084665 [info ] [MainThread]: 
[0m02:40:20.085516 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m02:40:20.086315 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "USER_DB_JACKAL"
  Database Error
    250001 (08001): Failed to connect to DB: sfedu02-lvb17920.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
[0m02:40:20.087565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7528448, "process_user_time": 2.188552, "process_kernel_time": 0.085982, "process_mem_max_rss": "219448", "process_out_blocks": "1014", "command_success": false, "process_in_blocks": "0"}
[0m02:40:20.088200 [debug] [MainThread]: Command `dbt run` failed at 02:40:20.088052 after 0.75 seconds
[0m02:40:20.088650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb16f72c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf43b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb13ac560>]}
[0m02:40:20.089158 [debug] [MainThread]: Flushing usage events
[0m02:42:45.611351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff806f7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff806f4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff806f7080>]}


============================== 02:42:45.616620 | c0c563b9-103c-4366-82e5-6508c932481a ==============================
[0m02:42:45.616620 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:42:45.617081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:42:45.975921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0c563b9-103c-4366-82e5-6508c932481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65fc6450>]}
[0m02:42:46.006822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0c563b9-103c-4366-82e5-6508c932481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65f67d70>]}
[0m02:42:46.007188 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m02:42:46.010545 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m02:42:46.016114 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:42:46.016427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0c563b9-103c-4366-82e5-6508c932481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b462750>]}
[0m02:42:46.569258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0c563b9-103c-4366-82e5-6508c932481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5a17a780>]}
[0m02:42:46.575304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0c563b9-103c-4366-82e5-6508c932481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff59d3db50>]}
[0m02:42:46.575601 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m02:42:46.575934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0c563b9-103c-4366-82e5-6508c932481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b4610a0>]}
[0m02:42:46.576735 [info ] [MainThread]: 
[0m02:42:46.577133 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:42:46.577747 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:42:46.582785 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:42:46.583096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:42:46.583311 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:42:46.583672 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m02:42:46.584589 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:42:46.584794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:46.585632 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m02:42:46.585876 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:42:46.586944 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m02:42:46.587313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:46.587539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:47.001691 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m02:42:47.002810 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m02:42:47.003220 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m02:42:47.004420 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m02:42:47.005578 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m02:42:47.006915 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m02:42:47.225031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now create_USER_DB_JACKAL_ANALYTICS_staging)
[0m02:42:47.225499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now create_USER_DB_JACKAL_ANALYTICS_intermediate)
[0m02:42:47.225826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now create_USER_DB_JACKAL_ANALYTICS_marts)
[0m02:42:47.226173 [debug] [ThreadPool]: Creating schema "database: "USER_DB_JACKAL"
schema: "ANALYTICS_staging"
"
[0m02:42:47.226576 [debug] [ThreadPool]: Creating schema "database: "USER_DB_JACKAL"
schema: "ANALYTICS_intermediate"
"
[0m02:42:47.226939 [debug] [ThreadPool]: Creating schema "database: "USER_DB_JACKAL"
schema: "ANALYTICS_marts"
"
[0m02:42:47.229938 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_JACKAL_ANALYTICS_staging"
[0m02:42:47.231101 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m02:42:47.232155 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_JACKAL_ANALYTICS_marts"
[0m02:42:47.232400 [debug] [ThreadPool]: On create_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_USER_DB_JACKAL_ANALYTICS_staging"} */
create schema if not exists USER_DB_JACKAL.ANALYTICS_staging
[0m02:42:47.232613 [debug] [ThreadPool]: On create_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_USER_DB_JACKAL_ANALYTICS_intermediate"} */
create schema if not exists USER_DB_JACKAL.ANALYTICS_intermediate
[0m02:42:47.232811 [debug] [ThreadPool]: On create_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_USER_DB_JACKAL_ANALYTICS_marts"} */
create schema if not exists USER_DB_JACKAL.ANALYTICS_marts
[0m02:42:47.233048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:47.233245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:47.233440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:47.628681 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:47.630265 [debug] [ThreadPool]: On create_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m02:42:47.636208 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:47.637583 [debug] [ThreadPool]: On create_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m02:42:47.710596 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:47.712687 [debug] [ThreadPool]: On create_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m02:42:47.849325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_USER_DB_JACKAL_ANALYTICS_staging, now list_USER_DB_JACKAL_ANALYTICS_staging)
[0m02:42:47.850768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_USER_DB_JACKAL_ANALYTICS_intermediate, now list_USER_DB_JACKAL_snapshots)
[0m02:42:47.852134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_USER_DB_JACKAL_ANALYTICS_marts, now list_USER_DB_JACKAL_ANALYTICS_intermediate)
[0m02:42:47.854476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_marts'
[0m02:42:47.865641 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_snapshots"
[0m02:42:47.867100 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_staging"
[0m02:42:47.868955 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m02:42:47.870557 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_marts"
[0m02:42:47.870935 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_snapshots"} */
show terse objects in USER_DB_JACKAL.snapshots limit 10000
[0m02:42:47.871282 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_staging"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_staging limit 10000
[0m02:42:47.871604 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_intermediate"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_intermediate limit 10000
[0m02:42:47.871898 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_marts"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_marts limit 10000
[0m02:42:47.872192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:47.872482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:47.872751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:47.873017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:48.277954 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m02:42:48.281375 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m02:42:48.282461 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m02:42:48.285519 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m02:42:48.301806 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c098a2-0307-1dc4-000f-c0df008fb4f6
[0m02:42:48.302531 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m02:42:48.303171 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m02:42:48.303593 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:42:48.304075 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: Close
[0m02:42:48.327911 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m02:42:48.330337 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m02:42:48.441047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0c563b9-103c-4366-82e5-6508c932481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff59d8e4e0>]}
[0m02:42:48.441576 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:42:48.441992 [info ] [MainThread]: 
[0m02:42:48.446133 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_data
[0m02:42:48.446458 [info ] [Thread-1 (]: 1 of 4 START sql view model ANALYTICS_staging.stg_stock_data ................... [RUN]
[0m02:42:48.446888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_intermediate, now model.stock_analytics.stg_stock_data)
[0m02:42:48.447081 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_data
[0m02:42:48.450414 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_data"
[0m02:42:48.452035 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stg_stock_data (compile): 02:42:48.447227 => 02:42:48.451931
[0m02:42:48.452231 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_data
[0m02:42:48.463354 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_data"
[0m02:42:48.465088 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_data"
[0m02:42:48.465330 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_data"} */
create or replace   view USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
  
   as (
    

WITH source_data AS (
    SELECT
        symbol,
        date,
        open,
        high,
        low,
        close,
        volume
    FROM USER_DB_JACKAL.RAW.stock_data_lab
    WHERE date IS NOT NULL
        AND symbol IS NOT NULL
)

SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume,
    -- Add data quality flags
    CASE 
        WHEN open IS NULL OR high IS NULL OR low IS NULL OR close IS NULL 
        THEN TRUE 
        ELSE FALSE 
    END AS has_null_prices,
    -- Validate price relationships
    CASE 
        WHEN high < low 
            OR high < open 
            OR high < close 
            OR low > open 
            OR low > close 
        THEN TRUE 
        ELSE FALSE 
    END AS has_invalid_prices
FROM source_data
  );
[0m02:42:48.465564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:48.947824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:48.955905 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stg_stock_data (execute): 02:42:48.452387 => 02:42:48.955803
[0m02:42:48.959425 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_data: Close
[0m02:42:49.086153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0c563b9-103c-4366-82e5-6508c932481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff595cebd0>]}
[0m02:42:49.086591 [info ] [Thread-1 (]: 1 of 4 OK created sql view model ANALYTICS_staging.stg_stock_data .............. [[32mSUCCESS 1[0m in 0.64s]
[0m02:42:49.087108 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_data
[0m02:42:49.087633 [debug] [Thread-3 (]: Began running node model.stock_analytics.moving_averages
[0m02:42:49.087906 [debug] [Thread-4 (]: Began running node model.stock_analytics.rsi
[0m02:42:49.088216 [info ] [Thread-3 (]: 2 of 4 START sql table model ANALYTICS_intermediate.moving_averages ............ [RUN]
[0m02:42:49.088561 [info ] [Thread-4 (]: 3 of 4 START sql table model ANALYTICS_intermediate.rsi ........................ [RUN]
[0m02:42:49.088913 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_marts, now model.stock_analytics.moving_averages)
[0m02:42:49.089260 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_staging, now model.stock_analytics.rsi)
[0m02:42:49.089504 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.moving_averages
[0m02:42:49.089729 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.rsi
[0m02:42:49.092100 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.moving_averages"
[0m02:42:49.093471 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.rsi"
[0m02:42:49.094701 [debug] [Thread-3 (]: Timing info for model.stock_analytics.moving_averages (compile): 02:42:49.089877 => 02:42:49.094598
[0m02:42:49.094900 [debug] [Thread-4 (]: Timing info for model.stock_analytics.rsi (compile): 02:42:49.092274 => 02:42:49.094804
[0m02:42:49.095083 [debug] [Thread-3 (]: Began executing node model.stock_analytics.moving_averages
[0m02:42:49.095319 [debug] [Thread-4 (]: Began executing node model.stock_analytics.rsi
[0m02:42:49.103846 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.moving_averages"
[0m02:42:49.104998 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.rsi"
[0m02:42:49.106987 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.moving_averages"
[0m02:42:49.108013 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.rsi"
[0m02:42:49.108223 [debug] [Thread-3 (]: On model.stock_analytics.moving_averages: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.moving_averages"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
         as
        (

WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    WHERE has_null_prices = FALSE
        AND has_invalid_prices = FALSE
),

moving_averages AS (
    SELECT
        symbol,
        date,
        close,
        -- 7-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS sma_7,
        -- 14-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS sma_14,
        -- 30-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
        ) AS sma_30,
        -- 50-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS sma_50,
        -- Count of days for MA calculation validation
        COUNT(*) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS days_count
    FROM stock_data
)

SELECT
    symbol,
    date,
    close,
    ROUND(sma_7, 2) AS sma_7,
    ROUND(sma_14, 2) AS sma_14,
    ROUND(sma_30, 2) AS sma_30,
    ROUND(sma_50, 2) AS sma_50,
    -- Calculate crossover signals
    CASE 
        WHEN sma_7 > sma_14 THEN 'BULLISH_SHORT'
        WHEN sma_7 < sma_14 THEN 'BEARISH_SHORT'
        ELSE 'NEUTRAL'
    END AS signal_7_14,
    CASE 
        WHEN sma_14 > sma_30 THEN 'BULLISH_MED'
        WHEN sma_14 < sma_30 THEN 'BEARISH_MED'
        ELSE 'NEUTRAL'
    END AS signal_14_30,
    -- Price vs MA comparison
    ROUND(((close - sma_50) / NULLIF(sma_50, 0)) * 100, 2) AS pct_from_sma_50
FROM moving_averages
WHERE days_count >= 7  -- Ensure we have enough data for at least the shortest MA
        );
[0m02:42:49.108492 [debug] [Thread-4 (]: On model.stock_analytics.rsi: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.rsi"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_intermediate.rsi
         as
        (

WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    WHERE has_null_prices = FALSE
        AND has_invalid_prices = FALSE
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        close - LAG(close, 1) OVER (PARTITION BY symbol ORDER BY date) AS price_change
    FROM stock_data
),

gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
    WHERE price_change IS NOT NULL
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        gain,
        loss,
        -- 14-period average gain
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain_14,
        -- 14-period average loss
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss_14,
        -- Count periods for validation
        COUNT(*) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS period_count
    FROM gains_losses
),

rsi_calculation AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        avg_gain_14,
        avg_loss_14,
        period_count,
        -- Calculate RS (Relative Strength)
        CASE 
            WHEN avg_loss_14 = 0 THEN NULL
            ELSE avg_gain_14 / NULLIF(avg_loss_14, 0)
        END AS rs,
        -- Calculate RSI
        CASE 
            WHEN avg_loss_14 = 0 THEN 100
            WHEN avg_gain_14 = 0 THEN 0
            ELSE 100 - (100 / (1 + (avg_gain_14 / NULLIF(avg_loss_14, 0))))
        END AS rsi_14
    FROM average_gains_losses
    WHERE period_count >= 14  -- Ensure we have enough periods
)

SELECT
    symbol,
    date,
    close,
    ROUND(price_change, 2) AS price_change,
    ROUND(rsi_14, 2) AS rsi_14,
    -- RSI interpretation signals
    CASE 
        WHEN rsi_14 >= 70 THEN 'OVERBOUGHT'
        WHEN rsi_14 <= 30 THEN 'OVERSOLD'
        WHEN rsi_14 > 50 THEN 'BULLISH'
        WHEN rsi_14 < 50 THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS rsi_signal,
    -- RSI momentum
    CASE 
        WHEN rsi_14 > LAG(rsi_14, 1) OVER (PARTITION BY symbol ORDER BY date) 
        THEN 'INCREASING'
        WHEN rsi_14 < LAG(rsi_14, 1) OVER (PARTITION BY symbol ORDER BY date) 
        THEN 'DECREASING'
        ELSE 'FLAT'
    END AS rsi_momentum
FROM rsi_calculation
ORDER BY symbol, date
        );
[0m02:42:49.108756 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:42:49.108979 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:42:50.287409 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:42:50.291500 [debug] [Thread-3 (]: Timing info for model.stock_analytics.moving_averages (execute): 02:42:49.095493 => 02:42:50.291205
[0m02:42:50.292165 [debug] [Thread-3 (]: On model.stock_analytics.moving_averages: Close
[0m02:42:50.430678 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0c563b9-103c-4366-82e5-6508c932481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff595ce990>]}
[0m02:42:50.432015 [info ] [Thread-3 (]: 2 of 4 OK created sql table model ANALYTICS_intermediate.moving_averages ....... [[32mSUCCESS 1[0m in 1.34s]
[0m02:42:50.433648 [debug] [Thread-3 (]: Finished running node model.stock_analytics.moving_averages
[0m02:42:50.722941 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:42:50.730085 [debug] [Thread-4 (]: Timing info for model.stock_analytics.rsi (execute): 02:42:49.103985 => 02:42:50.729845
[0m02:42:50.730643 [debug] [Thread-4 (]: On model.stock_analytics.rsi: Close
[0m02:42:50.849600 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0c563b9-103c-4366-82e5-6508c932481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff58d3faa0>]}
[0m02:42:50.850789 [info ] [Thread-4 (]: 3 of 4 OK created sql table model ANALYTICS_intermediate.rsi ................... [[32mSUCCESS 1[0m in 1.76s]
[0m02:42:50.852335 [debug] [Thread-4 (]: Finished running node model.stock_analytics.rsi
[0m02:42:50.853901 [debug] [Thread-1 (]: Began running node model.stock_analytics.stock_analytics_mart
[0m02:42:50.854639 [info ] [Thread-1 (]: 4 of 4 START sql table model ANALYTICS_marts.stock_analytics_mart .............. [RUN]
[0m02:42:50.855989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_data, now model.stock_analytics.stock_analytics_mart)
[0m02:42:50.856482 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stock_analytics_mart
[0m02:42:50.860797 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stock_analytics_mart"
[0m02:42:50.862684 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stock_analytics_mart (compile): 02:42:50.856788 => 02:42:50.862486
[0m02:42:50.863061 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stock_analytics_mart
[0m02:42:50.865706 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stock_analytics_mart"
[0m02:42:50.868824 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stock_analytics_mart"
[0m02:42:50.869350 [debug] [Thread-1 (]: On model.stock_analytics.stock_analytics_mart: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stock_analytics_mart"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
         as
        (

WITH moving_averages AS (
    SELECT * FROM USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
),

rsi AS (
    SELECT * FROM USER_DB_JACKAL.ANALYTICS_intermediate.rsi
),

combined_analytics AS (
    SELECT
        ma.symbol,
        ma.date,
        ma.close,
        -- Moving Averages
        ma.sma_7,
        ma.sma_14,
        ma.sma_30,
        ma.sma_50,
        ma.signal_7_14,
        ma.signal_14_30,
        ma.pct_from_sma_50,
        -- RSI Indicators
        rsi.rsi_14,
        rsi.rsi_signal,
        rsi.rsi_momentum,
        rsi.price_change,
        -- Combined trading signal
        CASE
            WHEN rsi.rsi_14 <= 30 AND ma.signal_7_14 = 'BULLISH_SHORT' THEN 'STRONG_BUY'
            WHEN rsi.rsi_14 >= 70 AND ma.signal_7_14 = 'BEARISH_SHORT' THEN 'STRONG_SELL'
            WHEN rsi.rsi_14 < 40 AND ma.signal_14_30 = 'BULLISH_MED' THEN 'BUY'
            WHEN rsi.rsi_14 > 60 AND ma.signal_14_30 = 'BEARISH_MED' THEN 'SELL'
            WHEN rsi.rsi_14 BETWEEN 40 AND 60 THEN 'HOLD'
            ELSE 'NEUTRAL'
        END AS combined_signal,
        -- Volatility indicator (price % change)
        ROUND((rsi.price_change / NULLIF(ma.close - rsi.price_change, 0)) * 100, 2) AS daily_return_pct,
        -- Trend strength
        CASE
            WHEN ma.close > ma.sma_7 
                AND ma.sma_7 > ma.sma_14 
                AND ma.sma_14 > ma.sma_30 
            THEN 'STRONG_UPTREND'
            WHEN ma.close < ma.sma_7 
                AND ma.sma_7 < ma.sma_14 
                AND ma.sma_14 < ma.sma_30 
            THEN 'STRONG_DOWNTREND'
            WHEN ma.close > ma.sma_30 THEN 'UPTREND'
            WHEN ma.close < ma.sma_30 THEN 'DOWNTREND'
            ELSE 'SIDEWAYS'
        END AS trend_strength
    FROM moving_averages ma
    INNER JOIN rsi 
        ON ma.symbol = rsi.symbol 
        AND ma.date = rsi.date
)

SELECT
    symbol,
    date,
    close,
    sma_7,
    sma_14,
    sma_30,
    sma_50,
    rsi_14,
    signal_7_14,
    signal_14_30,
    rsi_signal,
    rsi_momentum,
    combined_signal,
    trend_strength,
    pct_from_sma_50,
    daily_return_pct,
    price_change
FROM combined_analytics
ORDER BY symbol, date DESC
        );
[0m02:42:50.869843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:51.916948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:42:51.920089 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stock_analytics_mart (execute): 02:42:50.863307 => 02:42:51.919891
[0m02:42:51.920574 [debug] [Thread-1 (]: On model.stock_analytics.stock_analytics_mart: Close
[0m02:42:52.054066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0c563b9-103c-4366-82e5-6508c932481a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff595c7d70>]}
[0m02:42:52.055374 [info ] [Thread-1 (]: 4 of 4 OK created sql table model ANALYTICS_marts.stock_analytics_mart ......... [[32mSUCCESS 1[0m in 1.20s]
[0m02:42:52.057147 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stock_analytics_mart
[0m02:42:52.060147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:52.060892 [debug] [MainThread]: Connection 'model.stock_analytics.stock_analytics_mart' was properly closed.
[0m02:42:52.061332 [debug] [MainThread]: Connection 'model.stock_analytics.rsi' was properly closed.
[0m02:42:52.061800 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL_snapshots' was properly closed.
[0m02:42:52.062202 [debug] [MainThread]: Connection 'model.stock_analytics.moving_averages' was properly closed.
[0m02:42:52.062855 [info ] [MainThread]: 
[0m02:42:52.064203 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m02:42:52.065665 [debug] [MainThread]: Command end result
[0m02:42:52.079192 [info ] [MainThread]: 
[0m02:42:52.080085 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:42:52.080824 [info ] [MainThread]: 
[0m02:42:52.081330 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:42:52.082531 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4929194, "process_user_time": 3.20569, "process_kernel_time": 0.167506, "process_mem_max_rss": "231268", "process_in_blocks": "8", "process_out_blocks": "4301"}
[0m02:42:52.083070 [debug] [MainThread]: Command `dbt run` succeeded at 02:42:52.082953 after 6.49 seconds
[0m02:42:52.083480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853bb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff806af500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b325c40>]}
[0m02:42:52.083903 [debug] [MainThread]: Flushing usage events
[0m02:42:54.522013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa76b9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa69a51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d99430>]}


============================== 02:42:54.524700 | 09287285-7c91-4920-92e7-c025e3553cae ==============================
[0m02:42:54.524700 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:42:54.525134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:42:54.882497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09287285-7c91-4920-92e7-c025e3553cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5a47e60>]}
[0m02:42:54.914102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09287285-7c91-4920-92e7-c025e3553cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94befda0>]}
[0m02:42:54.914518 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m02:42:54.917821 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m02:42:54.932733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:42:54.932943 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:42:54.935353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09287285-7c91-4920-92e7-c025e3553cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8477ac60>]}
[0m02:42:54.940528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09287285-7c91-4920-92e7-c025e3553cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845b6780>]}
[0m02:42:54.940752 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m02:42:54.941055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09287285-7c91-4920-92e7-c025e3553cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6cd65d0>]}
[0m02:42:54.941990 [info ] [MainThread]: 
[0m02:42:54.942421 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:42:54.943067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_marts'
[0m02:42:54.948921 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_marts"
[0m02:42:54.949300 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_staging'
[0m02:42:54.949556 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_marts"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_marts limit 10000
[0m02:42:54.949883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_snapshots'
[0m02:42:54.950930 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_staging"
[0m02:42:54.951252 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_intermediate'
[0m02:42:54.951516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:54.952603 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_snapshots"
[0m02:42:54.952797 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_staging"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_staging limit 10000
[0m02:42:54.953669 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m02:42:54.954999 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_snapshots"} */
show terse objects in USER_DB_JACKAL.snapshots limit 10000
[0m02:42:54.955230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:54.955478 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_intermediate"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_intermediate limit 10000
[0m02:42:54.955708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:54.956613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:55.335588 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:55.337365 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m02:42:55.338117 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:55.340437 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m02:42:55.343473 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c098a2-0307-1d01-000f-c0df008f37ba
[0m02:42:55.343848 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m02:42:55.344243 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m02:42:55.344546 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:42:55.344846 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: Close
[0m02:42:55.361661 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m02:42:55.362828 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m02:42:55.500502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09287285-7c91-4920-92e7-c025e3553cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59ac680>]}
[0m02:42:55.501981 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:42:55.503522 [info ] [MainThread]: 
[0m02:42:55.515185 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m02:42:55.516619 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m02:42:55.517097 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c
[0m02:42:55.517589 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_stock_data_symbol__AAPL__GOOG ........... [RUN]
[0m02:42:55.518103 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m02:42:55.518530 [info ] [Thread-2 (]: 2 of 17 START test accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL  [RUN]
[0m02:42:55.519086 [info ] [Thread-3 (]: 3 of 17 START test dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 ......... [RUN]
[0m02:42:55.520052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_staging, now test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976)
[0m02:42:55.520603 [info ] [Thread-4 (]: 4 of 17 START test dbt_utils_unique_combination_of_columns_moving_averages_symbol__date  [RUN]
[0m02:42:55.521305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_snapshots, now test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999)
[0m02:42:55.521985 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_intermediate, now test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c)
[0m02:42:55.522450 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m02:42:55.523104 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_marts, now test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81)
[0m02:42:55.523511 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m02:42:55.523924 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c
[0m02:42:55.535511 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m02:42:55.535872 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m02:42:55.540402 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m02:42:55.546733 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c (compile): 02:42:55.540630 => 02:42:55.546606
[0m02:42:55.547114 [debug] [Thread-4 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81 (compile): 02:42:55.543768 => 02:42:55.546986
[0m02:42:55.549287 [debug] [Thread-2 (]: Timing info for test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999 (compile): 02:42:55.536104 => 02:42:55.549138
[0m02:42:55.549602 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m02:42:55.550043 [debug] [Thread-1 (]: Timing info for test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976 (compile): 02:42:55.524217 => 02:42:55.549918
[0m02:42:55.550783 [debug] [Thread-4 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_moving_averages_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:42:55.551397 [debug] [Thread-3 (]: Compilation Error in test dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:42:55.561051 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m02:42:55.561288 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m02:42:55.561619 [error] [Thread-4 (]: 4 of 17 ERROR dbt_utils_unique_combination_of_columns_moving_averages_symbol__date  [[31mERROR[0m in 0.04s]
[0m02:42:55.562092 [error] [Thread-3 (]: 3 of 17 ERROR dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 .............. [[31mERROR[0m in 0.04s]
[0m02:42:55.563597 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m02:42:55.563939 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m02:42:55.564220 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c
[0m02:42:55.564629 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m02:42:55.565315 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m02:42:55.565552 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m02:42:55.565817 [info ] [Thread-4 (]: 5 of 17 START test dbt_utils_unique_combination_of_columns_rsi_symbol__date .... [RUN]
[0m02:42:55.566127 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        combined_signal as value_field,
        count(*) as n_records

    from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
    group by combined_signal

)

select *
from all_values
where value_field not in (
    'STRONG_BUY','BUY','HOLD','SELL','STRONG_SELL','NEUTRAL'
)



      
    ) dbt_internal_test
[0m02:42:55.566526 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m02:42:55.566727 [info ] [Thread-3 (]: 6 of 17 START test not_null_moving_averages_date ............................... [RUN]
[0m02:42:55.567156 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81, now test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830)
[0m02:42:55.567400 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:42:55.567636 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        symbol as value_field,
        count(*) as n_records

    from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    group by symbol

)

select *
from all_values
where value_field not in (
    'AAPL','GOOG'
)



      
    ) dbt_internal_test
[0m02:42:55.567994 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c, now test.stock_analytics.not_null_moving_averages_date.2eb91e4683)
[0m02:42:55.568216 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m02:42:55.569214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:55.569459 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m02:42:55.572193 [debug] [Thread-4 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830 (compile): 02:42:55.569641 => 02:42:55.572072
[0m02:42:55.575538 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m02:42:55.576751 [debug] [Thread-4 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:42:55.577056 [error] [Thread-4 (]: 5 of 17 ERROR dbt_utils_unique_combination_of_columns_rsi_symbol__date ......... [[31mERROR[0m in 0.01s]
[0m02:42:55.577427 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m02:42:55.577661 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m02:42:55.577894 [info ] [Thread-4 (]: 7 of 17 START test not_null_moving_averages_symbol ............................. [RUN]
[0m02:42:55.578135 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_moving_averages_date.2eb91e4683 (compile): 02:42:55.572749 => 02:42:55.578023
[0m02:42:55.578476 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830, now test.stock_analytics.not_null_moving_averages_symbol.153f328246)
[0m02:42:55.578734 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m02:42:55.578946 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m02:42:55.580226 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m02:42:55.581994 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m02:42:55.582761 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m02:42:55.582969 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_moving_averages_symbol.153f328246 (compile): 02:42:55.580387 => 02:42:55.582875
[0m02:42:55.583142 [debug] [Thread-3 (]: On test.stock_analytics.not_null_moving_averages_date.2eb91e4683: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
where date is null



      
    ) dbt_internal_test
[0m02:42:55.583349 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m02:42:55.583541 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:42:55.584680 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m02:42:55.585941 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m02:42:55.586236 [debug] [Thread-4 (]: On test.stock_analytics.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m02:42:55.586411 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:42:55.916027 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:55.920366 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_moving_averages_date.2eb91e4683 (execute): 02:42:55.579106 => 02:42:55.920084
[0m02:42:55.920859 [debug] [Thread-3 (]: On test.stock_analytics.not_null_moving_averages_date.2eb91e4683: Close
[0m02:42:55.945612 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:55.947542 [debug] [Thread-1 (]: Timing info for test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976 (execute): 02:42:55.562414 => 02:42:55.947298
[0m02:42:55.947977 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976: Close
[0m02:42:55.978233 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:55.980210 [debug] [Thread-2 (]: Timing info for test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999 (execute): 02:42:55.551549 => 02:42:55.979996
[0m02:42:55.980670 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999: Close
[0m02:42:56.049505 [info ] [Thread-3 (]: 6 of 17 PASS not_null_moving_averages_date ..................................... [[32mPASS[0m in 0.48s]
[0m02:42:56.050846 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m02:42:56.051679 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_rsi_date.da56752005
[0m02:42:56.052378 [info ] [Thread-3 (]: 8 of 17 START test not_null_rsi_date ........................................... [RUN]
[0m02:42:56.053725 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_moving_averages_date.2eb91e4683, now test.stock_analytics.not_null_rsi_date.da56752005)
[0m02:42:56.054312 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_rsi_date.da56752005
[0m02:42:56.061239 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_date.da56752005"
[0m02:42:56.062936 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_rsi_date.da56752005 (compile): 02:42:56.054669 => 02:42:56.062698
[0m02:42:56.063438 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_rsi_date.da56752005
[0m02:42:56.066262 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_date.da56752005"
[0m02:42:56.067725 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_date.da56752005"
[0m02:42:56.068168 [debug] [Thread-3 (]: On test.stock_analytics.not_null_rsi_date.da56752005: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_date.da56752005"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where date is null



      
    ) dbt_internal_test
[0m02:42:56.068639 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:42:56.073122 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:56.075456 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_moving_averages_symbol.153f328246 (execute): 02:42:55.583683 => 02:42:56.075212
[0m02:42:56.075862 [debug] [Thread-4 (]: On test.stock_analytics.not_null_moving_averages_symbol.153f328246: Close
[0m02:42:56.090406 [info ] [Thread-2 (]: 2 of 17 PASS accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL  [[32mPASS[0m in 0.57s]
[0m02:42:56.091224 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m02:42:56.091648 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m02:42:56.091988 [info ] [Thread-2 (]: 9 of 17 START test not_null_rsi_rsi_14 ......................................... [RUN]
[0m02:42:56.092682 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999, now test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899)
[0m02:42:56.093032 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m02:42:56.096417 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m02:42:56.097512 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899 (compile): 02:42:56.093254 => 02:42:56.097353
[0m02:42:56.097799 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m02:42:56.099540 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m02:42:56.100481 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m02:42:56.100780 [debug] [Thread-2 (]: On test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where rsi_14 is null



      
    ) dbt_internal_test
[0m02:42:56.101059 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:42:56.107315 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_stock_data_symbol__AAPL__GOOG ................. [[32mPASS[0m in 0.59s]
[0m02:42:56.107855 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m02:42:56.108142 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m02:42:56.108437 [info ] [Thread-1 (]: 10 of 17 START test not_null_rsi_symbol ........................................ [RUN]
[0m02:42:56.108985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976, now test.stock_analytics.not_null_rsi_symbol.21add3cf05)
[0m02:42:56.109229 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m02:42:56.111803 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m02:42:56.112445 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_rsi_symbol.21add3cf05 (compile): 02:42:56.109398 => 02:42:56.112327
[0m02:42:56.112657 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m02:42:56.115228 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m02:42:56.116107 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m02:42:56.116422 [debug] [Thread-1 (]: On test.stock_analytics.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where symbol is null



      
    ) dbt_internal_test
[0m02:42:56.116806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:56.187427 [info ] [Thread-4 (]: 7 of 17 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.61s]
[0m02:42:56.188023 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m02:42:56.188334 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m02:42:56.188646 [info ] [Thread-4 (]: 11 of 17 START test not_null_stg_stock_data_close .............................. [RUN]
[0m02:42:56.189160 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_moving_averages_symbol.153f328246, now test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db)
[0m02:42:56.189437 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m02:42:56.192096 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m02:42:56.192944 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db (compile): 02:42:56.189616 => 02:42:56.192801
[0m02:42:56.193202 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m02:42:56.194698 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m02:42:56.195470 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m02:42:56.195712 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where close is null



      
    ) dbt_internal_test
[0m02:42:56.195926 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:42:56.516916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:56.519633 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_rsi_symbol.21add3cf05 (execute): 02:42:56.112796 => 02:42:56.519326
[0m02:42:56.520200 [debug] [Thread-1 (]: On test.stock_analytics.not_null_rsi_symbol.21add3cf05: Close
[0m02:42:56.552992 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:56.556109 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899 (execute): 02:42:56.097994 => 02:42:56.555763
[0m02:42:56.556793 [debug] [Thread-2 (]: On test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899: Close
[0m02:42:56.562370 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:56.564239 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_rsi_date.da56752005 (execute): 02:42:56.063781 => 02:42:56.564027
[0m02:42:56.564693 [debug] [Thread-3 (]: On test.stock_analytics.not_null_rsi_date.da56752005: Close
[0m02:42:56.628048 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:56.631656 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db (execute): 02:42:56.193367 => 02:42:56.631228
[0m02:42:56.632580 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db: Close
[0m02:42:56.644333 [info ] [Thread-1 (]: 10 of 17 PASS not_null_rsi_symbol .............................................. [[32mPASS[0m in 0.54s]
[0m02:42:56.645629 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m02:42:56.646243 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m02:42:56.646738 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_stock_data_date ............................... [RUN]
[0m02:42:56.647667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_symbol.21add3cf05, now test.stock_analytics.not_null_stg_stock_data_date.96adead1a7)
[0m02:42:56.648103 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m02:42:56.653028 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m02:42:56.654437 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_date.96adead1a7 (compile): 02:42:56.648388 => 02:42:56.654236
[0m02:42:56.654801 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m02:42:56.657091 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m02:42:56.658310 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m02:42:56.658668 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_data_date.96adead1a7: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where date is null



      
    ) dbt_internal_test
[0m02:42:56.659002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:56.666903 [info ] [Thread-2 (]: 9 of 17 PASS not_null_rsi_rsi_14 ............................................... [[32mPASS[0m in 0.57s]
[0m02:42:56.667849 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m02:42:56.668239 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m02:42:56.668626 [info ] [Thread-2 (]: 13 of 17 START test not_null_stg_stock_data_symbol ............................. [RUN]
[0m02:42:56.669202 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899, now test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e)
[0m02:42:56.669876 [info ] [Thread-3 (]: 8 of 17 PASS not_null_rsi_date ................................................. [[32mPASS[0m in 0.62s]
[0m02:42:56.670187 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m02:42:56.670607 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_rsi_date.da56752005
[0m02:42:56.673410 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m02:42:56.673761 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m02:42:56.674183 [info ] [Thread-3 (]: 14 of 17 START test not_null_stock_analytics_mart_date ......................... [RUN]
[0m02:42:56.674720 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_date.da56752005, now test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b)
[0m02:42:56.674992 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m02:42:56.677443 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m02:42:56.677707 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e (compile): 02:42:56.670833 => 02:42:56.677589
[0m02:42:56.677980 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m02:42:56.679429 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m02:42:56.679857 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b (compile): 02:42:56.675251 => 02:42:56.679739
[0m02:42:56.680101 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m02:42:56.681614 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m02:42:56.681983 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m02:42:56.682276 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where symbol is null



      
    ) dbt_internal_test
[0m02:42:56.682511 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:42:56.684534 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m02:42:56.684841 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
where date is null



      
    ) dbt_internal_test
[0m02:42:56.685172 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:42:56.737491 [info ] [Thread-4 (]: 11 of 17 PASS not_null_stg_stock_data_close .................................... [[32mPASS[0m in 0.55s]
[0m02:42:56.738048 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m02:42:56.738350 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m02:42:56.738615 [info ] [Thread-4 (]: 15 of 17 START test not_null_stock_analytics_mart_symbol ....................... [RUN]
[0m02:42:56.739124 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db, now test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0)
[0m02:42:56.739400 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m02:42:56.741982 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m02:42:56.743240 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0 (compile): 02:42:56.739575 => 02:42:56.742896
[0m02:42:56.743725 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m02:42:56.746529 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m02:42:56.747387 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m02:42:56.747634 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
where symbol is null



      
    ) dbt_internal_test
[0m02:42:56.747883 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:42:57.159367 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:42:57.163538 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_date.96adead1a7 (execute): 02:42:56.655045 => 02:42:57.162626
[0m02:42:57.164554 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_data_date.96adead1a7: Close
[0m02:42:57.192615 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:42:57.195950 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b (execute): 02:42:56.680292 => 02:42:57.195623
[0m02:42:57.196598 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b: Close
[0m02:42:57.221888 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:42:57.224882 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e (execute): 02:42:56.678130 => 02:42:57.224554
[0m02:42:57.225493 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e: Close
[0m02:42:57.252200 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:42:57.255943 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0 (execute): 02:42:56.743997 => 02:42:57.255598
[0m02:42:57.256645 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0: Close
[0m02:42:57.274844 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_stock_data_date ..................................... [[32mPASS[0m in 0.63s]
[0m02:42:57.276736 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m02:42:57.277565 [debug] [Thread-1 (]: Began running node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m02:42:57.278231 [info ] [Thread-1 (]: 16 of 17 START test source_not_null_raw_stock_data_lab_date .................... [RUN]
[0m02:42:57.279810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_date.96adead1a7, now test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740)
[0m02:42:57.280619 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m02:42:57.287227 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m02:42:57.289478 [debug] [Thread-1 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740 (compile): 02:42:57.281233 => 02:42:57.289165
[0m02:42:57.289978 [debug] [Thread-1 (]: Began executing node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m02:42:57.292418 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m02:42:57.295013 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m02:42:57.295394 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.RAW.stock_data_lab
where date is null



      
    ) dbt_internal_test
[0m02:42:57.295861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:57.312335 [info ] [Thread-3 (]: 14 of 17 PASS not_null_stock_analytics_mart_date ............................... [[32mPASS[0m in 0.64s]
[0m02:42:57.313150 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m02:42:57.313552 [debug] [Thread-3 (]: Began running node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m02:42:57.313949 [info ] [Thread-3 (]: 17 of 17 START test source_not_null_raw_stock_data_lab_symbol .................. [RUN]
[0m02:42:57.314625 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b, now test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f)
[0m02:42:57.314948 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m02:42:57.318308 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m02:42:57.319438 [debug] [Thread-3 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f (compile): 02:42:57.315165 => 02:42:57.319240
[0m02:42:57.319778 [debug] [Thread-3 (]: Began executing node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m02:42:57.321651 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m02:42:57.322726 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m02:42:57.323048 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.RAW.stock_data_lab
where symbol is null



      
    ) dbt_internal_test
[0m02:42:57.323315 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:42:57.356233 [info ] [Thread-4 (]: 15 of 17 PASS not_null_stock_analytics_mart_symbol ............................. [[32mPASS[0m in 0.62s]
[0m02:42:57.356986 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m02:42:57.358069 [info ] [Thread-2 (]: 13 of 17 PASS not_null_stg_stock_data_symbol ................................... [[32mPASS[0m in 0.69s]
[0m02:42:57.358642 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m02:42:57.777525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:57.781809 [debug] [Thread-1 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740 (execute): 02:42:57.290290 => 02:42:57.781409
[0m02:42:57.782577 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740: Close
[0m02:42:57.786972 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:42:57.789427 [debug] [Thread-3 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f (execute): 02:42:57.320002 => 02:42:57.789166
[0m02:42:57.789917 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f: Close
[0m02:42:57.916432 [info ] [Thread-1 (]: 16 of 17 PASS source_not_null_raw_stock_data_lab_date .......................... [[32mPASS[0m in 0.64s]
[0m02:42:57.918164 [debug] [Thread-1 (]: Finished running node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m02:42:57.923527 [info ] [Thread-3 (]: 17 of 17 PASS source_not_null_raw_stock_data_lab_symbol ........................ [[32mPASS[0m in 0.61s]
[0m02:42:57.925395 [debug] [Thread-3 (]: Finished running node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m02:42:57.929091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:57.930715 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0' was properly closed.
[0m02:42:57.931366 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740' was properly closed.
[0m02:42:57.932371 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e' was properly closed.
[0m02:42:57.933057 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f' was properly closed.
[0m02:42:57.934163 [info ] [MainThread]: 
[0m02:42:57.935160 [info ] [MainThread]: Finished running 17 tests in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m02:42:57.937375 [debug] [MainThread]: Command end result
[0m02:42:57.946921 [info ] [MainThread]: 
[0m02:42:57.947440 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m02:42:57.947721 [info ] [MainThread]: 
[0m02:42:57.947992 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_moving_averages_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:42:57.948248 [info ] [MainThread]: 
[0m02:42:57.948503 [error] [MainThread]:   Compilation Error in test dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:42:57.948867 [info ] [MainThread]: 
[0m02:42:57.949163 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:42:57.949430 [info ] [MainThread]: 
[0m02:42:57.949706 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=3 SKIP=0 TOTAL=17
[0m02:42:57.950381 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.4499543, "process_user_time": 2.765586, "process_kernel_time": 0.10877, "process_mem_max_rss": "219932", "process_out_blocks": "2092", "command_success": false, "process_in_blocks": "0"}
[0m02:42:57.950771 [debug] [MainThread]: Command `dbt test` failed at 02:42:57.950681 after 3.45 seconds
[0m02:42:57.951073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5eb33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5ab8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84befce0>]}
[0m02:42:57.951388 [debug] [MainThread]: Flushing usage events
[0m04:09:56.072766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88adf140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b1e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88eca840>]}


============================== 04:09:56.076613 | 08ded21a-b49c-435d-8208-a5c5c418cde6 ==============================
[0m04:09:56.076613 [info ] [MainThread]: Running with dbt=1.7.19
[0m04:09:56.077152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:09:56.133127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08ded21a-b49c-435d-8208-a5c5c418cde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88addf40>]}
[0m04:09:56.133615 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m04:09:56.134740 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m04:09:56.135302 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.08713417, "process_user_time": 1.057676, "process_kernel_time": 0.044069, "process_mem_max_rss": "219368", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m04:09:56.135587 [debug] [MainThread]: Command `dbt deps` succeeded at 04:09:56.135519 after 0.09 seconds
[0m04:09:56.135804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d8c7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e2fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889b50d0>]}
[0m04:09:56.136043 [debug] [MainThread]: Flushing usage events
[0m04:09:59.213946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2bcc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4fc3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3034e00>]}


============================== 04:09:59.218982 | 7c2b4611-7e7a-4c79-990d-e33963684ac7 ==============================
[0m04:09:59.218982 [info ] [MainThread]: Running with dbt=1.7.19
[0m04:09:59.219742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:09:59.848478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c2b4611-7e7a-4c79-990d-e33963684ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821eb1a0>]}
[0m04:09:59.918611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c2b4611-7e7a-4c79-990d-e33963684ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c3f680>]}
[0m04:09:59.919619 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m04:09:59.927285 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m04:09:59.960538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:09:59.961010 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:09:59.967403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c2b4611-7e7a-4c79-990d-e33963684ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b305c0>]}
[0m04:09:59.979344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c2b4611-7e7a-4c79-990d-e33963684ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff816ea990>]}
[0m04:09:59.979928 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:09:59.980653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c2b4611-7e7a-4c79-990d-e33963684ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81817a40>]}
[0m04:09:59.982693 [info ] [MainThread]: 
[0m04:09:59.983689 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:09:59.985100 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m04:09:59.994578 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m04:09:59.998369 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m04:10:00.000719 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m04:10:00.001455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m04:10:00.001906 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m04:10:00.002360 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m04:10:00.004639 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m04:10:00.005549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:10:00.006009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:10:00.006467 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m04:10:00.010849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:10:00.573192 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m04:10:00.574238 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m04:10:00.574972 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m04:10:00.576851 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m04:10:00.578492 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m04:10:00.579958 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m04:10:00.738328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_ANALYTICS_staging)
[0m04:10:00.739480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_ANALYTICS_marts)
[0m04:10:00.746398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_ANALYTICS_intermediate)
[0m04:10:00.750469 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_staging"
[0m04:10:00.753689 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_marts"
[0m04:10:00.754524 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_snapshots'
[0m04:10:00.758081 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m04:10:00.758664 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_staging"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_staging limit 10000
[0m04:10:00.759224 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_marts"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_marts limit 10000
[0m04:10:00.761318 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_snapshots"
[0m04:10:00.761767 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_intermediate"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_intermediate limit 10000
[0m04:10:00.762216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:10:00.762678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:10:00.763123 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_snapshots"} */
show terse objects in USER_DB_JACKAL.snapshots limit 10000
[0m04:10:00.763556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:10:00.766940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:10:01.222646 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c0991e-0307-1cc8-000f-c0df008ff5e2
[0m04:10:01.223890 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m04:10:01.224706 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m04:10:01.225219 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:10:01.225868 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: Close
[0m04:10:01.230473 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m04:10:01.233028 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m04:10:01.268526 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:10:01.271737 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m04:10:01.272771 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:10:01.275565 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m04:10:01.404466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c2b4611-7e7a-4c79-990d-e33963684ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b1fe60>]}
[0m04:10:01.405792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:10:01.406732 [info ] [MainThread]: 
[0m04:10:01.415988 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_data
[0m04:10:01.416555 [info ] [Thread-1 (]: 1 of 4 START sql view model ANALYTICS_staging.stg_stock_data ................... [RUN]
[0m04:10:01.417347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_marts, now model.stock_analytics.stg_stock_data)
[0m04:10:01.417717 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_data
[0m04:10:01.425061 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_data"
[0m04:10:01.426498 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stg_stock_data (compile): 04:10:01.418061 => 04:10:01.426309
[0m04:10:01.426867 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_data
[0m04:10:01.448155 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_data"
[0m04:10:01.449951 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_data"
[0m04:10:01.450389 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_data"} */
create or replace   view USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
  
   as (
    

WITH source_data AS (
    SELECT
        symbol,
        date,
        open,
        high,
        low,
        close,
        volume
    FROM USER_DB_JACKAL.RAW.stock_data_lab
    WHERE date IS NOT NULL
        AND symbol IS NOT NULL
)

SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume,
    -- Add data quality flags
    CASE 
        WHEN open IS NULL OR high IS NULL OR low IS NULL OR close IS NULL 
        THEN TRUE 
        ELSE FALSE 
    END AS has_null_prices,
    -- Validate price relationships
    CASE 
        WHEN high < low 
            OR high < open 
            OR high < close 
            OR low > open 
            OR low > close 
        THEN TRUE 
        ELSE FALSE 
    END AS has_invalid_prices
FROM source_data
  );
[0m04:10:01.450742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:10:02.156015 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:10:02.180405 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stg_stock_data (execute): 04:10:01.427113 => 04:10:02.180163
[0m04:10:02.180966 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_data: Close
[0m04:10:02.342071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c2b4611-7e7a-4c79-990d-e33963684ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8166f500>]}
[0m04:10:02.343338 [info ] [Thread-1 (]: 1 of 4 OK created sql view model ANALYTICS_staging.stg_stock_data .............. [[32mSUCCESS 1[0m in 0.92s]
[0m04:10:02.344688 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_data
[0m04:10:02.345991 [debug] [Thread-3 (]: Began running node model.stock_analytics.moving_averages
[0m04:10:02.346588 [debug] [Thread-4 (]: Began running node model.stock_analytics.rsi
[0m04:10:02.347186 [info ] [Thread-3 (]: 2 of 4 START sql table model ANALYTICS_intermediate.moving_averages ............ [RUN]
[0m04:10:02.348017 [info ] [Thread-4 (]: 3 of 4 START sql table model ANALYTICS_intermediate.rsi ........................ [RUN]
[0m04:10:02.349018 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_snapshots, now model.stock_analytics.moving_averages)
[0m04:10:02.349948 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_intermediate, now model.stock_analytics.rsi)
[0m04:10:02.350517 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.moving_averages
[0m04:10:02.351042 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.rsi
[0m04:10:02.354891 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.moving_averages"
[0m04:10:02.357775 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.rsi"
[0m04:10:02.359704 [debug] [Thread-3 (]: Timing info for model.stock_analytics.moving_averages (compile): 04:10:02.351433 => 04:10:02.359500
[0m04:10:02.360046 [debug] [Thread-4 (]: Timing info for model.stock_analytics.rsi (compile): 04:10:02.355306 => 04:10:02.359894
[0m04:10:02.360360 [debug] [Thread-3 (]: Began executing node model.stock_analytics.moving_averages
[0m04:10:02.360775 [debug] [Thread-4 (]: Began executing node model.stock_analytics.rsi
[0m04:10:02.373516 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.moving_averages"
[0m04:10:02.376579 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.rsi"
[0m04:10:02.378943 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.moving_averages"
[0m04:10:02.380633 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.rsi"
[0m04:10:02.380982 [debug] [Thread-3 (]: On model.stock_analytics.moving_averages: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.moving_averages"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
         as
        (

WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    WHERE has_null_prices = FALSE
        AND has_invalid_prices = FALSE
),

moving_averages AS (
    SELECT
        symbol,
        date,
        close,
        -- 7-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS sma_7,
        -- 14-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS sma_14,
        -- 30-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
        ) AS sma_30,
        -- 50-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS sma_50,
        -- Count of days for MA calculation validation
        COUNT(*) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS days_count
    FROM stock_data
)

SELECT
    symbol,
    date,
    close,
    ROUND(sma_7, 2) AS sma_7,
    ROUND(sma_14, 2) AS sma_14,
    ROUND(sma_30, 2) AS sma_30,
    ROUND(sma_50, 2) AS sma_50,
    -- Calculate crossover signals
    CASE 
        WHEN sma_7 > sma_14 THEN 'BULLISH_SHORT'
        WHEN sma_7 < sma_14 THEN 'BEARISH_SHORT'
        ELSE 'NEUTRAL'
    END AS signal_7_14,
    CASE 
        WHEN sma_14 > sma_30 THEN 'BULLISH_MED'
        WHEN sma_14 < sma_30 THEN 'BEARISH_MED'
        ELSE 'NEUTRAL'
    END AS signal_14_30,
    -- Price vs MA comparison
    ROUND(((close - sma_50) / NULLIF(sma_50, 0)) * 100, 2) AS pct_from_sma_50
FROM moving_averages
WHERE days_count >= 7  -- Ensure we have enough data for at least the shortest MA
        );
[0m04:10:02.381443 [debug] [Thread-4 (]: On model.stock_analytics.rsi: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.rsi"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_intermediate.rsi
         as
        (

WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    WHERE has_null_prices = FALSE
        AND has_invalid_prices = FALSE
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        close - LAG(close, 1) OVER (PARTITION BY symbol ORDER BY date) AS price_change
    FROM stock_data
),

gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
    WHERE price_change IS NOT NULL
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        gain,
        loss,
        -- 14-period average gain
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain_14,
        -- 14-period average loss
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss_14,
        -- Count periods for validation
        COUNT(*) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS period_count
    FROM gains_losses
),

rsi_calculation AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        avg_gain_14,
        avg_loss_14,
        period_count,
        -- Calculate RS (Relative Strength)
        CASE 
            WHEN avg_loss_14 = 0 THEN NULL
            ELSE avg_gain_14 / NULLIF(avg_loss_14, 0)
        END AS rs,
        -- Calculate RSI
        CASE 
            WHEN avg_loss_14 = 0 THEN 100
            WHEN avg_gain_14 = 0 THEN 0
            ELSE 100 - (100 / (1 + (avg_gain_14 / NULLIF(avg_loss_14, 0))))
        END AS rsi_14
    FROM average_gains_losses
    WHERE period_count >= 14  -- Ensure we have enough periods
)

SELECT
    symbol,
    date,
    close,
    ROUND(price_change, 2) AS price_change,
    ROUND(rsi_14, 2) AS rsi_14,
    -- RSI interpretation signals
    CASE 
        WHEN rsi_14 >= 70 THEN 'OVERBOUGHT'
        WHEN rsi_14 <= 30 THEN 'OVERSOLD'
        WHEN rsi_14 > 50 THEN 'BULLISH'
        WHEN rsi_14 < 50 THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS rsi_signal,
    -- RSI momentum
    CASE 
        WHEN rsi_14 > LAG(rsi_14, 1) OVER (PARTITION BY symbol ORDER BY date) 
        THEN 'INCREASING'
        WHEN rsi_14 < LAG(rsi_14, 1) OVER (PARTITION BY symbol ORDER BY date) 
        THEN 'DECREASING'
        ELSE 'FLAT'
    END AS rsi_momentum
FROM rsi_calculation
ORDER BY symbol, date
        );
[0m04:10:02.381830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:10:02.382173 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:46:08.240456 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2166.0 seconds
[0m04:46:08.242397 [debug] [Thread-3 (]: Timing info for model.stock_analytics.moving_averages (execute): 04:10:02.361015 => 04:46:08.242268
[0m04:46:08.242683 [debug] [Thread-3 (]: On model.stock_analytics.moving_averages: Close
[0m04:46:08.364271 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c2b4611-7e7a-4c79-990d-e33963684ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5339370>]}
[0m04:46:08.364813 [info ] [Thread-3 (]: 2 of 4 OK created sql table model ANALYTICS_intermediate.moving_averages ....... [[32mSUCCESS 1[0m in 2166.02s]
[0m04:46:08.365423 [debug] [Thread-3 (]: Finished running node model.stock_analytics.moving_averages
[0m04:46:08.386610 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2166.0 seconds
[0m04:46:08.388572 [debug] [Thread-4 (]: Timing info for model.stock_analytics.rsi (execute): 04:10:02.373776 => 04:46:08.388441
[0m04:46:08.388908 [debug] [Thread-4 (]: On model.stock_analytics.rsi: Close
[0m04:46:08.497265 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c2b4611-7e7a-4c79-990d-e33963684ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801c2270>]}
[0m04:46:08.497831 [info ] [Thread-4 (]: 3 of 4 OK created sql table model ANALYTICS_intermediate.rsi ................... [[32mSUCCESS 1[0m in 2166.15s]
[0m04:46:08.498391 [debug] [Thread-4 (]: Finished running node model.stock_analytics.rsi
[0m04:46:08.499050 [debug] [Thread-1 (]: Began running node model.stock_analytics.stock_analytics_mart
[0m04:46:08.499410 [info ] [Thread-1 (]: 4 of 4 START sql table model ANALYTICS_marts.stock_analytics_mart .............. [RUN]
[0m04:46:08.499972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_data, now model.stock_analytics.stock_analytics_mart)
[0m04:46:08.500289 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stock_analytics_mart
[0m04:46:08.502743 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stock_analytics_mart"
[0m04:46:08.503737 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stock_analytics_mart (compile): 04:46:08.500478 => 04:46:08.503608
[0m04:46:08.503993 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stock_analytics_mart
[0m04:46:08.505584 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stock_analytics_mart"
[0m04:46:08.507205 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stock_analytics_mart"
[0m04:46:08.507523 [debug] [Thread-1 (]: On model.stock_analytics.stock_analytics_mart: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stock_analytics_mart"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
         as
        (

WITH moving_averages AS (
    SELECT * FROM USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
),

rsi AS (
    SELECT * FROM USER_DB_JACKAL.ANALYTICS_intermediate.rsi
),

combined_analytics AS (
    SELECT
        ma.symbol,
        ma.date,
        ma.close,
        -- Moving Averages
        ma.sma_7,
        ma.sma_14,
        ma.sma_30,
        ma.sma_50,
        ma.signal_7_14,
        ma.signal_14_30,
        ma.pct_from_sma_50,
        -- RSI Indicators
        rsi.rsi_14,
        rsi.rsi_signal,
        rsi.rsi_momentum,
        rsi.price_change,
        -- Combined trading signal
        CASE
            WHEN rsi.rsi_14 <= 30 AND ma.signal_7_14 = 'BULLISH_SHORT' THEN 'STRONG_BUY'
            WHEN rsi.rsi_14 >= 70 AND ma.signal_7_14 = 'BEARISH_SHORT' THEN 'STRONG_SELL'
            WHEN rsi.rsi_14 < 40 AND ma.signal_14_30 = 'BULLISH_MED' THEN 'BUY'
            WHEN rsi.rsi_14 > 60 AND ma.signal_14_30 = 'BEARISH_MED' THEN 'SELL'
            WHEN rsi.rsi_14 BETWEEN 40 AND 60 THEN 'HOLD'
            ELSE 'NEUTRAL'
        END AS combined_signal,
        -- Volatility indicator (price % change)
        ROUND((rsi.price_change / NULLIF(ma.close - rsi.price_change, 0)) * 100, 2) AS daily_return_pct,
        -- Trend strength
        CASE
            WHEN ma.close > ma.sma_7 
                AND ma.sma_7 > ma.sma_14 
                AND ma.sma_14 > ma.sma_30 
            THEN 'STRONG_UPTREND'
            WHEN ma.close < ma.sma_7 
                AND ma.sma_7 < ma.sma_14 
                AND ma.sma_14 < ma.sma_30 
            THEN 'STRONG_DOWNTREND'
            WHEN ma.close > ma.sma_30 THEN 'UPTREND'
            WHEN ma.close < ma.sma_30 THEN 'DOWNTREND'
            ELSE 'SIDEWAYS'
        END AS trend_strength
    FROM moving_averages ma
    INNER JOIN rsi 
        ON ma.symbol = rsi.symbol 
        AND ma.date = rsi.date
)

SELECT
    symbol,
    date,
    close,
    sma_7,
    sma_14,
    sma_30,
    sma_50,
    rsi_14,
    signal_7_14,
    signal_14_30,
    rsi_signal,
    rsi_momentum,
    combined_signal,
    trend_strength,
    pct_from_sma_50,
    daily_return_pct,
    price_change
FROM combined_analytics
ORDER BY symbol, date DESC
        );
[0m04:46:08.507806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:09.651671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:09.654182 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stock_analytics_mart (execute): 04:46:08.504163 => 04:46:09.654003
[0m04:46:09.654582 [debug] [Thread-1 (]: On model.stock_analytics.stock_analytics_mart: Close
[0m04:46:09.781620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c2b4611-7e7a-4c79-990d-e33963684ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801c38f0>]}
[0m04:46:09.782348 [info ] [Thread-1 (]: 4 of 4 OK created sql table model ANALYTICS_marts.stock_analytics_mart ......... [[32mSUCCESS 1[0m in 1.28s]
[0m04:46:09.783233 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stock_analytics_mart
[0m04:46:09.785071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:46:09.785450 [debug] [MainThread]: Connection 'model.stock_analytics.stock_analytics_mart' was properly closed.
[0m04:46:09.785772 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL_ANALYTICS_staging' was properly closed.
[0m04:46:09.786142 [debug] [MainThread]: Connection 'model.stock_analytics.rsi' was properly closed.
[0m04:46:09.786456 [debug] [MainThread]: Connection 'model.stock_analytics.moving_averages' was properly closed.
[0m04:46:09.786820 [info ] [MainThread]: 
[0m04:46:09.787276 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 36 minutes and 9.80 seconds (2169.80s).
[0m04:46:09.788044 [debug] [MainThread]: Command end result
[0m04:46:09.796954 [info ] [MainThread]: 
[0m04:46:09.797396 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:46:09.797758 [info ] [MainThread]: 
[0m04:46:09.798082 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:46:09.798904 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5842, "process_user_time": 3.244847, "process_kernel_time": 0.155519, "process_mem_max_rss": "219372", "process_out_blocks": "2047", "process_in_blocks": "0"}
[0m04:46:09.799376 [debug] [MainThread]: Command `dbt run` succeeded at 04:46:09.799250 after 6.58 seconds
[0m04:46:09.799736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c33ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff822e74a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81798410>]}
[0m04:46:09.800073 [debug] [MainThread]: Flushing usage events
[0m04:46:13.618353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9b0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cabad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915f6240>]}


============================== 04:46:13.623587 | 319ac95a-629f-4e8b-a3fd-5b5ea67bbd98 ==============================
[0m04:46:13.623587 [info ] [MainThread]: Running with dbt=1.7.19
[0m04:46:13.624261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:46:14.161067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '319ac95a-629f-4e8b-a3fd-5b5ea67bbd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67b9fef0>]}
[0m04:46:14.214057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '319ac95a-629f-4e8b-a3fd-5b5ea67bbd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d18ed20>]}
[0m04:46:14.214637 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m04:46:14.220308 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m04:46:14.244914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:46:14.245248 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:46:14.249827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '319ac95a-629f-4e8b-a3fd-5b5ea67bbd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff677c3a10>]}
[0m04:46:14.258523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '319ac95a-629f-4e8b-a3fd-5b5ea67bbd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff675668d0>]}
[0m04:46:14.258920 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:46:14.259365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '319ac95a-629f-4e8b-a3fd-5b5ea67bbd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b96570>]}
[0m04:46:14.261029 [info ] [MainThread]: 
[0m04:46:14.261683 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:46:14.262750 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_marts'
[0m04:46:14.269025 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_intermediate'
[0m04:46:14.273487 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_marts"
[0m04:46:14.275202 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m04:46:14.275784 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_snapshots'
[0m04:46:14.276194 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_marts"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_marts limit 10000
[0m04:46:14.276705 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_staging'
[0m04:46:14.277046 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_intermediate"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_intermediate limit 10000
[0m04:46:14.278716 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_snapshots"
[0m04:46:14.279100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:46:14.280685 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_staging"
[0m04:46:14.281011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:46:14.281329 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_snapshots"} */
show terse objects in USER_DB_JACKAL.snapshots limit 10000
[0m04:46:14.283274 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_staging"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_staging limit 10000
[0m04:46:14.284954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:46:14.285410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:46:15.165163 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m04:46:15.166060 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:15.166878 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:15.168299 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m04:46:15.170052 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m04:46:15.171505 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m04:46:15.177922 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c0991e-0307-1dc4-000f-c0df008fbb4a
[0m04:46:15.178304 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m04:46:15.178627 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m04:46:15.178901 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m04:46:15.179231 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: Close
[0m04:46:15.519315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '319ac95a-629f-4e8b-a3fd-5b5ea67bbd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d18ee70>]}
[0m04:46:15.520765 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:46:15.522042 [info ] [MainThread]: 
[0m04:46:15.533170 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m04:46:15.535595 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m04:46:15.536110 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c
[0m04:46:15.536580 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_stock_data_symbol__AAPL__GOOG ........... [RUN]
[0m04:46:15.537028 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m04:46:15.537431 [info ] [Thread-2 (]: 2 of 17 START test accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL  [RUN]
[0m04:46:15.537916 [info ] [Thread-3 (]: 3 of 17 START test dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 ......... [RUN]
[0m04:46:15.538674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_staging, now test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976)
[0m04:46:15.539095 [info ] [Thread-4 (]: 4 of 17 START test dbt_utils_unique_combination_of_columns_moving_averages_symbol__date  [RUN]
[0m04:46:15.539678 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_marts, now test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999)
[0m04:46:15.540227 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_intermediate, now test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c)
[0m04:46:15.540617 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m04:46:15.541220 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_snapshots, now test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81)
[0m04:46:15.541699 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m04:46:15.542056 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c
[0m04:46:15.551965 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m04:46:15.552221 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m04:46:15.556287 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m04:46:15.559254 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c (compile): 04:46:15.556515 => 04:46:15.559094
[0m04:46:15.562258 [debug] [Thread-4 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81 (compile): 04:46:15.559602 => 04:46:15.562041
[0m04:46:15.564035 [debug] [Thread-1 (]: Timing info for test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976 (compile): 04:46:15.542311 => 04:46:15.563897
[0m04:46:15.564362 [debug] [Thread-2 (]: Timing info for test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999 (compile): 04:46:15.552442 => 04:46:15.564189
[0m04:46:15.565010 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m04:46:15.565783 [debug] [Thread-3 (]: Compilation Error in test dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m04:46:15.566485 [debug] [Thread-4 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_moving_averages_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m04:46:15.566736 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m04:46:15.578100 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m04:46:15.578445 [error] [Thread-3 (]: 3 of 17 ERROR dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 .............. [[31mERROR[0m in 0.04s]
[0m04:46:15.578981 [error] [Thread-4 (]: 4 of 17 ERROR dbt_utils_unique_combination_of_columns_moving_averages_symbol__date  [[31mERROR[0m in 0.04s]
[0m04:46:15.580645 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m04:46:15.581175 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c
[0m04:46:15.581551 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m04:46:15.581988 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m04:46:15.582487 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m04:46:15.583121 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m04:46:15.583454 [info ] [Thread-3 (]: 5 of 17 START test dbt_utils_unique_combination_of_columns_rsi_symbol__date .... [RUN]
[0m04:46:15.583819 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        symbol as value_field,
        count(*) as n_records

    from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    group by symbol

)

select *
from all_values
where value_field not in (
    'AAPL','GOOG'
)



      
    ) dbt_internal_test
[0m04:46:15.584392 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m04:46:15.584649 [info ] [Thread-4 (]: 6 of 17 START test not_null_moving_averages_date ............................... [RUN]
[0m04:46:15.585204 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c, now test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830)
[0m04:46:15.585541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:15.585831 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        combined_signal as value_field,
        count(*) as n_records

    from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
    group by combined_signal

)

select *
from all_values
where value_field not in (
    'STRONG_BUY','BUY','HOLD','SELL','STRONG_SELL','NEUTRAL'
)



      
    ) dbt_internal_test
[0m04:46:15.586277 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81, now test.stock_analytics.not_null_moving_averages_date.2eb91e4683)
[0m04:46:15.586556 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m04:46:15.587679 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:46:15.588074 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m04:46:15.590568 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830 (compile): 04:46:15.588380 => 04:46:15.590429
[0m04:46:15.595528 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m04:46:15.596722 [debug] [Thread-3 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m04:46:15.597078 [error] [Thread-3 (]: 5 of 17 ERROR dbt_utils_unique_combination_of_columns_rsi_symbol__date ......... [[31mERROR[0m in 0.01s]
[0m04:46:15.597602 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m04:46:15.597963 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m04:46:15.598268 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_moving_averages_date.2eb91e4683 (compile): 04:46:15.591774 => 04:46:15.598107
[0m04:46:15.598568 [info ] [Thread-3 (]: 7 of 17 START test not_null_moving_averages_symbol ............................. [RUN]
[0m04:46:15.598976 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m04:46:15.599561 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830, now test.stock_analytics.not_null_moving_averages_symbol.153f328246)
[0m04:46:15.602078 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m04:46:15.602465 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m04:46:15.606222 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m04:46:15.607065 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m04:46:15.607406 [debug] [Thread-4 (]: On test.stock_analytics.not_null_moving_averages_date.2eb91e4683: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
where date is null



      
    ) dbt_internal_test
[0m04:46:15.607739 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:46:15.608083 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_moving_averages_symbol.153f328246 (compile): 04:46:15.602754 => 04:46:15.607916
[0m04:46:15.609355 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m04:46:15.611345 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m04:46:15.613952 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m04:46:15.614301 [debug] [Thread-3 (]: On test.stock_analytics.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m04:46:15.614571 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:46:16.379390 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:16.381458 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:16.382477 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:16.392275 [debug] [Thread-2 (]: Timing info for test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999 (execute): 04:46:15.579222 => 04:46:16.391752
[0m04:46:16.395299 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_moving_averages_date.2eb91e4683 (execute): 04:46:15.599769 => 04:46:16.394972
[0m04:46:16.398007 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_moving_averages_symbol.153f328246 (execute): 04:46:15.609576 => 04:46:16.397747
[0m04:46:16.398546 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999: Close
[0m04:46:16.399025 [debug] [Thread-4 (]: On test.stock_analytics.not_null_moving_averages_date.2eb91e4683: Close
[0m04:46:16.399486 [debug] [Thread-3 (]: On test.stock_analytics.not_null_moving_averages_symbol.153f328246: Close
[0m04:46:16.571453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:16.573324 [debug] [Thread-1 (]: Timing info for test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976 (execute): 04:46:15.566953 => 04:46:16.573114
[0m04:46:16.573786 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976: Close
[0m04:46:16.643916 [info ] [Thread-3 (]: 7 of 17 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 1.04s]
[0m04:46:16.646001 [info ] [Thread-4 (]: 6 of 17 PASS not_null_moving_averages_date ..................................... [[32mPASS[0m in 1.06s]
[0m04:46:16.646738 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m04:46:16.647992 [info ] [Thread-2 (]: 2 of 17 PASS accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL  [[32mPASS[0m in 1.11s]
[0m04:46:16.648915 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m04:46:16.649540 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_rsi_date.da56752005
[0m04:46:16.650187 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m04:46:16.650711 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m04:46:16.651221 [info ] [Thread-3 (]: 8 of 17 START test not_null_rsi_date ........................................... [RUN]
[0m04:46:16.651896 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m04:46:16.652380 [info ] [Thread-4 (]: 9 of 17 START test not_null_rsi_rsi_14 ......................................... [RUN]
[0m04:46:16.653220 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_moving_averages_symbol.153f328246, now test.stock_analytics.not_null_rsi_date.da56752005)
[0m04:46:16.653718 [info ] [Thread-2 (]: 10 of 17 START test not_null_rsi_symbol ........................................ [RUN]
[0m04:46:16.654486 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_moving_averages_date.2eb91e4683, now test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899)
[0m04:46:16.654861 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_rsi_date.da56752005
[0m04:46:16.655469 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999, now test.stock_analytics.not_null_rsi_symbol.21add3cf05)
[0m04:46:16.655825 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m04:46:16.657059 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m04:46:16.660724 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_date.da56752005"
[0m04:46:16.663947 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m04:46:16.666973 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m04:46:16.668639 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_rsi_date.da56752005 (compile): 04:46:16.656076 => 04:46:16.668480
[0m04:46:16.668940 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899 (compile): 04:46:16.661037 => 04:46:16.668806
[0m04:46:16.669220 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_rsi_date.da56752005
[0m04:46:16.669563 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_rsi_symbol.21add3cf05 (compile): 04:46:16.664224 => 04:46:16.669420
[0m04:46:16.669798 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m04:46:16.671488 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_date.da56752005"
[0m04:46:16.671767 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m04:46:16.673312 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m04:46:16.675073 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m04:46:16.675660 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_date.da56752005"
[0m04:46:16.675908 [debug] [Thread-3 (]: On test.stock_analytics.not_null_rsi_date.da56752005: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_date.da56752005"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where date is null



      
    ) dbt_internal_test
[0m04:46:16.676175 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:46:16.677042 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m04:46:16.677918 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m04:46:16.678193 [debug] [Thread-2 (]: On test.stock_analytics.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where symbol is null



      
    ) dbt_internal_test
[0m04:46:16.678558 [debug] [Thread-4 (]: On test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where rsi_14 is null



      
    ) dbt_internal_test
[0m04:46:16.678940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:46:16.679185 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:46:16.754728 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_stock_data_symbol__AAPL__GOOG ................. [[32mPASS[0m in 1.22s]
[0m04:46:16.755458 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m04:46:16.755858 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m04:46:16.756223 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_stock_data_close .............................. [RUN]
[0m04:46:16.756952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976, now test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db)
[0m04:46:16.757346 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m04:46:16.760704 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m04:46:16.761700 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db (compile): 04:46:16.757591 => 04:46:16.761546
[0m04:46:16.762008 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m04:46:16.763870 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m04:46:16.765395 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m04:46:16.765735 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where close is null



      
    ) dbt_internal_test
[0m04:46:16.766010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:17.385748 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:17.386570 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:17.388564 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_rsi_symbol.21add3cf05 (execute): 04:46:16.673762 => 04:46:17.388327
[0m04:46:17.390282 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_rsi_date.da56752005 (execute): 04:46:16.670000 => 04:46:17.390081
[0m04:46:17.390753 [debug] [Thread-2 (]: On test.stock_analytics.not_null_rsi_symbol.21add3cf05: Close
[0m04:46:17.391174 [debug] [Thread-3 (]: On test.stock_analytics.not_null_rsi_date.da56752005: Close
[0m04:46:17.511876 [info ] [Thread-2 (]: 10 of 17 PASS not_null_rsi_symbol .............................................. [[32mPASS[0m in 0.86s]
[0m04:46:17.513555 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m04:46:17.514628 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m04:46:17.515380 [info ] [Thread-2 (]: 12 of 17 START test not_null_stg_stock_data_date ............................... [RUN]
[0m04:46:17.516526 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_symbol.21add3cf05, now test.stock_analytics.not_null_stg_stock_data_date.96adead1a7)
[0m04:46:17.516766 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m04:46:17.521453 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m04:46:17.522922 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_date.96adead1a7 (compile): 04:46:17.516944 => 04:46:17.522725
[0m04:46:17.523310 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m04:46:17.525516 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m04:46:17.526883 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m04:46:17.527302 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_data_date.96adead1a7: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where date is null



      
    ) dbt_internal_test
[0m04:46:17.527564 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:46:17.530857 [info ] [Thread-3 (]: 8 of 17 PASS not_null_rsi_date ................................................. [[32mPASS[0m in 0.88s]
[0m04:46:17.531513 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_rsi_date.da56752005
[0m04:46:17.531974 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m04:46:17.532411 [info ] [Thread-3 (]: 13 of 17 START test not_null_stg_stock_data_symbol ............................. [RUN]
[0m04:46:17.533103 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_date.da56752005, now test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e)
[0m04:46:17.533469 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m04:46:17.536573 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m04:46:17.537446 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e (compile): 04:46:17.533658 => 04:46:17.537299
[0m04:46:17.537719 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m04:46:17.539492 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m04:46:17.540378 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m04:46:17.540668 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where symbol is null



      
    ) dbt_internal_test
[0m04:46:17.540923 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:46:17.589311 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:17.590699 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899 (execute): 04:46:16.671951 => 04:46:17.590551
[0m04:46:17.590978 [debug] [Thread-4 (]: On test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899: Close
[0m04:46:17.636535 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:17.638138 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db (execute): 04:46:16.762214 => 04:46:17.637966
[0m04:46:17.638514 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db: Close
[0m04:46:17.717641 [info ] [Thread-4 (]: 9 of 17 PASS not_null_rsi_rsi_14 ............................................... [[32mPASS[0m in 1.06s]
[0m04:46:17.718538 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m04:46:17.719027 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m04:46:17.719490 [info ] [Thread-4 (]: 14 of 17 START test not_null_stock_analytics_mart_date ......................... [RUN]
[0m04:46:17.720328 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899, now test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b)
[0m04:46:17.720741 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m04:46:17.724633 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m04:46:17.725822 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b (compile): 04:46:17.721017 => 04:46:17.725650
[0m04:46:17.726181 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m04:46:17.728309 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m04:46:17.729366 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m04:46:17.729707 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
where date is null



      
    ) dbt_internal_test
[0m04:46:17.730046 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:46:17.756626 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_stock_data_close .................................... [[32mPASS[0m in 1.00s]
[0m04:46:17.757386 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m04:46:17.757800 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m04:46:17.758139 [info ] [Thread-1 (]: 15 of 17 START test not_null_stock_analytics_mart_symbol ....................... [RUN]
[0m04:46:17.758791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db, now test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0)
[0m04:46:17.759118 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m04:46:17.762413 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m04:46:17.763407 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0 (compile): 04:46:17.759357 => 04:46:17.763232
[0m04:46:17.763724 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m04:46:17.765520 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m04:46:17.766320 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m04:46:17.766582 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
where symbol is null



      
    ) dbt_internal_test
[0m04:46:17.766823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:18.176354 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:46:18.180608 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b (execute): 04:46:17.726431 => 04:46:18.179971
[0m04:46:18.181612 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b: Close
[0m04:46:18.208027 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:18.211654 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_date.96adead1a7 (execute): 04:46:17.523558 => 04:46:18.211231
[0m04:46:18.212480 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_data_date.96adead1a7: Close
[0m04:46:18.243467 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:46:18.247718 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0 (execute): 04:46:17.763939 => 04:46:18.247155
[0m04:46:18.250659 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0: Close
[0m04:46:18.256447 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:18.260665 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e (execute): 04:46:17.537905 => 04:46:18.260274
[0m04:46:18.261406 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e: Close
[0m04:46:18.324847 [info ] [Thread-4 (]: 14 of 17 PASS not_null_stock_analytics_mart_date ............................... [[32mPASS[0m in 0.60s]
[0m04:46:18.326615 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m04:46:18.327361 [debug] [Thread-4 (]: Began running node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m04:46:18.327999 [info ] [Thread-4 (]: 16 of 17 START test source_not_null_raw_stock_data_lab_date .................... [RUN]
[0m04:46:18.329435 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b, now test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740)
[0m04:46:18.330065 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m04:46:18.337419 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m04:46:18.339277 [debug] [Thread-4 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740 (compile): 04:46:18.330567 => 04:46:18.339013
[0m04:46:18.339737 [debug] [Thread-4 (]: Began executing node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m04:46:18.344652 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m04:46:18.345994 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m04:46:18.346362 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.RAW.stock_data_lab
where date is null



      
    ) dbt_internal_test
[0m04:46:18.346687 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:46:18.366392 [info ] [Thread-2 (]: 12 of 17 PASS not_null_stg_stock_data_date ..................................... [[32mPASS[0m in 0.85s]
[0m04:46:18.367394 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m04:46:18.367842 [debug] [Thread-2 (]: Began running node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m04:46:18.368233 [info ] [Thread-2 (]: 17 of 17 START test source_not_null_raw_stock_data_lab_symbol .................. [RUN]
[0m04:46:18.368943 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_date.96adead1a7, now test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f)
[0m04:46:18.369330 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m04:46:18.373321 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m04:46:18.374556 [debug] [Thread-2 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f (compile): 04:46:18.369850 => 04:46:18.374371
[0m04:46:18.374883 [debug] [Thread-2 (]: Began executing node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m04:46:18.376800 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m04:46:18.377835 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m04:46:18.378174 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.RAW.stock_data_lab
where symbol is null



      
    ) dbt_internal_test
[0m04:46:18.378477 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:46:18.403916 [info ] [Thread-3 (]: 13 of 17 PASS not_null_stg_stock_data_symbol ................................... [[32mPASS[0m in 0.87s]
[0m04:46:18.404511 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m04:46:18.425008 [info ] [Thread-1 (]: 15 of 17 PASS not_null_stock_analytics_mart_symbol ............................. [[32mPASS[0m in 0.67s]
[0m04:46:18.425481 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m04:46:18.825785 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:46:18.829825 [debug] [Thread-2 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f (execute): 04:46:18.375110 => 04:46:18.829361
[0m04:46:18.830837 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f: Close
[0m04:46:18.869472 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:18.872653 [debug] [Thread-4 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740 (execute): 04:46:18.340033 => 04:46:18.872317
[0m04:46:18.873367 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740: Close
[0m04:46:18.968388 [info ] [Thread-2 (]: 17 of 17 PASS source_not_null_raw_stock_data_lab_symbol ........................ [[32mPASS[0m in 0.60s]
[0m04:46:18.969587 [debug] [Thread-2 (]: Finished running node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m04:46:19.020876 [info ] [Thread-4 (]: 16 of 17 PASS source_not_null_raw_stock_data_lab_date .......................... [[32mPASS[0m in 0.69s]
[0m04:46:19.022076 [debug] [Thread-4 (]: Finished running node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m04:46:19.024394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:46:19.024812 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f' was properly closed.
[0m04:46:19.025176 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e' was properly closed.
[0m04:46:19.025553 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740' was properly closed.
[0m04:46:19.025900 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0' was properly closed.
[0m04:46:19.026317 [info ] [MainThread]: 
[0m04:46:19.026877 [info ] [MainThread]: Finished running 17 tests in 0 hours 0 minutes and 4.76 seconds (4.76s).
[0m04:46:19.028912 [debug] [MainThread]: Command end result
[0m04:46:19.037688 [info ] [MainThread]: 
[0m04:46:19.038128 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m04:46:19.038410 [info ] [MainThread]: 
[0m04:46:19.038673 [error] [MainThread]:   Compilation Error in test dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m04:46:19.038922 [info ] [MainThread]: 
[0m04:46:19.039177 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_moving_averages_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m04:46:19.039505 [info ] [MainThread]: 
[0m04:46:19.039743 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m04:46:19.039989 [info ] [MainThread]: 
[0m04:46:19.040249 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=3 SKIP=0 TOTAL=17
[0m04:46:19.040847 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.459939, "process_user_time": 3.601052, "process_kernel_time": 0.181385, "process_mem_max_rss": "219636", "process_out_blocks": "2076", "command_success": false, "process_in_blocks": "0"}
[0m04:46:19.041208 [debug] [MainThread]: Command `dbt test` failed at 04:46:19.041125 after 5.46 seconds
[0m04:46:19.041492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd99220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67690590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca47aa0>]}
[0m04:46:19.041716 [debug] [MainThread]: Flushing usage events
[0m05:09:32.086805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fb78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a3e7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4b1430>]}


============================== 05:09:32.092421 | b723ba7e-d62d-41a8-8b4e-fa91a0fd850d ==============================
[0m05:09:32.092421 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:09:32.092883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:09:32.139280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b723ba7e-d62d-41a8-8b4e-fa91a0fd850d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e4d8e0>]}
[0m05:09:32.139679 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:09:32.140665 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:09:32.141160 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.07654762, "process_user_time": 0.976509, "process_kernel_time": 0.056029, "process_mem_max_rss": "219372", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m05:09:32.141397 [debug] [MainThread]: Command `dbt deps` succeeded at 05:09:32.141341 after 0.08 seconds
[0m05:09:32.141577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a045ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f6ade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f6b290>]}
[0m05:09:32.141784 [debug] [MainThread]: Flushing usage events
[0m05:09:34.590703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8383c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff823f1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b864b0>]}


============================== 05:09:34.593415 | 94085cf5-5ebd-40a4-b0d3-51ef25fbb665 ==============================
[0m05:09:34.593415 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:09:34.593858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:09:34.914117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94085cf5-5ebd-40a4-b0d3-51ef25fbb665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6094aa50>]}
[0m05:09:34.943065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94085cf5-5ebd-40a4-b0d3-51ef25fbb665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60aa4290>]}
[0m05:09:34.943385 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m05:09:34.946471 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:09:34.962488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:34.962683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:34.964960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94085cf5-5ebd-40a4-b0d3-51ef25fbb665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b34770>]}
[0m05:09:34.970456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94085cf5-5ebd-40a4-b0d3-51ef25fbb665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff606e6a80>]}
[0m05:09:34.970688 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:09:34.971018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94085cf5-5ebd-40a4-b0d3-51ef25fbb665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff609a6060>]}
[0m05:09:34.971810 [info ] [MainThread]: 
[0m05:09:34.972194 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:09:34.972813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m05:09:34.977720 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m05:09:34.978074 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m05:09:34.978242 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m05:09:34.978649 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m05:09:34.979612 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m05:09:34.979837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:34.980960 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m05:09:34.981180 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m05:09:34.982386 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m05:09:34.982595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:34.982847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:35.384899 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m05:09:35.386701 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m05:09:35.393184 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m05:09:35.394345 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m05:09:35.645145 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m05:09:35.648189 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m05:09:35.761109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_ANALYTICS_marts)
[0m05:09:35.768826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_ANALYTICS_intermediate)
[0m05:09:35.773596 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_marts"
[0m05:09:35.774692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_snapshots)
[0m05:09:35.777148 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m05:09:35.778120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_staging'
[0m05:09:35.778530 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_marts"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_marts limit 10000
[0m05:09:35.780458 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_snapshots"
[0m05:09:35.780899 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_intermediate"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_intermediate limit 10000
[0m05:09:35.782718 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_staging"
[0m05:09:35.783139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:09:35.783517 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_snapshots"} */
show terse objects in USER_DB_JACKAL.snapshots limit 10000
[0m05:09:35.783853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:09:35.784197 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_staging"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_staging limit 10000
[0m05:09:35.785286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:09:35.788528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:36.138021 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:36.141767 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m05:09:36.155827 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:36.158487 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m05:09:36.163300 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:09:36.165463 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m05:09:36.193769 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c09935-0307-1dc6-000f-c0df008fccb6
[0m05:09:36.194538 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m05:09:36.195195 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m05:09:36.195919 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:09:36.196520 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: Close
[0m05:09:36.313165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94085cf5-5ebd-40a4-b0d3-51ef25fbb665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dfe8710>]}
[0m05:09:36.315132 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:09:36.316671 [info ] [MainThread]: 
[0m05:09:36.328801 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_data
[0m05:09:36.329508 [info ] [Thread-1 (]: 1 of 4 START sql view model ANALYTICS_staging.stg_stock_data ................... [RUN]
[0m05:09:36.330606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_snapshots, now model.stock_analytics.stg_stock_data)
[0m05:09:36.330980 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_data
[0m05:09:36.337945 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_data"
[0m05:09:36.339439 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stg_stock_data (compile): 05:09:36.331238 => 05:09:36.339228
[0m05:09:36.339831 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_data
[0m05:09:36.357404 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_data"
[0m05:09:36.358624 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_data"
[0m05:09:36.358922 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_data"} */
create or replace   view USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
  
   as (
    

WITH source_data AS (
    SELECT
        symbol,
        date,
        open,
        high,
        low,
        close,
        volume
    FROM USER_DB_JACKAL.RAW.stock_data_lab
    WHERE date IS NOT NULL
        AND symbol IS NOT NULL
)

SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume,
    -- Add data quality flags
    CASE 
        WHEN open IS NULL OR high IS NULL OR low IS NULL OR close IS NULL 
        THEN TRUE 
        ELSE FALSE 
    END AS has_null_prices,
    -- Validate price relationships
    CASE 
        WHEN high < low 
            OR high < open 
            OR high < close 
            OR low > open 
            OR low > close 
        THEN TRUE 
        ELSE FALSE 
    END AS has_invalid_prices
FROM source_data
  );
[0m05:09:36.359193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:36.833041 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:36.860173 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stg_stock_data (execute): 05:09:36.340162 => 05:09:36.859954
[0m05:09:36.860694 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_data: Close
[0m05:09:37.002901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94085cf5-5ebd-40a4-b0d3-51ef25fbb665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60733f80>]}
[0m05:09:37.004580 [info ] [Thread-1 (]: 1 of 4 OK created sql view model ANALYTICS_staging.stg_stock_data .............. [[32mSUCCESS 1[0m in 0.67s]
[0m05:09:37.006473 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_data
[0m05:09:37.008523 [debug] [Thread-3 (]: Began running node model.stock_analytics.moving_averages
[0m05:09:37.009308 [debug] [Thread-4 (]: Began running node model.stock_analytics.rsi
[0m05:09:37.010114 [info ] [Thread-3 (]: 2 of 4 START sql table model ANALYTICS_intermediate.moving_averages ............ [RUN]
[0m05:09:37.011443 [info ] [Thread-4 (]: 3 of 4 START sql table model ANALYTICS_intermediate.rsi ........................ [RUN]
[0m05:09:37.012655 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_staging, now model.stock_analytics.moving_averages)
[0m05:09:37.013534 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_marts, now model.stock_analytics.rsi)
[0m05:09:37.014139 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.moving_averages
[0m05:09:37.014702 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.rsi
[0m05:09:37.021288 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.moving_averages"
[0m05:09:37.024538 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.rsi"
[0m05:09:37.026565 [debug] [Thread-3 (]: Timing info for model.stock_analytics.moving_averages (compile): 05:09:37.015105 => 05:09:37.026360
[0m05:09:37.027022 [debug] [Thread-4 (]: Timing info for model.stock_analytics.rsi (compile): 05:09:37.021752 => 05:09:37.026780
[0m05:09:37.027382 [debug] [Thread-3 (]: Began executing node model.stock_analytics.moving_averages
[0m05:09:37.027861 [debug] [Thread-4 (]: Began executing node model.stock_analytics.rsi
[0m05:09:37.042585 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.moving_averages"
[0m05:09:37.044390 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.rsi"
[0m05:09:37.050869 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.moving_averages"
[0m05:09:37.051252 [debug] [Thread-3 (]: On model.stock_analytics.moving_averages: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.moving_averages"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
         as
        (

WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    WHERE has_null_prices = FALSE
        AND has_invalid_prices = FALSE
),

moving_averages AS (
    SELECT
        symbol,
        date,
        close,
        -- 7-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS sma_7,
        -- 14-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS sma_14,
        -- 30-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
        ) AS sma_30,
        -- 50-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS sma_50,
        -- Count of days for MA calculation validation
        COUNT(*) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS days_count
    FROM stock_data
)

SELECT
    symbol,
    date,
    close,
    ROUND(sma_7, 2) AS sma_7,
    ROUND(sma_14, 2) AS sma_14,
    ROUND(sma_30, 2) AS sma_30,
    ROUND(sma_50, 2) AS sma_50,
    -- Calculate crossover signals
    CASE 
        WHEN sma_7 > sma_14 THEN 'BULLISH_SHORT'
        WHEN sma_7 < sma_14 THEN 'BEARISH_SHORT'
        ELSE 'NEUTRAL'
    END AS signal_7_14,
    CASE 
        WHEN sma_14 > sma_30 THEN 'BULLISH_MED'
        WHEN sma_14 < sma_30 THEN 'BEARISH_MED'
        ELSE 'NEUTRAL'
    END AS signal_14_30,
    -- Price vs MA comparison
    ROUND(((close - sma_50) / NULLIF(sma_50, 0)) * 100, 2) AS pct_from_sma_50
FROM moving_averages
WHERE days_count >= 7  -- Ensure we have enough data for at least the shortest MA
        );
[0m05:09:37.052705 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.rsi"
[0m05:09:37.052972 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:09:37.053301 [debug] [Thread-4 (]: On model.stock_analytics.rsi: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.rsi"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_intermediate.rsi
         as
        (

WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    WHERE has_null_prices = FALSE
        AND has_invalid_prices = FALSE
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        close - LAG(close, 1) OVER (PARTITION BY symbol ORDER BY date) AS price_change
    FROM stock_data
),

gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
    WHERE price_change IS NOT NULL
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        gain,
        loss,
        -- 14-period average gain
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain_14,
        -- 14-period average loss
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss_14,
        -- Count periods for validation
        COUNT(*) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS period_count
    FROM gains_losses
),

rsi_calculation AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        avg_gain_14,
        avg_loss_14,
        period_count,
        -- Calculate RS (Relative Strength)
        CASE 
            WHEN avg_loss_14 = 0 THEN NULL
            ELSE avg_gain_14 / NULLIF(avg_loss_14, 0)
        END AS rs,
        -- Calculate RSI
        CASE 
            WHEN avg_loss_14 = 0 THEN 100
            WHEN avg_gain_14 = 0 THEN 0
            ELSE 100 - (100 / (1 + (avg_gain_14 / NULLIF(avg_loss_14, 0))))
        END AS rsi_14
    FROM average_gains_losses
    WHERE period_count >= 14  -- Ensure we have enough periods
)

SELECT
    symbol,
    date,
    close,
    ROUND(price_change, 2) AS price_change,
    ROUND(rsi_14, 2) AS rsi_14,
    -- RSI interpretation signals
    CASE 
        WHEN rsi_14 >= 70 THEN 'OVERBOUGHT'
        WHEN rsi_14 <= 30 THEN 'OVERSOLD'
        WHEN rsi_14 > 50 THEN 'BULLISH'
        WHEN rsi_14 < 50 THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS rsi_signal,
    -- RSI momentum
    CASE 
        WHEN rsi_14 > LAG(rsi_14, 1) OVER (PARTITION BY symbol ORDER BY date) 
        THEN 'INCREASING'
        WHEN rsi_14 < LAG(rsi_14, 1) OVER (PARTITION BY symbol ORDER BY date) 
        THEN 'DECREASING'
        ELSE 'FLAT'
    END AS rsi_momentum
FROM rsi_calculation
ORDER BY symbol, date
        );
[0m05:09:37.054373 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:09:38.331019 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:09:38.336412 [debug] [Thread-3 (]: Timing info for model.stock_analytics.moving_averages (execute): 05:09:37.028207 => 05:09:38.336056
[0m05:09:38.337360 [debug] [Thread-3 (]: On model.stock_analytics.moving_averages: Close
[0m05:09:38.447791 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94085cf5-5ebd-40a4-b0d3-51ef25fbb665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff603f5220>]}
[0m05:09:38.449486 [info ] [Thread-3 (]: 2 of 4 OK created sql table model ANALYTICS_intermediate.moving_averages ....... [[32mSUCCESS 1[0m in 1.44s]
[0m05:09:38.451305 [debug] [Thread-3 (]: Finished running node model.stock_analytics.moving_averages
[0m05:09:38.467792 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:09:38.472604 [debug] [Thread-4 (]: Timing info for model.stock_analytics.rsi (execute): 05:09:37.042786 => 05:09:38.472313
[0m05:09:38.473261 [debug] [Thread-4 (]: On model.stock_analytics.rsi: Close
[0m05:09:38.593601 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94085cf5-5ebd-40a4-b0d3-51ef25fbb665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff603f6de0>]}
[0m05:09:38.594479 [info ] [Thread-4 (]: 3 of 4 OK created sql table model ANALYTICS_intermediate.rsi ................... [[32mSUCCESS 1[0m in 1.58s]
[0m05:09:38.595376 [debug] [Thread-4 (]: Finished running node model.stock_analytics.rsi
[0m05:09:38.596278 [debug] [Thread-1 (]: Began running node model.stock_analytics.stock_analytics_mart
[0m05:09:38.596775 [info ] [Thread-1 (]: 4 of 4 START sql table model ANALYTICS_marts.stock_analytics_mart .............. [RUN]
[0m05:09:38.597627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_data, now model.stock_analytics.stock_analytics_mart)
[0m05:09:38.598072 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stock_analytics_mart
[0m05:09:38.601510 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stock_analytics_mart"
[0m05:09:38.602640 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stock_analytics_mart (compile): 05:09:38.598330 => 05:09:38.602485
[0m05:09:38.602968 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stock_analytics_mart
[0m05:09:38.604978 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stock_analytics_mart"
[0m05:09:38.606879 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stock_analytics_mart"
[0m05:09:38.607208 [debug] [Thread-1 (]: On model.stock_analytics.stock_analytics_mart: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stock_analytics_mart"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
         as
        (

WITH moving_averages AS (
    SELECT * FROM USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
),

rsi AS (
    SELECT * FROM USER_DB_JACKAL.ANALYTICS_intermediate.rsi
),

combined_analytics AS (
    SELECT
        ma.symbol,
        ma.date,
        ma.close,
        -- Moving Averages
        ma.sma_7,
        ma.sma_14,
        ma.sma_30,
        ma.sma_50,
        ma.signal_7_14,
        ma.signal_14_30,
        ma.pct_from_sma_50,
        -- RSI Indicators
        rsi.rsi_14,
        rsi.rsi_signal,
        rsi.rsi_momentum,
        rsi.price_change,
        -- Combined trading signal
        CASE
            WHEN rsi.rsi_14 <= 30 AND ma.signal_7_14 = 'BULLISH_SHORT' THEN 'STRONG_BUY'
            WHEN rsi.rsi_14 >= 70 AND ma.signal_7_14 = 'BEARISH_SHORT' THEN 'STRONG_SELL'
            WHEN rsi.rsi_14 < 40 AND ma.signal_14_30 = 'BULLISH_MED' THEN 'BUY'
            WHEN rsi.rsi_14 > 60 AND ma.signal_14_30 = 'BEARISH_MED' THEN 'SELL'
            WHEN rsi.rsi_14 BETWEEN 40 AND 60 THEN 'HOLD'
            ELSE 'NEUTRAL'
        END AS combined_signal,
        -- Volatility indicator (price % change)
        ROUND((rsi.price_change / NULLIF(ma.close - rsi.price_change, 0)) * 100, 2) AS daily_return_pct,
        -- Trend strength
        CASE
            WHEN ma.close > ma.sma_7 
                AND ma.sma_7 > ma.sma_14 
                AND ma.sma_14 > ma.sma_30 
            THEN 'STRONG_UPTREND'
            WHEN ma.close < ma.sma_7 
                AND ma.sma_7 < ma.sma_14 
                AND ma.sma_14 < ma.sma_30 
            THEN 'STRONG_DOWNTREND'
            WHEN ma.close > ma.sma_30 THEN 'UPTREND'
            WHEN ma.close < ma.sma_30 THEN 'DOWNTREND'
            ELSE 'SIDEWAYS'
        END AS trend_strength
    FROM moving_averages ma
    INNER JOIN rsi 
        ON ma.symbol = rsi.symbol 
        AND ma.date = rsi.date
)

SELECT
    symbol,
    date,
    close,
    sma_7,
    sma_14,
    sma_30,
    sma_50,
    rsi_14,
    signal_7_14,
    signal_14_30,
    rsi_signal,
    rsi_momentum,
    combined_signal,
    trend_strength,
    pct_from_sma_50,
    daily_return_pct,
    price_change
FROM combined_analytics
ORDER BY symbol, date DESC
        );
[0m05:09:38.607561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:39.846009 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:09:39.847606 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stock_analytics_mart (execute): 05:09:38.603192 => 05:09:39.847491
[0m05:09:39.847862 [debug] [Thread-1 (]: On model.stock_analytics.stock_analytics_mart: Close
[0m05:09:39.954074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94085cf5-5ebd-40a4-b0d3-51ef25fbb665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff603c6b70>]}
[0m05:09:39.954690 [info ] [Thread-1 (]: 4 of 4 OK created sql table model ANALYTICS_marts.stock_analytics_mart ......... [[32mSUCCESS 1[0m in 1.36s]
[0m05:09:39.955550 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stock_analytics_mart
[0m05:09:39.957177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:09:39.957533 [debug] [MainThread]: Connection 'model.stock_analytics.stock_analytics_mart' was properly closed.
[0m05:09:39.957837 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL_ANALYTICS_intermediate' was properly closed.
[0m05:09:39.958145 [debug] [MainThread]: Connection 'model.stock_analytics.rsi' was properly closed.
[0m05:09:39.958507 [debug] [MainThread]: Connection 'model.stock_analytics.moving_averages' was properly closed.
[0m05:09:39.958880 [info ] [MainThread]: 
[0m05:09:39.959273 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 4.99 seconds (4.99s).
[0m05:09:39.960046 [debug] [MainThread]: Command end result
[0m05:09:39.967614 [info ] [MainThread]: 
[0m05:09:39.968071 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:09:39.968321 [info ] [MainThread]: 
[0m05:09:39.968589 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:09:39.969261 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.39872, "process_user_time": 2.563365, "process_kernel_time": 0.103539, "process_mem_max_rss": "219368", "process_out_blocks": "2047", "process_in_blocks": "0"}
[0m05:09:39.969630 [debug] [MainThread]: Command `dbt run` succeeded at 05:09:39.969538 after 5.40 seconds
[0m05:09:39.969928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bcbce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60576360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60681010>]}
[0m05:09:39.970197 [debug] [MainThread]: Flushing usage events
[0m05:09:42.084623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce720c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d645730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dab2840>]}


============================== 05:09:42.087775 | b8fd2067-3ede-4577-8ba3-8e68b71db8a6 ==============================
[0m05:09:42.087775 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:09:42.088268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:09:42.412039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8fd2067-3ede-4577-8ba3-8e68b71db8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77cccec0>]}
[0m05:09:42.441583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8fd2067-3ede-4577-8ba3-8e68b71db8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6a2ba0>]}
[0m05:09:42.441920 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m05:09:42.445079 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:09:42.459324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:42.459552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:42.462539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8fd2067-3ede-4577-8ba3-8e68b71db8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77c32c60>]}
[0m05:09:42.467554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8fd2067-3ede-4577-8ba3-8e68b71db8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77ab6e70>]}
[0m05:09:42.467775 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:09:42.468142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8fd2067-3ede-4577-8ba3-8e68b71db8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb6a780>]}
[0m05:09:42.469088 [info ] [MainThread]: 
[0m05:09:42.469484 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:09:42.470142 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_staging'
[0m05:09:42.470572 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_snapshots'
[0m05:09:42.476632 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_staging"
[0m05:09:42.477129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_marts'
[0m05:09:42.478147 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_snapshots"
[0m05:09:42.478575 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_intermediate'
[0m05:09:42.478765 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_staging"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_staging limit 10000
[0m05:09:42.479740 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_marts"
[0m05:09:42.479939 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_snapshots"} */
show terse objects in USER_DB_JACKAL.snapshots limit 10000
[0m05:09:42.480814 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m05:09:42.481016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:42.481189 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_marts"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_marts limit 10000
[0m05:09:42.481377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:42.481561 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_intermediate"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_intermediate limit 10000
[0m05:09:42.482245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:42.483640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:42.845035 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c09935-0307-1c18-000f-c0df008f4df6
[0m05:09:42.845432 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m05:09:42.845795 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m05:09:42.846085 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:09:42.846489 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: Close
[0m05:09:42.865372 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:09:42.866383 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m05:09:42.885734 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:42.886584 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m05:09:42.902170 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:42.902798 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m05:09:43.018678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8fd2067-3ede-4577-8ba3-8e68b71db8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77ab6e70>]}
[0m05:09:43.019193 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:09:43.019602 [info ] [MainThread]: 
[0m05:09:43.024146 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:09:43.025254 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:09:43.025529 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c
[0m05:09:43.025741 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_stock_data_symbol__AAPL__GOOG ........... [RUN]
[0m05:09:43.025981 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:09:43.026177 [info ] [Thread-2 (]: 2 of 17 START test accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL  [RUN]
[0m05:09:43.026450 [info ] [Thread-3 (]: 3 of 17 START test dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 ......... [RUN]
[0m05:09:43.026843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_staging, now test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976)
[0m05:09:43.027086 [info ] [Thread-4 (]: 4 of 17 START test dbt_utils_unique_combination_of_columns_moving_averages_symbol__date  [RUN]
[0m05:09:43.027520 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_marts, now test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999)
[0m05:09:43.027850 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_snapshots, now test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c)
[0m05:09:43.028089 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:09:43.028410 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_intermediate, now test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81)
[0m05:09:43.028631 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:09:43.028852 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c
[0m05:09:43.035303 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m05:09:43.035538 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:09:43.038580 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m05:09:43.040819 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c (compile): 05:09:43.038804 => 05:09:43.040711
[0m05:09:43.042960 [debug] [Thread-4 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81 (compile): 05:09:43.041103 => 05:09:43.042805
[0m05:09:43.044195 [debug] [Thread-1 (]: Timing info for test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976 (compile): 05:09:43.029007 => 05:09:43.044101
[0m05:09:43.044439 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:09:43.052620 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m05:09:43.054332 [debug] [Thread-3 (]: Compilation Error in test dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:09:43.054574 [debug] [Thread-2 (]: Timing info for test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999 (compile): 05:09:43.035731 => 05:09:43.054463
[0m05:09:43.054918 [debug] [Thread-4 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_moving_averages_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:09:43.055186 [error] [Thread-3 (]: 3 of 17 ERROR dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 .............. [[31mERROR[0m in 0.03s]
[0m05:09:43.055591 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:09:43.055997 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m05:09:43.056214 [error] [Thread-4 (]: 4 of 17 ERROR dbt_utils_unique_combination_of_columns_moving_averages_symbol__date  [[31mERROR[0m in 0.03s]
[0m05:09:43.056584 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c
[0m05:09:43.057845 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m05:09:43.058062 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        symbol as value_field,
        count(*) as n_records

    from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    group by symbol

)

select *
from all_values
where value_field not in (
    'AAPL','GOOG'
)



      
    ) dbt_internal_test
[0m05:09:43.058328 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:09:43.058564 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:09:43.059113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:43.059356 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:09:43.059583 [info ] [Thread-3 (]: 5 of 17 START test dbt_utils_unique_combination_of_columns_rsi_symbol__date .... [RUN]
[0m05:09:43.060902 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m05:09:43.061429 [info ] [Thread-4 (]: 6 of 17 START test not_null_moving_averages_date ............................... [RUN]
[0m05:09:43.062038 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c, now test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830)
[0m05:09:43.062476 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        combined_signal as value_field,
        count(*) as n_records

    from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
    group by combined_signal

)

select *
from all_values
where value_field not in (
    'STRONG_BUY','BUY','HOLD','SELL','STRONG_SELL','NEUTRAL'
)



      
    ) dbt_internal_test
[0m05:09:43.062817 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81, now test.stock_analytics.not_null_moving_averages_date.2eb91e4683)
[0m05:09:43.063029 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:09:43.063229 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:09:43.063462 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:09:43.065500 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830 (compile): 05:09:43.063601 => 05:09:43.065373
[0m05:09:43.069363 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m05:09:43.070246 [debug] [Thread-3 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:09:43.070542 [error] [Thread-3 (]: 5 of 17 ERROR dbt_utils_unique_combination_of_columns_rsi_symbol__date ......... [[31mERROR[0m in 0.01s]
[0m05:09:43.070927 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:09:43.071160 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:09:43.071491 [info ] [Thread-3 (]: 7 of 17 START test not_null_moving_averages_symbol ............................. [RUN]
[0m05:09:43.071735 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_moving_averages_date.2eb91e4683 (compile): 05:09:43.066434 => 05:09:43.071647
[0m05:09:43.072036 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830, now test.stock_analytics.not_null_moving_averages_symbol.153f328246)
[0m05:09:43.072274 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:09:43.072477 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:09:43.073753 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m05:09:43.076497 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m05:09:43.077414 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m05:09:43.077648 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_moving_averages_symbol.153f328246 (compile): 05:09:43.073909 => 05:09:43.077547
[0m05:09:43.077827 [debug] [Thread-4 (]: On test.stock_analytics.not_null_moving_averages_date.2eb91e4683: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
where date is null



      
    ) dbt_internal_test
[0m05:09:43.078037 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:09:43.078223 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:09:43.079484 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m05:09:43.081304 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m05:09:43.081904 [debug] [Thread-3 (]: On test.stock_analytics.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m05:09:43.082340 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:09:43.508240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:43.509623 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:43.517924 [debug] [Thread-1 (]: Timing info for test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976 (execute): 05:09:43.044595 => 05:09:43.517591
[0m05:09:43.520108 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_moving_averages_date.2eb91e4683 (execute): 05:09:43.072619 => 05:09:43.519845
[0m05:09:43.520677 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976: Close
[0m05:09:43.521118 [debug] [Thread-4 (]: On test.stock_analytics.not_null_moving_averages_date.2eb91e4683: Close
[0m05:09:43.580777 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:43.583338 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_moving_averages_symbol.153f328246 (execute): 05:09:43.078377 => 05:09:43.583017
[0m05:09:43.583854 [debug] [Thread-3 (]: On test.stock_analytics.not_null_moving_averages_symbol.153f328246: Close
[0m05:09:43.648493 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:09:43.652090 [debug] [Thread-2 (]: Timing info for test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999 (execute): 05:09:43.056724 => 05:09:43.651704
[0m05:09:43.652823 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999: Close
[0m05:09:43.660524 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_stock_data_symbol__AAPL__GOOG ................. [[32mPASS[0m in 0.63s]
[0m05:09:43.662065 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:09:43.662834 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:09:43.663457 [info ] [Thread-1 (]: 8 of 17 START test not_null_rsi_date ........................................... [RUN]
[0m05:09:43.664641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976, now test.stock_analytics.not_null_rsi_date.da56752005)
[0m05:09:43.665163 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:09:43.670434 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_date.da56752005"
[0m05:09:43.671841 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_rsi_date.da56752005 (compile): 05:09:43.665521 => 05:09:43.671659
[0m05:09:43.672229 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:09:43.674565 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_date.da56752005"
[0m05:09:43.676088 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_date.da56752005"
[0m05:09:43.676447 [debug] [Thread-1 (]: On test.stock_analytics.not_null_rsi_date.da56752005: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_date.da56752005"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where date is null



      
    ) dbt_internal_test
[0m05:09:43.676764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:43.733010 [info ] [Thread-3 (]: 7 of 17 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.66s]
[0m05:09:43.733688 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:09:43.734178 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:09:43.734616 [info ] [Thread-3 (]: 9 of 17 START test not_null_rsi_rsi_14 ......................................... [RUN]
[0m05:09:43.735386 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_moving_averages_symbol.153f328246, now test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899)
[0m05:09:43.735747 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:09:43.739449 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m05:09:43.741149 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899 (compile): 05:09:43.735963 => 05:09:43.740991
[0m05:09:43.741837 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:09:43.743771 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m05:09:43.745117 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m05:09:43.745463 [debug] [Thread-3 (]: On test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where rsi_14 is null



      
    ) dbt_internal_test
[0m05:09:43.745739 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:09:43.761862 [info ] [Thread-2 (]: 2 of 17 PASS accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL  [[32mPASS[0m in 0.73s]
[0m05:09:43.762487 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:09:43.762818 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:09:43.763116 [info ] [Thread-2 (]: 10 of 17 START test not_null_rsi_symbol ........................................ [RUN]
[0m05:09:43.763667 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999, now test.stock_analytics.not_null_rsi_symbol.21add3cf05)
[0m05:09:43.763950 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:09:43.766849 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m05:09:43.767737 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_rsi_symbol.21add3cf05 (compile): 05:09:43.764141 => 05:09:43.767596
[0m05:09:43.768005 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:09:43.769605 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m05:09:43.770703 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m05:09:43.770960 [debug] [Thread-2 (]: On test.stock_analytics.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where symbol is null



      
    ) dbt_internal_test
[0m05:09:43.771240 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:09:43.982517 [info ] [Thread-4 (]: 6 of 17 PASS not_null_moving_averages_date ..................................... [[32mPASS[0m in 0.92s]
[0m05:09:43.983396 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:09:43.983765 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:09:43.984171 [info ] [Thread-4 (]: 11 of 17 START test not_null_stg_stock_data_close .............................. [RUN]
[0m05:09:43.984924 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_moving_averages_date.2eb91e4683, now test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db)
[0m05:09:43.985217 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:09:43.988423 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m05:09:43.990512 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db (compile): 05:09:43.985423 => 05:09:43.990363
[0m05:09:43.990784 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:09:43.993536 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m05:09:43.994364 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m05:09:43.994630 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where close is null



      
    ) dbt_internal_test
[0m05:09:43.994888 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:09:44.061332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:44.062970 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_rsi_date.da56752005 (execute): 05:09:43.672488 => 05:09:44.062795
[0m05:09:44.063334 [debug] [Thread-1 (]: On test.stock_analytics.not_null_rsi_date.da56752005: Close
[0m05:09:44.163523 [info ] [Thread-1 (]: 8 of 17 PASS not_null_rsi_date ................................................. [[32mPASS[0m in 0.50s]
[0m05:09:44.164738 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:09:44.165393 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:09:44.165933 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_stock_data_date ............................... [RUN]
[0m05:09:44.166792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_date.da56752005, now test.stock_analytics.not_null_stg_stock_data_date.96adead1a7)
[0m05:09:44.167220 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:09:44.171961 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m05:09:44.173370 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_date.96adead1a7 (compile): 05:09:44.167531 => 05:09:44.173164
[0m05:09:44.173797 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:09:44.176075 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m05:09:44.177324 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m05:09:44.177656 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_data_date.96adead1a7: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where date is null



      
    ) dbt_internal_test
[0m05:09:44.177955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:44.180243 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:44.182136 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_rsi_symbol.21add3cf05 (execute): 05:09:43.768184 => 05:09:44.181971
[0m05:09:44.182478 [debug] [Thread-2 (]: On test.stock_analytics.not_null_rsi_symbol.21add3cf05: Close
[0m05:09:44.232141 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:44.233723 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899 (execute): 05:09:43.742049 => 05:09:44.233540
[0m05:09:44.234063 [debug] [Thread-3 (]: On test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899: Close
[0m05:09:44.361155 [info ] [Thread-3 (]: 9 of 17 PASS not_null_rsi_rsi_14 ............................................... [[32mPASS[0m in 0.63s]
[0m05:09:44.362992 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:09:44.363658 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:09:44.364215 [info ] [Thread-3 (]: 13 of 17 START test not_null_stg_stock_data_symbol ............................. [RUN]
[0m05:09:44.365562 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899, now test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e)
[0m05:09:44.366116 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:09:44.372491 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m05:09:44.374310 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e (compile): 05:09:44.366463 => 05:09:44.374002
[0m05:09:44.374826 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:09:44.377805 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m05:09:44.379331 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m05:09:44.379723 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where symbol is null



      
    ) dbt_internal_test
[0m05:09:44.380055 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:09:44.423990 [info ] [Thread-2 (]: 10 of 17 PASS not_null_rsi_symbol .............................................. [[32mPASS[0m in 0.66s]
[0m05:09:44.426165 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:09:44.426710 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:09:44.427125 [info ] [Thread-2 (]: 14 of 17 START test not_null_stock_analytics_mart_date ......................... [RUN]
[0m05:09:44.427817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_symbol.21add3cf05, now test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b)
[0m05:09:44.428156 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:09:44.431889 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m05:09:44.433093 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b (compile): 05:09:44.428390 => 05:09:44.432932
[0m05:09:44.433417 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:09:44.435254 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m05:09:44.436260 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m05:09:44.436584 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
where date is null



      
    ) dbt_internal_test
[0m05:09:44.436842 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:09:44.493883 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:44.495241 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db (execute): 05:09:43.990970 => 05:09:44.495103
[0m05:09:44.495518 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db: Close
[0m05:09:44.613679 [info ] [Thread-4 (]: 11 of 17 PASS not_null_stg_stock_data_close .................................... [[32mPASS[0m in 0.63s]
[0m05:09:44.614689 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:09:44.615183 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:09:44.615644 [info ] [Thread-4 (]: 15 of 17 START test not_null_stock_analytics_mart_symbol ....................... [RUN]
[0m05:09:44.616497 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db, now test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0)
[0m05:09:44.616911 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:09:44.621125 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m05:09:44.622942 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0 (compile): 05:09:44.617188 => 05:09:44.622757
[0m05:09:44.623319 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:09:44.625495 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m05:09:44.626566 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m05:09:44.626916 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
where symbol is null



      
    ) dbt_internal_test
[0m05:09:44.627338 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:09:44.884633 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:44.888679 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b (execute): 05:09:44.433617 => 05:09:44.888071
[0m05:09:44.889636 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b: Close
[0m05:09:44.953707 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:09:44.957765 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e (execute): 05:09:44.375138 => 05:09:44.957389
[0m05:09:44.958472 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e: Close
[0m05:09:44.991965 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:09:44.996211 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_date.96adead1a7 (execute): 05:09:44.174030 => 05:09:44.995828
[0m05:09:44.996933 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_data_date.96adead1a7: Close
[0m05:09:45.033835 [info ] [Thread-2 (]: 14 of 17 PASS not_null_stock_analytics_mart_date ............................... [[32mPASS[0m in 0.61s]
[0m05:09:45.036171 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:09:45.037064 [debug] [Thread-2 (]: Began running node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:09:45.037828 [info ] [Thread-2 (]: 16 of 17 START test source_not_null_raw_stock_data_lab_date .................... [RUN]
[0m05:09:45.039783 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b, now test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740)
[0m05:09:45.040445 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:09:45.047366 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m05:09:45.049307 [debug] [Thread-2 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740 (compile): 05:09:45.040819 => 05:09:45.049040
[0m05:09:45.049839 [debug] [Thread-2 (]: Began executing node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:09:45.054319 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m05:09:45.055631 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m05:09:45.055976 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.RAW.stock_data_lab
where date is null



      
    ) dbt_internal_test
[0m05:09:45.056249 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:09:45.063365 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:45.064805 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0 (execute): 05:09:44.623569 => 05:09:45.064641
[0m05:09:45.065161 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0: Close
[0m05:09:45.079752 [info ] [Thread-3 (]: 13 of 17 PASS not_null_stg_stock_data_symbol ................................... [[32mPASS[0m in 0.71s]
[0m05:09:45.080403 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:09:45.080747 [debug] [Thread-3 (]: Began running node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:09:45.081056 [info ] [Thread-3 (]: 17 of 17 START test source_not_null_raw_stock_data_lab_symbol .................. [RUN]
[0m05:09:45.081556 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e, now test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f)
[0m05:09:45.081780 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:09:45.084275 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m05:09:45.085093 [debug] [Thread-3 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f (compile): 05:09:45.081930 => 05:09:45.084974
[0m05:09:45.085383 [debug] [Thread-3 (]: Began executing node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:09:45.086894 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m05:09:45.088241 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m05:09:45.088482 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.RAW.stock_data_lab
where symbol is null



      
    ) dbt_internal_test
[0m05:09:45.088669 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:09:45.148846 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_stock_data_date ..................................... [[32mPASS[0m in 0.98s]
[0m05:09:45.149385 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:09:45.200245 [info ] [Thread-4 (]: 15 of 17 PASS not_null_stock_analytics_mart_symbol ............................. [[32mPASS[0m in 0.58s]
[0m05:09:45.200805 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:09:45.481215 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:45.485596 [debug] [Thread-2 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740 (execute): 05:09:45.050175 => 05:09:45.485201
[0m05:09:45.486301 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740: Close
[0m05:09:45.491094 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:09:45.493659 [debug] [Thread-3 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f (execute): 05:09:45.085573 => 05:09:45.493371
[0m05:09:45.494244 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f: Close
[0m05:09:45.606968 [info ] [Thread-3 (]: 17 of 17 PASS source_not_null_raw_stock_data_lab_symbol ........................ [[32mPASS[0m in 0.53s]
[0m05:09:45.608872 [debug] [Thread-3 (]: Finished running node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:09:45.625895 [info ] [Thread-2 (]: 16 of 17 PASS source_not_null_raw_stock_data_lab_date .......................... [[32mPASS[0m in 0.59s]
[0m05:09:45.627808 [debug] [Thread-2 (]: Finished running node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:09:45.630525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:09:45.631023 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stg_stock_data_date.96adead1a7' was properly closed.
[0m05:09:45.631487 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f' was properly closed.
[0m05:09:45.631870 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740' was properly closed.
[0m05:09:45.632231 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0' was properly closed.
[0m05:09:45.632654 [info ] [MainThread]: 
[0m05:09:45.633445 [info ] [MainThread]: Finished running 17 tests in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m05:09:45.635563 [debug] [MainThread]: Command end result
[0m05:09:45.645505 [info ] [MainThread]: 
[0m05:09:45.646009 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m05:09:45.646308 [info ] [MainThread]: 
[0m05:09:45.646592 [error] [MainThread]:   Compilation Error in test dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:09:45.646861 [info ] [MainThread]: 
[0m05:09:45.647120 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_moving_averages_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:09:45.647352 [info ] [MainThread]: 
[0m05:09:45.647579 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:09:45.647810 [info ] [MainThread]: 
[0m05:09:45.648057 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=3 SKIP=0 TOTAL=17
[0m05:09:45.648812 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.5838835, "process_user_time": 2.671423, "process_kernel_time": 0.12822, "process_mem_max_rss": "220144", "process_out_blocks": "2076", "command_success": false, "process_in_blocks": "0"}
[0m05:09:45.649202 [debug] [MainThread]: Command `dbt test` failed at 05:09:45.649114 after 3.58 seconds
[0m05:09:45.649507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce77f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce2f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff765d8bf0>]}
[0m05:09:45.649787 [debug] [MainThread]: Flushing usage events
[0m05:13:42.638290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cab3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e81c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf46780>]}


============================== 05:13:42.646230 | e9829795-2d8e-49de-893e-877d70fff544 ==============================
[0m05:13:42.646230 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:13:42.646659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:13:42.696440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9829795-2d8e-49de-893e-877d70fff544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c9a97f0>]}
[0m05:13:42.696970 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8nmkixw8'
[0m05:13:42.697216 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:13:42.799160 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:13:42.799710 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:13:42.853656 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:13:42.859515 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/package-lock.yml
[0m05:13:42.862144 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w9mubplz'
[0m05:13:42.864320 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:13:43.335554 [info ] [MainThread]: Installed from version 1.1.1
[0m05:13:43.336002 [info ] [MainThread]: Updated version available: 1.3.2
[0m05:13:43.336214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e9829795-2d8e-49de-893e-877d70fff544', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cda6ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7e00b0>]}
[0m05:13:43.336450 [info ] [MainThread]: 
[0m05:13:43.336677 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m05:13:43.337374 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7198512, "process_user_time": 1.068234, "process_kernel_time": 0.084652, "process_mem_max_rss": "219356", "process_out_blocks": "2079", "process_in_blocks": "0"}
[0m05:13:43.337633 [debug] [MainThread]: Command `dbt deps` succeeded at 05:13:43.337573 after 0.72 seconds
[0m05:13:43.337823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef1fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf46780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cacc680>]}
[0m05:13:43.338022 [debug] [MainThread]: Flushing usage events
[0m05:13:46.436458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb32f4320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb33ee420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4f7da00>]}


============================== 05:13:46.439207 | 173e2ee5-2739-45fd-ba11-6da43b8c7954 ==============================
[0m05:13:46.439207 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:13:46.439657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:13:46.805814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '173e2ee5-2739-45fd-ba11-6da43b8c7954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921718e0>]}
[0m05:13:46.837059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '173e2ee5-2739-45fd-ba11-6da43b8c7954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b832c0>]}
[0m05:13:46.837454 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m05:13:46.842627 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:13:46.848514 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m05:13:46.848812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '173e2ee5-2739-45fd-ba11-6da43b8c7954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91dfe090>]}
[0m05:13:47.487489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '173e2ee5-2739-45fd-ba11-6da43b8c7954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9151e690>]}
[0m05:13:47.494190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '173e2ee5-2739-45fd-ba11-6da43b8c7954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d103b0>]}
[0m05:13:47.494444 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m05:13:47.494813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '173e2ee5-2739-45fd-ba11-6da43b8c7954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9151e630>]}
[0m05:13:47.495756 [info ] [MainThread]: 
[0m05:13:47.496179 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:13:47.496829 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m05:13:47.502149 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m05:13:47.502489 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m05:13:47.502697 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m05:13:47.502987 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m05:13:47.503896 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m05:13:47.504110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:13:47.504969 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m05:13:47.505149 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m05:13:47.506431 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m05:13:47.506684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:13:47.507090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:13:48.026837 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m05:13:48.028065 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m05:13:48.031051 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m05:13:48.032142 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m05:13:48.032614 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m05:13:48.033989 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m05:13:48.180697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_ANALYTICS_marts)
[0m05:13:48.189004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_snapshots)
[0m05:13:48.193655 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_marts"
[0m05:13:48.197785 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_snapshots"
[0m05:13:48.198565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_ANALYTICS_intermediate)
[0m05:13:48.199153 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_marts"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_marts limit 10000
[0m05:13:48.199836 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_staging'
[0m05:13:48.200281 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_snapshots"} */
show terse objects in USER_DB_JACKAL.snapshots limit 10000
[0m05:13:48.202406 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m05:13:48.202837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:13:48.204679 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_staging"
[0m05:13:48.205083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:13:48.205479 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_intermediate"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_intermediate limit 10000
[0m05:13:48.206543 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_staging"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_staging limit 10000
[0m05:13:48.209434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:13:48.209946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:13:48.614724 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c09939-0307-1cc7-000f-c0df008f6e82
[0m05:13:48.616133 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m05:13:48.616720 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m05:13:48.617130 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:13:48.617559 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: Close
[0m05:13:48.689774 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:13:48.693611 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m05:13:48.706147 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:13:48.709263 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m05:13:48.715607 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:48.717388 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m05:13:48.862651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '173e2ee5-2739-45fd-ba11-6da43b8c7954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90984bc0>]}
[0m05:13:48.864481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:13:48.865758 [info ] [MainThread]: 
[0m05:13:48.877818 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_data
[0m05:13:48.878633 [info ] [Thread-1 (]: 1 of 4 START sql view model ANALYTICS_staging.stg_stock_data ................... [RUN]
[0m05:13:48.879574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_snapshots, now model.stock_analytics.stg_stock_data)
[0m05:13:48.880077 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_data
[0m05:13:48.886662 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_data"
[0m05:13:48.888567 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stg_stock_data (compile): 05:13:48.880364 => 05:13:48.888346
[0m05:13:48.888947 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_data
[0m05:13:48.905075 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_data"
[0m05:13:48.906500 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_data"
[0m05:13:48.906789 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_data"} */
create or replace   view USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
  
   as (
    

WITH source_data AS (
    SELECT
        symbol,
        date,
        open,
        high,
        low,
        close,
        volume
    FROM USER_DB_JACKAL.RAW.stock_data_lab
    WHERE date IS NOT NULL
        AND symbol IS NOT NULL
)

SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume,
    -- Add data quality flags
    CASE 
        WHEN open IS NULL OR high IS NULL OR low IS NULL OR close IS NULL 
        THEN TRUE 
        ELSE FALSE 
    END AS has_null_prices,
    -- Validate price relationships
    CASE 
        WHEN high < low 
            OR high < open 
            OR high < close 
            OR low > open 
            OR low > close 
        THEN TRUE 
        ELSE FALSE 
    END AS has_invalid_prices
FROM source_data
  );
[0m05:13:48.907052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:13:49.711557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:49.736431 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stg_stock_data (execute): 05:13:48.889185 => 05:13:49.736189
[0m05:13:49.737153 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_data: Close
[0m05:13:49.870603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '173e2ee5-2739-45fd-ba11-6da43b8c7954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900263f0>]}
[0m05:13:49.872465 [info ] [Thread-1 (]: 1 of 4 OK created sql view model ANALYTICS_staging.stg_stock_data .............. [[32mSUCCESS 1[0m in 0.99s]
[0m05:13:49.873987 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_data
[0m05:13:49.875464 [debug] [Thread-3 (]: Began running node model.stock_analytics.moving_averages
[0m05:13:49.875970 [debug] [Thread-4 (]: Began running node model.stock_analytics.rsi
[0m05:13:49.876539 [info ] [Thread-3 (]: 2 of 4 START sql table model ANALYTICS_intermediate.moving_averages ............ [RUN]
[0m05:13:49.877397 [info ] [Thread-4 (]: 3 of 4 START sql table model ANALYTICS_intermediate.rsi ........................ [RUN]
[0m05:13:49.878367 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_staging, now model.stock_analytics.moving_averages)
[0m05:13:49.879167 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_marts, now model.stock_analytics.rsi)
[0m05:13:49.879677 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.moving_averages
[0m05:13:49.880160 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.rsi
[0m05:13:49.883740 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.moving_averages"
[0m05:13:49.888195 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.rsi"
[0m05:13:49.889885 [debug] [Thread-3 (]: Timing info for model.stock_analytics.moving_averages (compile): 05:13:49.880498 => 05:13:49.889700
[0m05:13:49.890254 [debug] [Thread-4 (]: Timing info for model.stock_analytics.rsi (compile): 05:13:49.884111 => 05:13:49.890094
[0m05:13:49.890546 [debug] [Thread-3 (]: Began executing node model.stock_analytics.moving_averages
[0m05:13:49.890888 [debug] [Thread-4 (]: Began executing node model.stock_analytics.rsi
[0m05:13:49.903325 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.moving_averages"
[0m05:13:49.905068 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.rsi"
[0m05:13:49.906942 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.moving_averages"
[0m05:13:49.908211 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.rsi"
[0m05:13:49.908467 [debug] [Thread-3 (]: On model.stock_analytics.moving_averages: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.moving_averages"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
         as
        (

WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    WHERE has_null_prices = FALSE
        AND has_invalid_prices = FALSE
),

moving_averages AS (
    SELECT
        symbol,
        date,
        close,
        -- 7-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS sma_7,
        -- 14-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS sma_14,
        -- 30-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
        ) AS sma_30,
        -- 50-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS sma_50,
        -- Count of days for MA calculation validation
        COUNT(*) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS days_count
    FROM stock_data
)

SELECT
    symbol,
    date,
    close,
    ROUND(sma_7, 2) AS sma_7,
    ROUND(sma_14, 2) AS sma_14,
    ROUND(sma_30, 2) AS sma_30,
    ROUND(sma_50, 2) AS sma_50,
    -- Calculate crossover signals
    CASE 
        WHEN sma_7 > sma_14 THEN 'BULLISH_SHORT'
        WHEN sma_7 < sma_14 THEN 'BEARISH_SHORT'
        ELSE 'NEUTRAL'
    END AS signal_7_14,
    CASE 
        WHEN sma_14 > sma_30 THEN 'BULLISH_MED'
        WHEN sma_14 < sma_30 THEN 'BEARISH_MED'
        ELSE 'NEUTRAL'
    END AS signal_14_30,
    -- Price vs MA comparison
    ROUND(((close - sma_50) / NULLIF(sma_50, 0)) * 100, 2) AS pct_from_sma_50
FROM moving_averages
WHERE days_count >= 7  -- Ensure we have enough data for at least the shortest MA
        );
[0m05:13:49.908814 [debug] [Thread-4 (]: On model.stock_analytics.rsi: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.rsi"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_intermediate.rsi
         as
        (

WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    WHERE has_null_prices = FALSE
        AND has_invalid_prices = FALSE
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        close - LAG(close, 1) OVER (PARTITION BY symbol ORDER BY date) AS price_change
    FROM stock_data
),

gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
    WHERE price_change IS NOT NULL
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        gain,
        loss,
        -- 14-period average gain
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain_14,
        -- 14-period average loss
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss_14,
        -- Count periods for validation
        COUNT(*) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS period_count
    FROM gains_losses
),

rsi_calculation AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        avg_gain_14,
        avg_loss_14,
        period_count,
        -- Calculate RS (Relative Strength)
        CASE 
            WHEN avg_loss_14 = 0 THEN NULL
            ELSE avg_gain_14 / NULLIF(avg_loss_14, 0)
        END AS rs,
        -- Calculate RSI
        CASE 
            WHEN avg_loss_14 = 0 THEN 100
            WHEN avg_gain_14 = 0 THEN 0
            ELSE 100 - (100 / (1 + (avg_gain_14 / NULLIF(avg_loss_14, 0))))
        END AS rsi_14
    FROM average_gains_losses
    WHERE period_count >= 14  -- Ensure we have enough periods
)

SELECT
    symbol,
    date,
    close,
    ROUND(price_change, 2) AS price_change,
    ROUND(rsi_14, 2) AS rsi_14,
    -- RSI interpretation signals
    CASE 
        WHEN rsi_14 >= 70 THEN 'OVERBOUGHT'
        WHEN rsi_14 <= 30 THEN 'OVERSOLD'
        WHEN rsi_14 > 50 THEN 'BULLISH'
        WHEN rsi_14 < 50 THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS rsi_signal,
    -- RSI momentum
    CASE 
        WHEN rsi_14 > LAG(rsi_14, 1) OVER (PARTITION BY symbol ORDER BY date) 
        THEN 'INCREASING'
        WHEN rsi_14 < LAG(rsi_14, 1) OVER (PARTITION BY symbol ORDER BY date) 
        THEN 'DECREASING'
        ELSE 'FLAT'
    END AS rsi_momentum
FROM rsi_calculation
ORDER BY symbol, date
        );
[0m05:13:49.909148 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:13:49.909372 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:13:51.311708 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:51.314985 [debug] [Thread-3 (]: Timing info for model.stock_analytics.moving_averages (execute): 05:13:49.891151 => 05:13:51.314817
[0m05:13:51.315359 [debug] [Thread-3 (]: On model.stock_analytics.moving_averages: Close
[0m05:13:51.423402 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '173e2ee5-2739-45fd-ba11-6da43b8c7954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f06750>]}
[0m05:13:51.423935 [info ] [Thread-3 (]: 2 of 4 OK created sql table model ANALYTICS_intermediate.moving_averages ....... [[32mSUCCESS 1[0m in 1.55s]
[0m05:13:51.424581 [debug] [Thread-3 (]: Finished running node model.stock_analytics.moving_averages
[0m05:13:51.571650 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m05:13:51.575810 [debug] [Thread-4 (]: Timing info for model.stock_analytics.rsi (execute): 05:13:49.903573 => 05:13:51.575550
[0m05:13:51.576560 [debug] [Thread-4 (]: On model.stock_analytics.rsi: Close
[0m05:13:51.733668 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '173e2ee5-2739-45fd-ba11-6da43b8c7954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f85670>]}
[0m05:13:51.735291 [info ] [Thread-4 (]: 3 of 4 OK created sql table model ANALYTICS_intermediate.rsi ................... [[32mSUCCESS 1[0m in 1.85s]
[0m05:13:51.743769 [debug] [Thread-4 (]: Finished running node model.stock_analytics.rsi
[0m05:13:51.747004 [debug] [Thread-1 (]: Began running node model.stock_analytics.stock_analytics_mart
[0m05:13:51.747938 [info ] [Thread-1 (]: 4 of 4 START sql table model ANALYTICS_marts.stock_analytics_mart .............. [RUN]
[0m05:13:51.749163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_data, now model.stock_analytics.stock_analytics_mart)
[0m05:13:51.749554 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stock_analytics_mart
[0m05:13:51.754122 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stock_analytics_mart"
[0m05:13:51.755963 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stock_analytics_mart (compile): 05:13:51.749802 => 05:13:51.755754
[0m05:13:51.756345 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stock_analytics_mart
[0m05:13:51.758777 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stock_analytics_mart"
[0m05:13:51.761204 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stock_analytics_mart"
[0m05:13:51.761598 [debug] [Thread-1 (]: On model.stock_analytics.stock_analytics_mart: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stock_analytics_mart"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
         as
        (

WITH moving_averages AS (
    SELECT * FROM USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
),

rsi AS (
    SELECT * FROM USER_DB_JACKAL.ANALYTICS_intermediate.rsi
),

combined_analytics AS (
    SELECT
        ma.symbol,
        ma.date,
        ma.close,
        -- Moving Averages
        ma.sma_7,
        ma.sma_14,
        ma.sma_30,
        ma.sma_50,
        ma.signal_7_14,
        ma.signal_14_30,
        ma.pct_from_sma_50,
        -- RSI Indicators
        rsi.rsi_14,
        rsi.rsi_signal,
        rsi.rsi_momentum,
        rsi.price_change,
        -- Combined trading signal
        CASE
            WHEN rsi.rsi_14 <= 30 AND ma.signal_7_14 = 'BULLISH_SHORT' THEN 'STRONG_BUY'
            WHEN rsi.rsi_14 >= 70 AND ma.signal_7_14 = 'BEARISH_SHORT' THEN 'STRONG_SELL'
            WHEN rsi.rsi_14 < 40 AND ma.signal_14_30 = 'BULLISH_MED' THEN 'BUY'
            WHEN rsi.rsi_14 > 60 AND ma.signal_14_30 = 'BEARISH_MED' THEN 'SELL'
            WHEN rsi.rsi_14 BETWEEN 40 AND 60 THEN 'HOLD'
            ELSE 'NEUTRAL'
        END AS combined_signal,
        -- Volatility indicator (price % change)
        ROUND((rsi.price_change / NULLIF(ma.close - rsi.price_change, 0)) * 100, 2) AS daily_return_pct,
        -- Trend strength
        CASE
            WHEN ma.close > ma.sma_7 
                AND ma.sma_7 > ma.sma_14 
                AND ma.sma_14 > ma.sma_30 
            THEN 'STRONG_UPTREND'
            WHEN ma.close < ma.sma_7 
                AND ma.sma_7 < ma.sma_14 
                AND ma.sma_14 < ma.sma_30 
            THEN 'STRONG_DOWNTREND'
            WHEN ma.close > ma.sma_30 THEN 'UPTREND'
            WHEN ma.close < ma.sma_30 THEN 'DOWNTREND'
            ELSE 'SIDEWAYS'
        END AS trend_strength
    FROM moving_averages ma
    INNER JOIN rsi 
        ON ma.symbol = rsi.symbol 
        AND ma.date = rsi.date
)

SELECT
    symbol,
    date,
    close,
    sma_7,
    sma_14,
    sma_30,
    sma_50,
    rsi_14,
    signal_7_14,
    signal_14_30,
    rsi_signal,
    rsi_momentum,
    combined_signal,
    trend_strength,
    pct_from_sma_50,
    daily_return_pct,
    price_change
FROM combined_analytics
ORDER BY symbol, date DESC
        );
[0m05:13:51.762008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:13:52.976783 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:52.990374 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stock_analytics_mart (execute): 05:13:51.756555 => 05:13:52.990095
[0m05:13:52.990892 [debug] [Thread-1 (]: On model.stock_analytics.stock_analytics_mart: Close
[0m05:13:53.145383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '173e2ee5-2739-45fd-ba11-6da43b8c7954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a79160>]}
[0m05:13:53.146290 [info ] [Thread-1 (]: 4 of 4 OK created sql table model ANALYTICS_marts.stock_analytics_mart ......... [[32mSUCCESS 1[0m in 1.40s]
[0m05:13:53.147637 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stock_analytics_mart
[0m05:13:53.150314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:13:53.150811 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL_ANALYTICS_intermediate' was properly closed.
[0m05:13:53.151205 [debug] [MainThread]: Connection 'model.stock_analytics.rsi' was properly closed.
[0m05:13:53.151594 [debug] [MainThread]: Connection 'model.stock_analytics.stock_analytics_mart' was properly closed.
[0m05:13:53.151931 [debug] [MainThread]: Connection 'model.stock_analytics.moving_averages' was properly closed.
[0m05:13:53.152378 [info ] [MainThread]: 
[0m05:13:53.152981 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 5.66 seconds (5.66s).
[0m05:13:53.153877 [debug] [MainThread]: Command end result
[0m05:13:53.166837 [info ] [MainThread]: 
[0m05:13:53.167613 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:13:53.167952 [info ] [MainThread]: 
[0m05:13:53.168302 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:13:53.169297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7527804, "process_user_time": 3.260939, "process_kernel_time": 0.118251, "process_mem_max_rss": "232624", "process_out_blocks": "3691", "process_in_blocks": "0"}
[0m05:13:53.169642 [debug] [MainThread]: Command `dbt run` succeeded at 05:13:53.169563 after 6.75 seconds
[0m05:13:53.169908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb80c72c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff926326c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e71bb0>]}
[0m05:13:53.170195 [debug] [MainThread]: Flushing usage events
[0m05:13:55.511547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b95d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b95cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b95e690>]}


============================== 05:13:55.514377 | 72673c95-3168-4d03-a4bd-eaa9d0db4646 ==============================
[0m05:13:55.514377 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:13:55.514803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m05:13:55.865872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72673c95-3168-4d03-a4bd-eaa9d0db4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b9630b0>]}
[0m05:13:55.896376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72673c95-3168-4d03-a4bd-eaa9d0db4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56c762a0>]}
[0m05:13:55.896737 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m05:13:55.901617 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:13:55.929467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:13:55.929651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:13:55.931902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72673c95-3168-4d03-a4bd-eaa9d0db4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60b8a360>]}
[0m05:13:55.937822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72673c95-3168-4d03-a4bd-eaa9d0db4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff564d9ee0>]}
[0m05:13:55.938031 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m05:13:55.938342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72673c95-3168-4d03-a4bd-eaa9d0db4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7dd130>]}
[0m05:13:55.939254 [info ] [MainThread]: 
[0m05:13:55.939641 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:13:55.940262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_marts'
[0m05:13:55.945884 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_marts"
[0m05:13:55.946225 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_staging'
[0m05:13:55.946589 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_intermediate'
[0m05:13:55.946742 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_marts"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_marts limit 10000
[0m05:13:55.947136 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_snapshots'
[0m05:13:55.948120 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_staging"
[0m05:13:55.949049 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m05:13:55.949242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:13:55.950091 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_snapshots"
[0m05:13:55.950266 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_staging"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_staging limit 10000
[0m05:13:55.950447 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_intermediate"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_intermediate limit 10000
[0m05:13:55.951637 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_snapshots"} */
show terse objects in USER_DB_JACKAL.snapshots limit 10000
[0m05:13:55.951982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:13:55.952185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:13:55.952391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:13:56.364549 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c09939-0307-1cc7-000f-c0df008f6e8a
[0m05:13:56.365018 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m05:13:56.365452 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m05:13:56.365805 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:13:56.366169 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: Close
[0m05:13:56.388382 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:13:56.388893 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:13:56.390015 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m05:13:56.390963 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m05:13:56.393911 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:13:56.394714 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m05:13:56.580406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72673c95-3168-4d03-a4bd-eaa9d0db4646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56927080>]}
[0m05:13:56.582044 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:13:56.583266 [info ] [MainThread]: 
[0m05:13:56.595351 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:13:56.596727 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:13:56.597265 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c
[0m05:13:56.597750 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_stock_data_symbol__AAPL__GOOG ........... [RUN]
[0m05:13:56.598306 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:13:56.598738 [info ] [Thread-2 (]: 2 of 17 START test accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL  [RUN]
[0m05:13:56.599279 [info ] [Thread-3 (]: 3 of 17 START test dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 ......... [RUN]
[0m05:13:56.600188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_staging, now test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976)
[0m05:13:56.600635 [info ] [Thread-4 (]: 4 of 17 START test dbt_utils_unique_combination_of_columns_moving_averages_symbol__date  [RUN]
[0m05:13:56.601407 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_marts, now test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999)
[0m05:13:56.602085 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_intermediate, now test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c)
[0m05:13:56.602493 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:13:56.603118 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_snapshots, now test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81)
[0m05:13:56.603580 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:13:56.603993 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c
[0m05:13:56.615271 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m05:13:56.615574 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:13:56.620099 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m05:13:56.626527 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c"
[0m05:13:56.631975 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81"
[0m05:13:56.633166 [debug] [Thread-1 (]: Timing info for test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976 (compile): 05:13:56.604279 => 05:13:56.633043
[0m05:13:56.633460 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:13:56.633712 [debug] [Thread-2 (]: Timing info for test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999 (compile): 05:13:56.615852 => 05:13:56.633603
[0m05:13:56.634001 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c (compile): 05:13:56.620350 => 05:13:56.633869
[0m05:13:56.643673 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m05:13:56.644235 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:13:56.644548 [debug] [Thread-4 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81 (compile): 05:13:56.626867 => 05:13:56.644411
[0m05:13:56.644778 [debug] [Thread-3 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c
[0m05:13:56.646745 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m05:13:56.647106 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:13:56.648720 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c"
[0m05:13:56.649419 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m05:13:56.650700 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81"
[0m05:13:56.651258 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        symbol as value_field,
        count(*) as n_records

    from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    group by symbol

)

select *
from all_values
where value_field not in (
    'AAPL','GOOG'
)



      
    ) dbt_internal_test
[0m05:13:56.651774 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m05:13:56.652110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:13:56.652470 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c"
[0m05:13:56.652671 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        combined_signal as value_field,
        count(*) as n_records

    from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
    group by combined_signal

)

select *
from all_values
where value_field not in (
    'STRONG_BUY','BUY','HOLD','SELL','STRONG_SELL','NEUTRAL'
)



      
    ) dbt_internal_test
[0m05:13:56.653852 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi

where not(rsi_14 >= 0 AND <= 100)


      
    ) dbt_internal_test
[0m05:13:56.654484 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81"
[0m05:13:56.654688 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:13:56.654995 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:13:56.655396 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        symbol, date
    from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
    group by symbol, date
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m05:13:56.657144 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:13:57.036894 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c09939-0307-1be1-000f-c0df00900476
[0m05:13:57.037225 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 26 unexpected '<='.
syntax error line 18 at position 4 unexpected ')'.
[0m05:13:57.037537 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c (execute): 05:13:56.647387 => 05:13:57.037439
[0m05:13:57.037746 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c: Close
[0m05:13:57.149687 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 (models/schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 26 unexpected '<='.
  syntax error line 18 at position 4 unexpected ')'.
  compiled Code at target/run/stock_analytics/models/schema.yml/dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.sql
[0m05:13:57.150252 [error] [Thread-3 (]: 3 of 17 ERROR dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 .............. [[31mERROR[0m in 0.55s]
[0m05:13:57.150948 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c
[0m05:13:57.151303 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:13:57.152068 [info ] [Thread-3 (]: 5 of 17 START test dbt_utils_unique_combination_of_columns_rsi_symbol__date .... [RUN]
[0m05:13:57.152580 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.23778d5d9c, now test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830)
[0m05:13:57.152874 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:13:57.155894 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830"
[0m05:13:57.156884 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830 (compile): 05:13:57.153090 => 05:13:57.156705
[0m05:13:57.157206 [debug] [Thread-3 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:13:57.158983 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830"
[0m05:13:57.159840 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830"
[0m05:13:57.160108 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        symbol, date
    from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
    group by symbol, date
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m05:13:57.160345 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:13:57.240646 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:57.245795 [debug] [Thread-4 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81 (execute): 05:13:56.649542 => 05:13:57.245586
[0m05:13:57.246183 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81: Close
[0m05:13:57.332196 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:57.335301 [debug] [Thread-2 (]: Timing info for test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999 (execute): 05:13:56.645259 => 05:13:57.335001
[0m05:13:57.335811 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999: Close
[0m05:13:57.385664 [info ] [Thread-4 (]: 4 of 17 PASS dbt_utils_unique_combination_of_columns_moving_averages_symbol__date  [[32mPASS[0m in 0.78s]
[0m05:13:57.387650 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:13:57.388497 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:13:57.389185 [info ] [Thread-4 (]: 6 of 17 START test not_null_moving_averages_date ............................... [RUN]
[0m05:13:57.390581 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81, now test.stock_analytics.not_null_moving_averages_date.2eb91e4683)
[0m05:13:57.391239 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:13:57.398706 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m05:13:57.400462 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_moving_averages_date.2eb91e4683 (compile): 05:13:57.391605 => 05:13:57.400261
[0m05:13:57.400846 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:13:57.403707 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m05:13:57.406700 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m05:13:57.407119 [debug] [Thread-4 (]: On test.stock_analytics.not_null_moving_averages_date.2eb91e4683: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
where date is null



      
    ) dbt_internal_test
[0m05:13:57.407472 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:13:57.484237 [info ] [Thread-2 (]: 2 of 17 PASS accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL  [[32mPASS[0m in 0.88s]
[0m05:13:57.485364 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:13:57.485881 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:13:57.486388 [info ] [Thread-2 (]: 7 of 17 START test not_null_moving_averages_symbol ............................. [RUN]
[0m05:13:57.487315 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999, now test.stock_analytics.not_null_moving_averages_symbol.153f328246)
[0m05:13:57.487760 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:13:57.492217 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m05:13:57.494399 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_moving_averages_symbol.153f328246 (compile): 05:13:57.488038 => 05:13:57.494205
[0m05:13:57.494852 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:13:57.497080 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m05:13:57.498318 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m05:13:57.498652 [debug] [Thread-2 (]: On test.stock_analytics.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m05:13:57.498984 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:13:57.672735 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:57.674866 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830 (execute): 05:13:57.157397 => 05:13:57.674636
[0m05:13:57.675317 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830: Close
[0m05:13:57.684726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:57.686446 [debug] [Thread-1 (]: Timing info for test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976 (execute): 05:13:56.634134 => 05:13:57.686243
[0m05:13:57.686807 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976: Close
[0m05:13:57.802321 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_stock_data_symbol__AAPL__GOOG ................. [[32mPASS[0m in 1.20s]
[0m05:13:57.804083 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:13:57.804945 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:13:57.805678 [info ] [Thread-1 (]: 8 of 17 START test not_null_rsi_date ........................................... [RUN]
[0m05:13:57.807031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976, now test.stock_analytics.not_null_rsi_date.da56752005)
[0m05:13:57.809598 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:13:57.816956 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_date.da56752005"
[0m05:13:57.819548 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_rsi_date.da56752005 (compile): 05:13:57.809974 => 05:13:57.819222
[0m05:13:57.820131 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:13:57.823176 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_date.da56752005"
[0m05:13:57.824707 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_date.da56752005"
[0m05:13:57.825108 [debug] [Thread-1 (]: On test.stock_analytics.not_null_rsi_date.da56752005: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_date.da56752005"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where date is null



      
    ) dbt_internal_test
[0m05:13:57.825533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:13:57.834186 [info ] [Thread-3 (]: 5 of 17 PASS dbt_utils_unique_combination_of_columns_rsi_symbol__date .......... [[32mPASS[0m in 0.68s]
[0m05:13:57.835092 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:13:57.835457 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:13:57.835788 [info ] [Thread-3 (]: 9 of 17 START test not_null_rsi_rsi_14 ......................................... [RUN]
[0m05:13:57.836375 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830, now test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899)
[0m05:13:57.836714 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:13:57.840174 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m05:13:57.841601 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899 (compile): 05:13:57.836945 => 05:13:57.841453
[0m05:13:57.841894 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:13:57.843737 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m05:13:57.844635 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m05:13:57.844893 [debug] [Thread-3 (]: On test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where rsi_14 is null



      
    ) dbt_internal_test
[0m05:13:57.845183 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:13:57.864736 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:13:57.866133 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_moving_averages_date.2eb91e4683 (execute): 05:13:57.401326 => 05:13:57.865982
[0m05:13:57.866435 [debug] [Thread-4 (]: On test.stock_analytics.not_null_moving_averages_date.2eb91e4683: Close
[0m05:13:58.043323 [info ] [Thread-4 (]: 6 of 17 PASS not_null_moving_averages_date ..................................... [[32mPASS[0m in 0.65s]
[0m05:13:58.044498 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:13:58.045114 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:13:58.045570 [info ] [Thread-4 (]: 10 of 17 START test not_null_rsi_symbol ........................................ [RUN]
[0m05:13:58.046460 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_moving_averages_date.2eb91e4683, now test.stock_analytics.not_null_rsi_symbol.21add3cf05)
[0m05:13:58.046898 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:13:58.052825 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m05:13:58.054173 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_rsi_symbol.21add3cf05 (compile): 05:13:58.047211 => 05:13:58.053938
[0m05:13:58.054585 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:13:58.056965 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m05:13:58.058419 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m05:13:58.058735 [debug] [Thread-4 (]: On test.stock_analytics.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where symbol is null



      
    ) dbt_internal_test
[0m05:13:58.059064 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:13:58.173582 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:58.175671 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_moving_averages_symbol.153f328246 (execute): 05:13:57.495130 => 05:13:58.175461
[0m05:13:58.176077 [debug] [Thread-2 (]: On test.stock_analytics.not_null_moving_averages_symbol.153f328246: Close
[0m05:13:58.310532 [info ] [Thread-2 (]: 7 of 17 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.82s]
[0m05:13:58.312198 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:13:58.312956 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:13:58.313601 [info ] [Thread-2 (]: 11 of 17 START test not_null_stg_stock_data_close .............................. [RUN]
[0m05:13:58.315317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_moving_averages_symbol.153f328246, now test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db)
[0m05:13:58.318612 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:13:58.325855 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m05:13:58.328144 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:13:58.330363 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899 (execute): 05:13:57.842119 => 05:13:58.330118
[0m05:13:58.330849 [debug] [Thread-3 (]: On test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899: Close
[0m05:13:58.332296 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db (compile): 05:13:58.319493 => 05:13:58.332080
[0m05:13:58.333268 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:13:58.336056 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m05:13:58.337314 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m05:13:58.337690 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where close is null



      
    ) dbt_internal_test
[0m05:13:58.338046 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:13:58.457882 [info ] [Thread-3 (]: 9 of 17 PASS not_null_rsi_rsi_14 ............................................... [[32mPASS[0m in 0.62s]
[0m05:13:58.459900 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:13:58.461070 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:13:58.461763 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:13:58.464370 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_rsi_symbol.21add3cf05 (execute): 05:13:58.054846 => 05:13:58.464126
[0m05:13:58.464990 [info ] [Thread-3 (]: 12 of 17 START test not_null_stg_stock_data_date ............................... [RUN]
[0m05:13:58.466032 [debug] [Thread-4 (]: On test.stock_analytics.not_null_rsi_symbol.21add3cf05: Close
[0m05:13:58.470964 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899, now test.stock_analytics.not_null_stg_stock_data_date.96adead1a7)
[0m05:13:58.474106 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:13:58.478060 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m05:13:58.479320 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_date.96adead1a7 (compile): 05:13:58.474679 => 05:13:58.479164
[0m05:13:58.479621 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:13:58.481510 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m05:13:58.483052 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m05:13:58.483332 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_data_date.96adead1a7: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where date is null



      
    ) dbt_internal_test
[0m05:13:58.483584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:13:58.538318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:58.539940 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_rsi_date.da56752005 (execute): 05:13:57.820485 => 05:13:58.539746
[0m05:13:58.540295 [debug] [Thread-1 (]: On test.stock_analytics.not_null_rsi_date.da56752005: Close
[0m05:13:58.621646 [info ] [Thread-4 (]: 10 of 17 PASS not_null_rsi_symbol .............................................. [[32mPASS[0m in 0.58s]
[0m05:13:58.622664 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:13:58.623155 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:13:58.623583 [info ] [Thread-4 (]: 13 of 17 START test not_null_stg_stock_data_symbol ............................. [RUN]
[0m05:13:58.624416 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_symbol.21add3cf05, now test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e)
[0m05:13:58.624830 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:13:58.629119 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m05:13:58.632278 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e (compile): 05:13:58.625129 => 05:13:58.632081
[0m05:13:58.633982 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:13:58.636625 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m05:13:58.637835 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m05:13:58.638183 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where symbol is null



      
    ) dbt_internal_test
[0m05:13:58.638544 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:13:58.669999 [info ] [Thread-1 (]: 8 of 17 PASS not_null_rsi_date ................................................. [[32mPASS[0m in 0.86s]
[0m05:13:58.670878 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:13:58.671298 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:13:58.671668 [info ] [Thread-1 (]: 14 of 17 START test not_null_stock_analytics_mart_date ......................... [RUN]
[0m05:13:58.672401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_date.da56752005, now test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b)
[0m05:13:58.672783 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:13:58.676309 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m05:13:58.680651 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b (compile): 05:13:58.673034 => 05:13:58.680495
[0m05:13:58.681035 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:13:58.686095 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m05:13:58.688646 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m05:13:58.689135 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
where date is null



      
    ) dbt_internal_test
[0m05:13:58.690335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:13:58.908021 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:58.909262 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db (execute): 05:13:58.333612 => 05:13:58.909132
[0m05:13:58.909537 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db: Close
[0m05:13:59.009422 [info ] [Thread-2 (]: 11 of 17 PASS not_null_stg_stock_data_close .................................... [[32mPASS[0m in 0.69s]
[0m05:13:59.010194 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:13:59.010577 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:13:59.010906 [info ] [Thread-2 (]: 15 of 17 START test not_null_stock_analytics_mart_symbol ....................... [RUN]
[0m05:13:59.011480 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db, now test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0)
[0m05:13:59.011812 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:13:59.015044 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m05:13:59.016096 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0 (compile): 05:13:59.012091 => 05:13:59.015958
[0m05:13:59.016387 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:13:59.018022 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m05:13:59.018899 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m05:13:59.019183 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
where symbol is null



      
    ) dbt_internal_test
[0m05:13:59.019446 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:13:59.130511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:13:59.132502 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b (execute): 05:13:58.681344 => 05:13:59.132312
[0m05:13:59.133105 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:59.133426 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b: Close
[0m05:13:59.134768 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_date.96adead1a7 (execute): 05:13:58.479823 => 05:13:59.134620
[0m05:13:59.135711 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stg_stock_data_date.96adead1a7: Close
[0m05:13:59.149418 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:59.150728 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e (execute): 05:13:58.634678 => 05:13:59.150588
[0m05:13:59.151030 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e: Close
[0m05:13:59.267676 [info ] [Thread-1 (]: 14 of 17 PASS not_null_stock_analytics_mart_date ............................... [[32mPASS[0m in 0.59s]
[0m05:13:59.269468 [info ] [Thread-4 (]: 13 of 17 PASS not_null_stg_stock_data_symbol ................................... [[32mPASS[0m in 0.65s]
[0m05:13:59.270340 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:13:59.271132 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:13:59.271821 [debug] [Thread-1 (]: Began running node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:13:59.272495 [debug] [Thread-4 (]: Began running node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:13:59.273247 [info ] [Thread-1 (]: 16 of 17 START test source_not_null_raw_stock_data_lab_date .................... [RUN]
[0m05:13:59.274982 [info ] [Thread-4 (]: 17 of 17 START test source_not_null_raw_stock_data_lab_symbol .................. [RUN]
[0m05:13:59.276314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b, now test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740)
[0m05:13:59.277207 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e, now test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f)
[0m05:13:59.278525 [info ] [Thread-3 (]: 12 of 17 PASS not_null_stg_stock_data_date ..................................... [[32mPASS[0m in 0.81s]
[0m05:13:59.278951 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:13:59.279386 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:13:59.280267 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:13:59.285246 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m05:13:59.289543 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m05:13:59.291539 [debug] [Thread-1 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740 (compile): 05:13:59.280898 => 05:13:59.291324
[0m05:13:59.292185 [debug] [Thread-4 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f (compile): 05:13:59.285820 => 05:13:59.291950
[0m05:13:59.292587 [debug] [Thread-1 (]: Began executing node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:13:59.293059 [debug] [Thread-4 (]: Began executing node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:13:59.295415 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m05:13:59.297493 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m05:13:59.299059 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m05:13:59.299459 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.RAW.stock_data_lab
where date is null



      
    ) dbt_internal_test
[0m05:13:59.299925 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m05:13:59.300195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:13:59.300520 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.RAW.stock_data_lab
where symbol is null



      
    ) dbt_internal_test
[0m05:13:59.301648 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:13:59.586263 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:59.590375 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0 (execute): 05:13:59.016554 => 05:13:59.590007
[0m05:13:59.591168 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0: Close
[0m05:13:59.695095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:13:59.698536 [debug] [Thread-1 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740 (execute): 05:13:59.293367 => 05:13:59.698173
[0m05:13:59.699254 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740: Close
[0m05:13:59.740868 [info ] [Thread-2 (]: 15 of 17 PASS not_null_stock_analytics_mart_symbol ............................. [[32mPASS[0m in 0.73s]
[0m05:13:59.743185 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:13:59.813844 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:13:59.817903 [debug] [Thread-4 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f (execute): 05:13:59.295720 => 05:13:59.817538
[0m05:13:59.818571 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f: Close
[0m05:13:59.954313 [info ] [Thread-1 (]: 16 of 17 PASS source_not_null_raw_stock_data_lab_date .......................... [[32mPASS[0m in 0.68s]
[0m05:13:59.956132 [debug] [Thread-1 (]: Finished running node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:13:59.959141 [info ] [Thread-4 (]: 17 of 17 PASS source_not_null_raw_stock_data_lab_symbol ........................ [[32mPASS[0m in 0.68s]
[0m05:13:59.960259 [debug] [Thread-4 (]: Finished running node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:13:59.963347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:13:59.964045 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0' was properly closed.
[0m05:13:59.964522 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740' was properly closed.
[0m05:13:59.964970 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stg_stock_data_date.96adead1a7' was properly closed.
[0m05:13:59.965375 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f' was properly closed.
[0m05:13:59.965951 [info ] [MainThread]: 
[0m05:13:59.966642 [info ] [MainThread]: Finished running 17 tests in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m05:13:59.968957 [debug] [MainThread]: Command end result
[0m05:13:59.981945 [info ] [MainThread]: 
[0m05:13:59.982493 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:13:59.982770 [info ] [MainThread]: 
[0m05:13:59.983289 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100 (models/schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 26 unexpected '<='.
  syntax error line 18 at position 4 unexpected ')'.
  compiled Code at target/run/stock_analytics/models/schema.yml/dbt_utils_expression_is_true_rsi_rsi_14___0_AND_100.sql
[0m05:13:59.983703 [info ] [MainThread]: 
[0m05:13:59.984050 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=1 SKIP=0 TOTAL=17
[0m05:13:59.984722 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.493797, "process_user_time": 2.941651, "process_kernel_time": 0.137054, "process_mem_max_rss": "220224", "process_out_blocks": "2573", "command_success": false, "process_in_blocks": "0"}
[0m05:13:59.985102 [debug] [MainThread]: Command `dbt test` failed at 05:13:59.985014 after 4.49 seconds
[0m05:13:59.985403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be43ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff566198e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5661a5a0>]}
[0m05:13:59.985721 [debug] [MainThread]: Flushing usage events
[0m05:18:21.606226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9221b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9223f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9213a180>]}


============================== 05:18:21.610728 | da4b896b-e5e6-48ac-a413-b9b11b7d1664 ==============================
[0m05:18:21.610728 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:18:21.611155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:18:21.660880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da4b896b-e5e6-48ac-a413-b9b11b7d1664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9226eff0>]}
[0m05:18:21.697269 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1uht1ks1'
[0m05:18:21.697541 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:18:21.801891 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:18:21.802493 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:18:21.862359 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:18:21.865811 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:18:22.337934 [info ] [MainThread]: Installed from version 1.1.1
[0m05:18:22.338434 [info ] [MainThread]: Updated version available: 1.3.2
[0m05:18:22.338781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'da4b896b-e5e6-48ac-a413-b9b11b7d1664', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fd4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fd48c0>]}
[0m05:18:22.339047 [info ] [MainThread]: 
[0m05:18:22.339394 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m05:18:22.340061 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.75583756, "process_user_time": 1.054419, "process_kernel_time": 0.097594, "process_mem_max_rss": "219396", "process_out_blocks": "2078", "process_in_blocks": "0"}
[0m05:18:22.340344 [debug] [MainThread]: Command `dbt deps` succeeded at 05:18:22.340275 after 0.76 seconds
[0m05:18:22.340533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921d57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9223f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9209cfb0>]}
[0m05:18:22.340724 [debug] [MainThread]: Flushing usage events
[0m05:18:24.700256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896b54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d8b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff879bdb80>]}


============================== 05:18:24.703263 | b41370dc-0818-41ac-828c-159f8f085e14 ==============================
[0m05:18:24.703263 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:18:24.703743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:18:25.053132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b41370dc-0818-41ac-828c-159f8f085e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cb1ec30>]}
[0m05:18:25.083257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b41370dc-0818-41ac-828c-159f8f085e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87841430>]}
[0m05:18:25.083603 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m05:18:25.088742 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:18:25.118043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:18:25.118403 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/schema.yml
[0m05:18:25.264440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b41370dc-0818-41ac-828c-159f8f085e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61f98fb0>]}
[0m05:18:25.271408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b41370dc-0818-41ac-828c-159f8f085e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6255e930>]}
[0m05:18:25.271645 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m05:18:25.272019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b41370dc-0818-41ac-828c-159f8f085e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6233b230>]}
[0m05:18:25.272904 [info ] [MainThread]: 
[0m05:18:25.273343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:18:25.273974 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m05:18:25.279102 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m05:18:25.279462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m05:18:25.279703 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m05:18:25.280070 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m05:18:25.281113 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m05:18:25.281303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:18:25.282428 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m05:18:25.282620 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m05:18:25.283323 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m05:18:25.283951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:18:25.284297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:18:25.712259 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m05:18:25.712827 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m05:18:25.713962 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m05:18:25.715019 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m05:18:25.987385 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m05:18:25.989860 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m05:18:26.109365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_ANALYTICS_staging)
[0m05:18:26.117662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_ANALYTICS_intermediate)
[0m05:18:26.118400 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_staging"
[0m05:18:26.119117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_ANALYTICS_marts)
[0m05:18:26.121037 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m05:18:26.121814 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_snapshots'
[0m05:18:26.122175 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_staging"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_staging limit 10000
[0m05:18:26.123991 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_marts"
[0m05:18:26.124345 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_intermediate"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_intermediate limit 10000
[0m05:18:26.126055 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_snapshots"
[0m05:18:26.126405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:18:26.126733 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_marts"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_marts limit 10000
[0m05:18:26.127052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:18:26.127393 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_snapshots"} */
show terse objects in USER_DB_JACKAL.snapshots limit 10000
[0m05:18:26.128297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:18:26.130011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:18:26.471603 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:26.474333 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m05:18:26.480650 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c0993e-0307-1dc4-000f-c0df008fbc8a
[0m05:18:26.481270 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m05:18:26.481873 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m05:18:26.482284 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:18:26.482770 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: Close
[0m05:18:26.491074 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:18:26.493440 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m05:18:26.514528 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:26.516423 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m05:18:26.657703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b41370dc-0818-41ac-828c-159f8f085e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61b380b0>]}
[0m05:18:26.658906 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:18:26.659485 [info ] [MainThread]: 
[0m05:18:26.666570 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_data
[0m05:18:26.667014 [info ] [Thread-1 (]: 1 of 4 START sql view model ANALYTICS_staging.stg_stock_data ................... [RUN]
[0m05:18:26.667667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_marts, now model.stock_analytics.stg_stock_data)
[0m05:18:26.667970 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_data
[0m05:18:26.672449 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_data"
[0m05:18:26.673624 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stg_stock_data (compile): 05:18:26.668166 => 05:18:26.673459
[0m05:18:26.673929 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_data
[0m05:18:26.687857 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_data"
[0m05:18:26.689110 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_data"
[0m05:18:26.689371 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_data"} */
create or replace   view USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
  
   as (
    

WITH source_data AS (
    SELECT
        symbol,
        date,
        open,
        high,
        low,
        close,
        volume
    FROM USER_DB_JACKAL.RAW.stock_data_lab
    WHERE date IS NOT NULL
        AND symbol IS NOT NULL
)

SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume,
    -- Add data quality flags
    CASE 
        WHEN open IS NULL OR high IS NULL OR low IS NULL OR close IS NULL 
        THEN TRUE 
        ELSE FALSE 
    END AS has_null_prices,
    -- Validate price relationships
    CASE 
        WHEN high < low 
            OR high < open 
            OR high < close 
            OR low > open 
            OR low > close 
        THEN TRUE 
        ELSE FALSE 
    END AS has_invalid_prices
FROM source_data
  );
[0m05:18:26.689631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:27.246633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:18:27.264904 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stg_stock_data (execute): 05:18:26.674109 => 05:18:27.264730
[0m05:18:27.265320 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_data: Close
[0m05:18:27.378573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b41370dc-0818-41ac-828c-159f8f085e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff613fb200>]}
[0m05:18:27.380052 [info ] [Thread-1 (]: 1 of 4 OK created sql view model ANALYTICS_staging.stg_stock_data .............. [[32mSUCCESS 1[0m in 0.71s]
[0m05:18:27.381803 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_data
[0m05:18:27.383456 [debug] [Thread-3 (]: Began running node model.stock_analytics.moving_averages
[0m05:18:27.384070 [debug] [Thread-4 (]: Began running node model.stock_analytics.rsi
[0m05:18:27.384754 [info ] [Thread-3 (]: 2 of 4 START sql table model ANALYTICS_intermediate.moving_averages ............ [RUN]
[0m05:18:27.385755 [info ] [Thread-4 (]: 3 of 4 START sql table model ANALYTICS_intermediate.rsi ........................ [RUN]
[0m05:18:27.386870 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_snapshots, now model.stock_analytics.moving_averages)
[0m05:18:27.387894 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_staging, now model.stock_analytics.rsi)
[0m05:18:27.388805 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.moving_averages
[0m05:18:27.389429 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.rsi
[0m05:18:27.395060 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.moving_averages"
[0m05:18:27.398324 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.rsi"
[0m05:18:27.400664 [debug] [Thread-3 (]: Timing info for model.stock_analytics.moving_averages (compile): 05:18:27.390026 => 05:18:27.400455
[0m05:18:27.401184 [debug] [Thread-4 (]: Timing info for model.stock_analytics.rsi (compile): 05:18:27.395460 => 05:18:27.400921
[0m05:18:27.401595 [debug] [Thread-3 (]: Began executing node model.stock_analytics.moving_averages
[0m05:18:27.402039 [debug] [Thread-4 (]: Began executing node model.stock_analytics.rsi
[0m05:18:27.423343 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.moving_averages"
[0m05:18:27.423748 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.rsi"
[0m05:18:27.425540 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.moving_averages"
[0m05:18:27.425889 [debug] [Thread-3 (]: On model.stock_analytics.moving_averages: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.moving_averages"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
         as
        (

WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    WHERE has_null_prices = FALSE
        AND has_invalid_prices = FALSE
),

moving_averages AS (
    SELECT
        symbol,
        date,
        close,
        -- 7-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS sma_7,
        -- 14-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS sma_14,
        -- 30-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
        ) AS sma_30,
        -- 50-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS sma_50,
        -- Count of days for MA calculation validation
        COUNT(*) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS days_count
    FROM stock_data
)

SELECT
    symbol,
    date,
    close,
    ROUND(sma_7, 2) AS sma_7,
    ROUND(sma_14, 2) AS sma_14,
    ROUND(sma_30, 2) AS sma_30,
    ROUND(sma_50, 2) AS sma_50,
    -- Calculate crossover signals
    CASE 
        WHEN sma_7 > sma_14 THEN 'BULLISH_SHORT'
        WHEN sma_7 < sma_14 THEN 'BEARISH_SHORT'
        ELSE 'NEUTRAL'
    END AS signal_7_14,
    CASE 
        WHEN sma_14 > sma_30 THEN 'BULLISH_MED'
        WHEN sma_14 < sma_30 THEN 'BEARISH_MED'
        ELSE 'NEUTRAL'
    END AS signal_14_30,
    -- Price vs MA comparison
    ROUND(((close - sma_50) / NULLIF(sma_50, 0)) * 100, 2) AS pct_from_sma_50
FROM moving_averages
WHERE days_count >= 7  -- Ensure we have enough data for at least the shortest MA
        );
[0m05:18:27.427280 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.rsi"
[0m05:18:27.427504 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:18:27.427808 [debug] [Thread-4 (]: On model.stock_analytics.rsi: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.rsi"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_intermediate.rsi
         as
        (

WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    WHERE has_null_prices = FALSE
        AND has_invalid_prices = FALSE
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        close - LAG(close, 1) OVER (PARTITION BY symbol ORDER BY date) AS price_change
    FROM stock_data
),

gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
    WHERE price_change IS NOT NULL
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        gain,
        loss,
        -- 14-period average gain
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain_14,
        -- 14-period average loss
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss_14,
        -- Count periods for validation
        COUNT(*) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS period_count
    FROM gains_losses
),

rsi_calculation AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        avg_gain_14,
        avg_loss_14,
        period_count,
        -- Calculate RS (Relative Strength)
        CASE 
            WHEN avg_loss_14 = 0 THEN NULL
            ELSE avg_gain_14 / NULLIF(avg_loss_14, 0)
        END AS rs,
        -- Calculate RSI
        CASE 
            WHEN avg_loss_14 = 0 THEN 100
            WHEN avg_gain_14 = 0 THEN 0
            ELSE 100 - (100 / (1 + (avg_gain_14 / NULLIF(avg_loss_14, 0))))
        END AS rsi_14
    FROM average_gains_losses
    WHERE period_count >= 14  -- Ensure we have enough periods
)

SELECT
    symbol,
    date,
    close,
    ROUND(price_change, 2) AS price_change,
    ROUND(rsi_14, 2) AS rsi_14,
    -- RSI interpretation signals
    CASE 
        WHEN rsi_14 >= 70 THEN 'OVERBOUGHT'
        WHEN rsi_14 <= 30 THEN 'OVERSOLD'
        WHEN rsi_14 > 50 THEN 'BULLISH'
        WHEN rsi_14 < 50 THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS rsi_signal,
    -- RSI momentum
    CASE 
        WHEN rsi_14 > LAG(rsi_14, 1) OVER (PARTITION BY symbol ORDER BY date) 
        THEN 'INCREASING'
        WHEN rsi_14 < LAG(rsi_14, 1) OVER (PARTITION BY symbol ORDER BY date) 
        THEN 'DECREASING'
        ELSE 'FLAT'
    END AS rsi_momentum
FROM rsi_calculation
ORDER BY symbol, date
        );
[0m05:18:27.428901 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:18:28.537860 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:18:28.542819 [debug] [Thread-4 (]: Timing info for model.stock_analytics.rsi (execute): 05:18:27.416482 => 05:18:28.542497
[0m05:18:28.543542 [debug] [Thread-4 (]: On model.stock_analytics.rsi: Close
[0m05:18:28.547895 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:18:28.551125 [debug] [Thread-3 (]: Timing info for model.stock_analytics.moving_averages (execute): 05:18:27.402328 => 05:18:28.550922
[0m05:18:28.551577 [debug] [Thread-3 (]: On model.stock_analytics.moving_averages: Close
[0m05:18:28.654030 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b41370dc-0818-41ac-828c-159f8f085e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff613cd250>]}
[0m05:18:28.655086 [info ] [Thread-3 (]: 2 of 4 OK created sql table model ANALYTICS_intermediate.moving_averages ....... [[32mSUCCESS 1[0m in 1.27s]
[0m05:18:28.656332 [debug] [Thread-3 (]: Finished running node model.stock_analytics.moving_averages
[0m05:18:28.666708 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b41370dc-0818-41ac-828c-159f8f085e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a4a70b0>]}
[0m05:18:28.667392 [info ] [Thread-4 (]: 3 of 4 OK created sql table model ANALYTICS_intermediate.rsi ................... [[32mSUCCESS 1[0m in 1.28s]
[0m05:18:28.668128 [debug] [Thread-4 (]: Finished running node model.stock_analytics.rsi
[0m05:18:28.668981 [debug] [Thread-1 (]: Began running node model.stock_analytics.stock_analytics_mart
[0m05:18:28.669481 [info ] [Thread-1 (]: 4 of 4 START sql table model ANALYTICS_marts.stock_analytics_mart .............. [RUN]
[0m05:18:28.670313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_data, now model.stock_analytics.stock_analytics_mart)
[0m05:18:28.670712 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stock_analytics_mart
[0m05:18:28.674246 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stock_analytics_mart"
[0m05:18:28.676544 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stock_analytics_mart (compile): 05:18:28.670965 => 05:18:28.676385
[0m05:18:28.676889 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stock_analytics_mart
[0m05:18:28.678996 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stock_analytics_mart"
[0m05:18:28.681013 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stock_analytics_mart"
[0m05:18:28.681371 [debug] [Thread-1 (]: On model.stock_analytics.stock_analytics_mart: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stock_analytics_mart"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
         as
        (

WITH moving_averages AS (
    SELECT * FROM USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
),

rsi AS (
    SELECT * FROM USER_DB_JACKAL.ANALYTICS_intermediate.rsi
),

combined_analytics AS (
    SELECT
        ma.symbol,
        ma.date,
        ma.close,
        -- Moving Averages
        ma.sma_7,
        ma.sma_14,
        ma.sma_30,
        ma.sma_50,
        ma.signal_7_14,
        ma.signal_14_30,
        ma.pct_from_sma_50,
        -- RSI Indicators
        rsi.rsi_14,
        rsi.rsi_signal,
        rsi.rsi_momentum,
        rsi.price_change,
        -- Combined trading signal
        CASE
            WHEN rsi.rsi_14 <= 30 AND ma.signal_7_14 = 'BULLISH_SHORT' THEN 'STRONG_BUY'
            WHEN rsi.rsi_14 >= 70 AND ma.signal_7_14 = 'BEARISH_SHORT' THEN 'STRONG_SELL'
            WHEN rsi.rsi_14 < 40 AND ma.signal_14_30 = 'BULLISH_MED' THEN 'BUY'
            WHEN rsi.rsi_14 > 60 AND ma.signal_14_30 = 'BEARISH_MED' THEN 'SELL'
            WHEN rsi.rsi_14 BETWEEN 40 AND 60 THEN 'HOLD'
            ELSE 'NEUTRAL'
        END AS combined_signal,
        -- Volatility indicator (price % change)
        ROUND((rsi.price_change / NULLIF(ma.close - rsi.price_change, 0)) * 100, 2) AS daily_return_pct,
        -- Trend strength
        CASE
            WHEN ma.close > ma.sma_7 
                AND ma.sma_7 > ma.sma_14 
                AND ma.sma_14 > ma.sma_30 
            THEN 'STRONG_UPTREND'
            WHEN ma.close < ma.sma_7 
                AND ma.sma_7 < ma.sma_14 
                AND ma.sma_14 < ma.sma_30 
            THEN 'STRONG_DOWNTREND'
            WHEN ma.close > ma.sma_30 THEN 'UPTREND'
            WHEN ma.close < ma.sma_30 THEN 'DOWNTREND'
            ELSE 'SIDEWAYS'
        END AS trend_strength
    FROM moving_averages ma
    INNER JOIN rsi 
        ON ma.symbol = rsi.symbol 
        AND ma.date = rsi.date
)

SELECT
    symbol,
    date,
    close,
    sma_7,
    sma_14,
    sma_30,
    sma_50,
    rsi_14,
    signal_7_14,
    signal_14_30,
    rsi_signal,
    rsi_momentum,
    combined_signal,
    trend_strength,
    pct_from_sma_50,
    daily_return_pct,
    price_change
FROM combined_analytics
ORDER BY symbol, date DESC
        );
[0m05:18:28.681758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:30.562733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m05:18:30.567367 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stock_analytics_mart (execute): 05:18:28.677110 => 05:18:30.567028
[0m05:18:30.568348 [debug] [Thread-1 (]: On model.stock_analytics.stock_analytics_mart: Close
[0m05:18:30.696444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b41370dc-0818-41ac-828c-159f8f085e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff613ccbf0>]}
[0m05:18:30.697739 [info ] [Thread-1 (]: 4 of 4 OK created sql table model ANALYTICS_marts.stock_analytics_mart ......... [[32mSUCCESS 1[0m in 2.03s]
[0m05:18:30.699270 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stock_analytics_mart
[0m05:18:30.702028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:18:30.702489 [debug] [MainThread]: Connection 'model.stock_analytics.rsi' was properly closed.
[0m05:18:30.702889 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL_ANALYTICS_intermediate' was properly closed.
[0m05:18:30.703263 [debug] [MainThread]: Connection 'model.stock_analytics.stock_analytics_mart' was properly closed.
[0m05:18:30.703630 [debug] [MainThread]: Connection 'model.stock_analytics.moving_averages' was properly closed.
[0m05:18:30.704181 [info ] [MainThread]: 
[0m05:18:30.705074 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m05:18:30.706209 [debug] [MainThread]: Command end result
[0m05:18:30.722809 [info ] [MainThread]: 
[0m05:18:30.723720 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:18:30.724109 [info ] [MainThread]: 
[0m05:18:30.724598 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:18:30.725625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.045487, "process_user_time": 2.745715, "process_kernel_time": 0.131129, "process_mem_max_rss": "225744", "process_out_blocks": "3703", "process_in_blocks": "0"}
[0m05:18:30.726160 [debug] [MainThread]: Command `dbt run` succeeded at 05:18:30.726039 after 6.05 seconds
[0m05:18:30.726630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aeeff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61774b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61776240>]}
[0m05:18:30.726984 [debug] [MainThread]: Flushing usage events
[0m05:18:33.713704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80290ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803a1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802c8e60>]}


============================== 05:18:33.716783 | 43e207bf-e2ab-4609-a2c3-a807eab6e685 ==============================
[0m05:18:33.716783 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:18:33.717277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:18:34.039826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43e207bf-e2ab-4609-a2c3-a807eab6e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f43f050>]}
[0m05:18:34.070791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43e207bf-e2ab-4609-a2c3-a807eab6e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f43f050>]}
[0m05:18:34.071158 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m05:18:34.075883 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:18:34.101226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:18:34.101435 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:18:34.103808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43e207bf-e2ab-4609-a2c3-a807eab6e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f69be60>]}
[0m05:18:34.109997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43e207bf-e2ab-4609-a2c3-a807eab6e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5eed3740>]}
[0m05:18:34.110231 [info ] [MainThread]: Found 4 models, 1 snapshot, 17 tests, 1 source, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m05:18:34.110695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43e207bf-e2ab-4609-a2c3-a807eab6e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6003a780>]}
[0m05:18:34.111857 [info ] [MainThread]: 
[0m05:18:34.112429 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:18:34.113197 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_marts'
[0m05:18:34.119054 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_marts"
[0m05:18:34.119377 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_snapshots'
[0m05:18:34.119585 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_marts"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_marts limit 10000
[0m05:18:34.119904 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_staging'
[0m05:18:34.120984 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_snapshots"
[0m05:18:34.121265 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_intermediate'
[0m05:18:34.121496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:18:34.122550 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_staging"
[0m05:18:34.122747 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_snapshots"} */
show terse objects in USER_DB_JACKAL.snapshots limit 10000
[0m05:18:34.123610 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m05:18:34.124767 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_staging"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_staging limit 10000
[0m05:18:34.125152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:18:34.125485 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_intermediate"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_intermediate limit 10000
[0m05:18:34.125867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:18:34.127073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:18:34.508043 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c0993e-0307-1dc4-000f-c0df008fbc92
[0m05:18:34.508519 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m05:18:34.508887 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m05:18:34.509131 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:18:34.509451 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: Close
[0m05:18:34.543102 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:34.543777 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:34.545184 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m05:18:34.545770 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:18:34.547030 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m05:18:34.548974 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m05:18:34.661644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43e207bf-e2ab-4609-a2c3-a807eab6e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5eff9f10>]}
[0m05:18:34.662238 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:18:34.662799 [info ] [MainThread]: 
[0m05:18:34.668429 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:18:34.669084 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:18:34.669385 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100.fb3610903e
[0m05:18:34.669667 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_stock_data_symbol__AAPL__GOOG ........... [RUN]
[0m05:18:34.669981 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:18:34.670232 [info ] [Thread-2 (]: 2 of 17 START test accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL  [RUN]
[0m05:18:34.670542 [info ] [Thread-3 (]: 3 of 17 START test dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100  [RUN]
[0m05:18:34.671037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_marts, now test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976)
[0m05:18:34.671326 [info ] [Thread-4 (]: 4 of 17 START test dbt_utils_unique_combination_of_columns_moving_averages_symbol__date  [RUN]
[0m05:18:34.671782 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_staging, now test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999)
[0m05:18:34.672218 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_intermediate, now test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100.fb3610903e)
[0m05:18:34.672503 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:18:34.672909 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_snapshots, now test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81)
[0m05:18:34.673177 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:18:34.673466 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100.fb3610903e
[0m05:18:34.681490 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m05:18:34.681724 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:18:34.685702 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m05:18:34.689930 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100.fb3610903e"
[0m05:18:34.694297 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81"
[0m05:18:34.695380 [debug] [Thread-1 (]: Timing info for test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976 (compile): 05:18:34.673639 => 05:18:34.695255
[0m05:18:34.695650 [debug] [Thread-2 (]: Timing info for test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999 (compile): 05:18:34.681902 => 05:18:34.695541
[0m05:18:34.695865 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:18:34.696083 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100.fb3610903e (compile): 05:18:34.685894 => 05:18:34.695980
[0m05:18:34.696330 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:18:34.696531 [debug] [Thread-4 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81 (compile): 05:18:34.690217 => 05:18:34.696438
[0m05:18:34.704074 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m05:18:34.704310 [debug] [Thread-3 (]: Began executing node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100.fb3610903e
[0m05:18:34.705450 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m05:18:34.705657 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:18:34.707021 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100.fb3610903e"
[0m05:18:34.708523 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81"
[0m05:18:34.709300 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m05:18:34.709680 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m05:18:34.709894 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        symbol as value_field,
        count(*) as n_records

    from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    group by symbol

)

select *
from all_values
where value_field not in (
    'AAPL','GOOG'
)



      
    ) dbt_internal_test
[0m05:18:34.710410 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        combined_signal as value_field,
        count(*) as n_records

    from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
    group by combined_signal

)

select *
from all_values
where value_field not in (
    'STRONG_BUY','BUY','HOLD','SELL','STRONG_SELL','NEUTRAL'
)



      
    ) dbt_internal_test
[0m05:18:34.710734 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81"
[0m05:18:34.711015 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100.fb3610903e"
[0m05:18:34.711219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:34.711412 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:18:34.711614 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        symbol, date
    from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
    group by symbol, date
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m05:18:34.711818 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100.fb3610903e: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100.fb3610903e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi

where not(rsi_14 rsi_14 >= 0 AND rsi_14 <= 100)


      
    ) dbt_internal_test
[0m05:18:34.713329 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:18:34.713580 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:18:35.083447 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c0993e-0307-1cc7-000f-c0df008f6eee
[0m05:18:35.084490 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 17 unexpected 'rsi_14'.
[0m05:18:35.085873 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100.fb3610903e (execute): 05:18:34.705889 => 05:18:35.085497
[0m05:18:35.087042 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100.fb3610903e: Close
[0m05:18:35.150522 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:35.157637 [debug] [Thread-2 (]: Timing info for test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999 (execute): 05:18:34.704451 => 05:18:35.157346
[0m05:18:35.158162 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999: Close
[0m05:18:35.191569 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:35.193749 [debug] [Thread-4 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81 (execute): 05:18:34.707504 => 05:18:35.193500
[0m05:18:35.194214 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81: Close
[0m05:18:35.207604 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100 (models/schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 17 unexpected 'rsi_14'.
  compiled Code at target/run/stock_analytics/models/schema.yml/dbt_utils_expression_is_true_r_fa6fefa9a62eaa1f55545eee4cdf9011.sql
[0m05:18:35.208166 [error] [Thread-3 (]: 3 of 17 ERROR dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100 . [[31mERROR[0m in 0.54s]
[0m05:18:35.209130 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100.fb3610903e
[0m05:18:35.209637 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:18:35.210611 [info ] [Thread-3 (]: 5 of 17 START test dbt_utils_unique_combination_of_columns_rsi_symbol__date .... [RUN]
[0m05:18:35.211405 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100.fb3610903e, now test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830)
[0m05:18:35.211743 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:18:35.215701 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830"
[0m05:18:35.217098 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830 (compile): 05:18:35.211968 => 05:18:35.216902
[0m05:18:35.217457 [debug] [Thread-3 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:18:35.220951 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830"
[0m05:18:35.222309 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830"
[0m05:18:35.222729 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        symbol, date
    from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
    group by symbol, date
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m05:18:35.223091 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:18:35.287165 [info ] [Thread-2 (]: 2 of 17 PASS accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL  [[32mPASS[0m in 0.62s]
[0m05:18:35.287845 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:18:35.288186 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:18:35.288493 [info ] [Thread-2 (]: 6 of 17 START test not_null_moving_averages_date ............................... [RUN]
[0m05:18:35.289085 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999, now test.stock_analytics.not_null_moving_averages_date.2eb91e4683)
[0m05:18:35.289367 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:18:35.293526 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m05:18:35.294939 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_moving_averages_date.2eb91e4683 (compile): 05:18:35.289554 => 05:18:35.294810
[0m05:18:35.295197 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:18:35.296753 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m05:18:35.297789 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m05:18:35.298047 [debug] [Thread-2 (]: On test.stock_analytics.not_null_moving_averages_date.2eb91e4683: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
where date is null



      
    ) dbt_internal_test
[0m05:18:35.298271 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:18:35.307200 [info ] [Thread-4 (]: 4 of 17 PASS dbt_utils_unique_combination_of_columns_moving_averages_symbol__date  [[32mPASS[0m in 0.63s]
[0m05:18:35.307740 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:18:35.308056 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:18:35.308345 [info ] [Thread-4 (]: 7 of 17 START test not_null_moving_averages_symbol ............................. [RUN]
[0m05:18:35.308803 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81, now test.stock_analytics.not_null_moving_averages_symbol.153f328246)
[0m05:18:35.309058 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:18:35.311533 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m05:18:35.312514 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_moving_averages_symbol.153f328246 (compile): 05:18:35.309246 => 05:18:35.312408
[0m05:18:35.312752 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:18:35.314237 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m05:18:35.315200 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m05:18:35.315449 [debug] [Thread-4 (]: On test.stock_analytics.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m05:18:35.315651 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:18:35.377901 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:18:35.379274 [debug] [Thread-1 (]: Timing info for test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976 (execute): 05:18:34.696692 => 05:18:35.379107
[0m05:18:35.379598 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976: Close
[0m05:18:35.499590 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_stock_data_symbol__AAPL__GOOG ................. [[32mPASS[0m in 0.83s]
[0m05:18:35.500580 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:18:35.501007 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:18:35.501427 [info ] [Thread-1 (]: 8 of 17 START test not_null_rsi_date ........................................... [RUN]
[0m05:18:35.502227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976, now test.stock_analytics.not_null_rsi_date.da56752005)
[0m05:18:35.502649 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:18:35.506635 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_date.da56752005"
[0m05:18:35.507979 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_rsi_date.da56752005 (compile): 05:18:35.502928 => 05:18:35.507829
[0m05:18:35.508259 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:18:35.510263 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_date.da56752005"
[0m05:18:35.511219 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_date.da56752005"
[0m05:18:35.511585 [debug] [Thread-1 (]: On test.stock_analytics.not_null_rsi_date.da56752005: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_date.da56752005"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where date is null



      
    ) dbt_internal_test
[0m05:18:35.511900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:35.705449 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:35.710488 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830 (execute): 05:18:35.217705 => 05:18:35.709762
[0m05:18:35.711646 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830: Close
[0m05:18:35.723517 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:35.726345 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_moving_averages_symbol.153f328246 (execute): 05:18:35.312916 => 05:18:35.726064
[0m05:18:35.727017 [debug] [Thread-4 (]: On test.stock_analytics.not_null_moving_averages_symbol.153f328246: Close
[0m05:18:35.796928 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:35.799795 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_moving_averages_date.2eb91e4683 (execute): 05:18:35.295375 => 05:18:35.799469
[0m05:18:35.800354 [debug] [Thread-2 (]: On test.stock_analytics.not_null_moving_averages_date.2eb91e4683: Close
[0m05:18:35.860843 [info ] [Thread-4 (]: 7 of 17 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.55s]
[0m05:18:35.862542 [info ] [Thread-3 (]: 5 of 17 PASS dbt_utils_unique_combination_of_columns_rsi_symbol__date .......... [[32mPASS[0m in 0.65s]
[0m05:18:35.863338 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:18:35.864111 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:18:35.864753 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:18:35.865287 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:18:35.865801 [info ] [Thread-4 (]: 9 of 17 START test not_null_rsi_rsi_14 ......................................... [RUN]
[0m05:18:35.866437 [info ] [Thread-3 (]: 10 of 17 START test not_null_rsi_symbol ........................................ [RUN]
[0m05:18:35.867234 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_moving_averages_symbol.153f328246, now test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899)
[0m05:18:35.867974 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830, now test.stock_analytics.not_null_rsi_symbol.21add3cf05)
[0m05:18:35.868440 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:18:35.868904 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:18:35.873606 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m05:18:35.878704 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m05:18:35.880478 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899 (compile): 05:18:35.869218 => 05:18:35.880316
[0m05:18:35.880831 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_rsi_symbol.21add3cf05 (compile): 05:18:35.873925 => 05:18:35.880656
[0m05:18:35.881118 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:18:35.881463 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:18:35.883478 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m05:18:35.885330 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m05:18:35.886645 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m05:18:35.887090 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m05:18:35.887355 [debug] [Thread-4 (]: On test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where rsi_14 is null



      
    ) dbt_internal_test
[0m05:18:35.887648 [debug] [Thread-3 (]: On test.stock_analytics.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where symbol is null



      
    ) dbt_internal_test
[0m05:18:35.887953 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:18:35.888246 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:18:35.924759 [info ] [Thread-2 (]: 6 of 17 PASS not_null_moving_averages_date ..................................... [[32mPASS[0m in 0.64s]
[0m05:18:35.925465 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:18:35.925817 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:18:35.926118 [info ] [Thread-2 (]: 11 of 17 START test not_null_stg_stock_data_close .............................. [RUN]
[0m05:18:35.926650 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_moving_averages_date.2eb91e4683, now test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db)
[0m05:18:35.926950 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:18:35.929900 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m05:18:35.931004 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db (compile): 05:18:35.927140 => 05:18:35.930841
[0m05:18:35.931307 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:18:35.933013 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m05:18:35.933898 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m05:18:35.934173 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where close is null



      
    ) dbt_internal_test
[0m05:18:35.934422 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:18:36.013734 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:18:36.015243 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_rsi_date.da56752005 (execute): 05:18:35.508440 => 05:18:36.015081
[0m05:18:36.015586 [debug] [Thread-1 (]: On test.stock_analytics.not_null_rsi_date.da56752005: Close
[0m05:18:36.123002 [info ] [Thread-1 (]: 8 of 17 PASS not_null_rsi_date ................................................. [[32mPASS[0m in 0.62s]
[0m05:18:36.124201 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:18:36.124764 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:18:36.125268 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_stock_data_date ............................... [RUN]
[0m05:18:36.126260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_date.da56752005, now test.stock_analytics.not_null_stg_stock_data_date.96adead1a7)
[0m05:18:36.126735 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:18:36.131376 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m05:18:36.132788 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_date.96adead1a7 (compile): 05:18:36.127056 => 05:18:36.132584
[0m05:18:36.133152 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:18:36.135479 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m05:18:36.136959 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m05:18:36.137253 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_data_date.96adead1a7: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where date is null



      
    ) dbt_internal_test
[0m05:18:36.137560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:36.281661 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:36.283939 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_rsi_symbol.21add3cf05 (execute): 05:18:35.883721 => 05:18:36.283702
[0m05:18:36.284411 [debug] [Thread-3 (]: On test.stock_analytics.not_null_rsi_symbol.21add3cf05: Close
[0m05:18:36.291302 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:36.293289 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899 (execute): 05:18:35.881707 => 05:18:36.293091
[0m05:18:36.293699 [debug] [Thread-4 (]: On test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899: Close
[0m05:18:36.378115 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:36.381800 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db (execute): 05:18:35.931507 => 05:18:36.381350
[0m05:18:36.382717 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db: Close
[0m05:18:36.390714 [info ] [Thread-4 (]: 9 of 17 PASS not_null_rsi_rsi_14 ............................................... [[32mPASS[0m in 0.52s]
[0m05:18:36.391930 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:18:36.392471 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:18:36.392990 [info ] [Thread-4 (]: 13 of 17 START test not_null_stg_stock_data_symbol ............................. [RUN]
[0m05:18:36.393881 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899, now test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e)
[0m05:18:36.394314 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:18:36.399153 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m05:18:36.400663 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e (compile): 05:18:36.394606 => 05:18:36.400476
[0m05:18:36.401046 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:18:36.403606 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m05:18:36.406065 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m05:18:36.405528 [info ] [Thread-3 (]: 10 of 17 PASS not_null_rsi_symbol .............................................. [[32mPASS[0m in 0.54s]
[0m05:18:36.406488 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where symbol is null



      
    ) dbt_internal_test
[0m05:18:36.407012 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:18:36.407406 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:18:36.407836 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:18:36.409166 [info ] [Thread-3 (]: 14 of 17 START test not_null_stock_analytics_mart_date ......................... [RUN]
[0m05:18:36.409776 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_symbol.21add3cf05, now test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b)
[0m05:18:36.410122 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:18:36.414873 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m05:18:36.415837 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b (compile): 05:18:36.410370 => 05:18:36.415698
[0m05:18:36.416082 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:18:36.454617 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m05:18:36.456409 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m05:18:36.456635 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
where date is null



      
    ) dbt_internal_test
[0m05:18:36.456853 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:18:36.515576 [info ] [Thread-2 (]: 11 of 17 PASS not_null_stg_stock_data_close .................................... [[32mPASS[0m in 0.59s]
[0m05:18:36.516124 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:18:36.516399 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:18:36.516648 [info ] [Thread-2 (]: 15 of 17 START test not_null_stock_analytics_mart_symbol ....................... [RUN]
[0m05:18:36.517137 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db, now test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0)
[0m05:18:36.517373 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:18:36.519770 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m05:18:36.521243 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0 (compile): 05:18:36.517527 => 05:18:36.521141
[0m05:18:36.521460 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:18:36.522842 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m05:18:36.523596 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m05:18:36.523830 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
where symbol is null



      
    ) dbt_internal_test
[0m05:18:36.524045 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:18:36.571898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:36.573123 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_date.96adead1a7 (execute): 05:18:36.133400 => 05:18:36.572996
[0m05:18:36.575453 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_data_date.96adead1a7: Close
[0m05:18:36.672123 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_stock_data_date ..................................... [[32mPASS[0m in 0.55s]
[0m05:18:36.672885 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:18:36.673258 [debug] [Thread-1 (]: Began running node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:18:36.673618 [info ] [Thread-1 (]: 16 of 17 START test source_not_null_raw_stock_data_lab_date .................... [RUN]
[0m05:18:36.675276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_date.96adead1a7, now test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740)
[0m05:18:36.676009 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:18:36.679479 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m05:18:36.680816 [debug] [Thread-1 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740 (compile): 05:18:36.676248 => 05:18:36.680650
[0m05:18:36.681118 [debug] [Thread-1 (]: Began executing node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:18:36.682943 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m05:18:36.684045 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m05:18:36.684316 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.RAW.stock_data_lab
where date is null



      
    ) dbt_internal_test
[0m05:18:36.684553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:36.885588 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:36.890011 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b (execute): 05:18:36.416235 => 05:18:36.889534
[0m05:18:36.890797 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b: Close
[0m05:18:36.951824 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:36.956413 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0 (execute): 05:18:36.521612 => 05:18:36.955819
[0m05:18:36.961846 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0: Close
[0m05:18:37.017458 [info ] [Thread-3 (]: 14 of 17 PASS not_null_stock_analytics_mart_date ............................... [[32mPASS[0m in 0.61s]
[0m05:18:37.019709 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:18:37.022117 [debug] [Thread-3 (]: Began running node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:18:37.026667 [info ] [Thread-3 (]: 17 of 17 START test source_not_null_raw_stock_data_lab_symbol .................. [RUN]
[0m05:18:37.028501 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b, now test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f)
[0m05:18:37.029180 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:18:37.035371 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m05:18:37.037245 [debug] [Thread-3 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f (compile): 05:18:37.029577 => 05:18:37.036968
[0m05:18:37.037772 [debug] [Thread-3 (]: Began executing node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:18:37.040962 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m05:18:37.043827 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m05:18:37.044356 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.RAW.stock_data_lab
where symbol is null



      
    ) dbt_internal_test
[0m05:18:37.044778 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:18:37.108530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:37.109784 [debug] [Thread-1 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740 (execute): 05:18:36.681322 => 05:18:37.109647
[0m05:18:37.110342 [info ] [Thread-2 (]: 15 of 17 PASS not_null_stock_analytics_mart_symbol ............................. [[32mPASS[0m in 0.59s]
[0m05:18:37.110610 [debug] [Thread-1 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740: Close
[0m05:18:37.110960 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:18:37.178229 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:18:37.179493 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e (execute): 05:18:36.401299 => 05:18:37.179354
[0m05:18:37.179749 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e: Close
[0m05:18:37.256124 [info ] [Thread-1 (]: 16 of 17 PASS source_not_null_raw_stock_data_lab_date .......................... [[32mPASS[0m in 0.58s]
[0m05:18:37.256778 [debug] [Thread-1 (]: Finished running node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:18:37.323856 [info ] [Thread-4 (]: 13 of 17 PASS not_null_stg_stock_data_symbol ................................... [[32mPASS[0m in 0.93s]
[0m05:18:37.324471 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:18:37.426022 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:18:37.427193 [debug] [Thread-3 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f (execute): 05:18:37.038066 => 05:18:37.427069
[0m05:18:37.427419 [debug] [Thread-3 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f: Close
[0m05:18:37.532641 [info ] [Thread-3 (]: 17 of 17 PASS source_not_null_raw_stock_data_lab_symbol ........................ [[32mPASS[0m in 0.50s]
[0m05:18:37.533372 [debug] [Thread-3 (]: Finished running node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:18:37.535043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:18:37.535301 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740' was properly closed.
[0m05:18:37.535509 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e' was properly closed.
[0m05:18:37.535767 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0' was properly closed.
[0m05:18:37.536124 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f' was properly closed.
[0m05:18:37.536413 [info ] [MainThread]: 
[0m05:18:37.536736 [info ] [MainThread]: Finished running 17 tests in 0 hours 0 minutes and 3.42 seconds (3.42s).
[0m05:18:37.537929 [debug] [MainThread]: Command end result
[0m05:18:37.546219 [info ] [MainThread]: 
[0m05:18:37.546536 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:18:37.546729 [info ] [MainThread]: 
[0m05:18:37.546978 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_rsi_rsi_14__rsi_14_0_AND_rsi_14_100 (models/schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 17 unexpected 'rsi_14'.
  compiled Code at target/run/stock_analytics/models/schema.yml/dbt_utils_expression_is_true_r_fa6fefa9a62eaa1f55545eee4cdf9011.sql
[0m05:18:37.547234 [info ] [MainThread]: 
[0m05:18:37.547461 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=1 SKIP=0 TOTAL=17
[0m05:18:37.547967 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.854794, "process_user_time": 2.864843, "process_kernel_time": 0.131531, "process_mem_max_rss": "220472", "process_out_blocks": "2576", "command_success": false, "process_in_blocks": "0"}
[0m05:18:37.548244 [debug] [MainThread]: Command `dbt test` failed at 05:18:37.548180 after 3.86 seconds
[0m05:18:37.548453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f39370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803a1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ef53fe0>]}
[0m05:18:37.548654 [debug] [MainThread]: Flushing usage events
[0m05:22:34.401204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e448770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f410fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa08bfd40>]}


============================== 05:22:34.408699 | 427b774a-d3b5-43f4-a91c-7786a5f5abec ==============================
[0m05:22:34.408699 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:22:34.409131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:22:34.458158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '427b774a-d3b5-43f4-a91c-7786a5f5abec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e490650>]}
[0m05:22:34.509135 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4t7hysl8'
[0m05:22:34.509401 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:22:34.609589 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:22:34.610111 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:22:34.668129 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:22:34.671361 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:22:35.117431 [info ] [MainThread]: Installed from version 1.1.1
[0m05:22:35.117881 [info ] [MainThread]: Updated version available: 1.3.2
[0m05:22:35.118182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '427b774a-d3b5-43f4-a91c-7786a5f5abec', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e2cd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1831d0>]}
[0m05:22:35.118437 [info ] [MainThread]: 
[0m05:22:35.118738 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m05:22:35.119376 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7397166, "process_user_time": 1.124478, "process_kernel_time": 0.076167, "process_mem_max_rss": "219484", "process_out_blocks": "2078", "process_in_blocks": "0"}
[0m05:22:35.119629 [debug] [MainThread]: Command `dbt deps` succeeded at 05:22:35.119571 after 0.74 seconds
[0m05:22:35.119829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e789130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e490650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8e6060>]}
[0m05:22:35.120052 [debug] [MainThread]: Flushing usage events
[0m05:22:38.436416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8957b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b49fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8908cd70>]}


============================== 05:22:38.439318 | 7f0aaf8e-eb69-4822-989b-1299d0a65c2a ==============================
[0m05:22:38.439318 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:22:38.439757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:22:38.792114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f0aaf8e-eb69-4822-989b-1299d0a65c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ddbb2c0>]}
[0m05:22:38.823316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f0aaf8e-eb69-4822-989b-1299d0a65c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e962c00>]}
[0m05:22:38.823728 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m05:22:38.828922 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:22:38.861861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:22:38.862303 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/schema.yml
[0m05:22:39.010405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f0aaf8e-eb69-4822-989b-1299d0a65c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63a4ba10>]}
[0m05:22:39.017592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f0aaf8e-eb69-4822-989b-1299d0a65c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6352d3a0>]}
[0m05:22:39.017918 [info ] [MainThread]: Found 4 models, 1 snapshot, 16 tests, 1 source, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m05:22:39.018296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f0aaf8e-eb69-4822-989b-1299d0a65c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63cde6f0>]}
[0m05:22:39.019272 [info ] [MainThread]: 
[0m05:22:39.019774 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:22:39.020449 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m05:22:39.025713 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m05:22:39.026059 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m05:22:39.026293 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m05:22:39.026621 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m05:22:39.027563 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m05:22:39.027761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:39.028738 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m05:22:39.028933 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m05:22:39.029644 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m05:22:39.030233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:39.030582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:39.400208 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m05:22:39.401699 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m05:22:39.481172 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m05:22:39.484314 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m05:22:39.485522 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m05:22:39.488622 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m05:22:39.617396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_snapshots)
[0m05:22:39.626640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_ANALYTICS_staging)
[0m05:22:39.632633 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_snapshots"
[0m05:22:39.635305 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_staging"
[0m05:22:39.636217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now list_USER_DB_JACKAL_ANALYTICS_intermediate)
[0m05:22:39.636813 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_snapshots"} */
show terse objects in USER_DB_JACKAL.snapshots limit 10000
[0m05:22:39.637579 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_marts'
[0m05:22:39.637959 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_staging"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_staging limit 10000
[0m05:22:39.688595 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m05:22:39.688824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:22:39.689990 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_marts"
[0m05:22:39.690225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:22:39.690443 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_intermediate"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_intermediate limit 10000
[0m05:22:39.691288 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_marts"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_marts limit 10000
[0m05:22:39.692574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:22:39.692809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:40.065715 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:40.069917 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m05:22:40.071471 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:22:40.076134 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m05:22:40.082048 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c09942-0307-1cc8-000f-c0df008ff8be
[0m05:22:40.083153 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m05:22:40.084197 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:40.084850 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m05:22:40.086166 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m05:22:40.086399 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:22:40.087202 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: Close
[0m05:22:40.223299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f0aaf8e-eb69-4822-989b-1299d0a65c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63173740>]}
[0m05:22:40.224973 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:22:40.226794 [info ] [MainThread]: 
[0m05:22:40.237288 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_data
[0m05:22:40.237935 [info ] [Thread-1 (]: 1 of 4 START sql view model ANALYTICS_staging.stg_stock_data ................... [RUN]
[0m05:22:40.238914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_snapshots, now model.stock_analytics.stg_stock_data)
[0m05:22:40.239292 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_data
[0m05:22:40.244971 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_data"
[0m05:22:40.246944 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stg_stock_data (compile): 05:22:40.239542 => 05:22:40.246727
[0m05:22:40.247258 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_data
[0m05:22:40.263297 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_stock_data"
[0m05:22:40.264821 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_stock_data"
[0m05:22:40.265118 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_data: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_stock_data"} */
create or replace   view USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
  
   as (
    

WITH source_data AS (
    SELECT
        symbol,
        date,
        open,
        high,
        low,
        close,
        volume
    FROM USER_DB_JACKAL.RAW.stock_data_lab
    WHERE date IS NOT NULL
        AND symbol IS NOT NULL
)

SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume,
    -- Add data quality flags
    CASE 
        WHEN open IS NULL OR high IS NULL OR low IS NULL OR close IS NULL 
        THEN TRUE 
        ELSE FALSE 
    END AS has_null_prices,
    -- Validate price relationships
    CASE 
        WHEN high < low 
            OR high < open 
            OR high < close 
            OR low > open 
            OR low > close 
        THEN TRUE 
        ELSE FALSE 
    END AS has_invalid_prices
FROM source_data
  );
[0m05:22:40.265386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:22:40.887529 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:22:40.913022 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stg_stock_data (execute): 05:22:40.247441 => 05:22:40.912800
[0m05:22:40.913565 [debug] [Thread-1 (]: On model.stock_analytics.stg_stock_data: Close
[0m05:22:41.042201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f0aaf8e-eb69-4822-989b-1299d0a65c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff635a4ad0>]}
[0m05:22:41.043937 [info ] [Thread-1 (]: 1 of 4 OK created sql view model ANALYTICS_staging.stg_stock_data .............. [[32mSUCCESS 1[0m in 0.80s]
[0m05:22:41.045788 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_data
[0m05:22:41.047547 [debug] [Thread-3 (]: Began running node model.stock_analytics.moving_averages
[0m05:22:41.048160 [debug] [Thread-4 (]: Began running node model.stock_analytics.rsi
[0m05:22:41.048808 [info ] [Thread-3 (]: 2 of 4 START sql table model ANALYTICS_intermediate.moving_averages ............ [RUN]
[0m05:22:41.049693 [info ] [Thread-4 (]: 3 of 4 START sql table model ANALYTICS_intermediate.rsi ........................ [RUN]
[0m05:22:41.050807 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_staging, now model.stock_analytics.moving_averages)
[0m05:22:41.051731 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_marts, now model.stock_analytics.rsi)
[0m05:22:41.052380 [debug] [Thread-3 (]: Began compiling node model.stock_analytics.moving_averages
[0m05:22:41.052943 [debug] [Thread-4 (]: Began compiling node model.stock_analytics.rsi
[0m05:22:41.058123 [debug] [Thread-3 (]: Writing injected SQL for node "model.stock_analytics.moving_averages"
[0m05:22:41.061274 [debug] [Thread-4 (]: Writing injected SQL for node "model.stock_analytics.rsi"
[0m05:22:41.063602 [debug] [Thread-3 (]: Timing info for model.stock_analytics.moving_averages (compile): 05:22:41.053489 => 05:22:41.063414
[0m05:22:41.064050 [debug] [Thread-4 (]: Timing info for model.stock_analytics.rsi (compile): 05:22:41.058470 => 05:22:41.063816
[0m05:22:41.064404 [debug] [Thread-3 (]: Began executing node model.stock_analytics.moving_averages
[0m05:22:41.064820 [debug] [Thread-4 (]: Began executing node model.stock_analytics.rsi
[0m05:22:41.085610 [debug] [Thread-4 (]: Writing runtime sql for node "model.stock_analytics.rsi"
[0m05:22:41.087295 [debug] [Thread-3 (]: Writing runtime sql for node "model.stock_analytics.moving_averages"
[0m05:22:41.089490 [debug] [Thread-4 (]: Using snowflake connection "model.stock_analytics.rsi"
[0m05:22:41.090459 [debug] [Thread-3 (]: Using snowflake connection "model.stock_analytics.moving_averages"
[0m05:22:41.090738 [debug] [Thread-4 (]: On model.stock_analytics.rsi: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.rsi"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_intermediate.rsi
         as
        (

WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    WHERE has_null_prices = FALSE
        AND has_invalid_prices = FALSE
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        close - LAG(close, 1) OVER (PARTITION BY symbol ORDER BY date) AS price_change
    FROM stock_data
),

gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
    WHERE price_change IS NOT NULL
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        gain,
        loss,
        -- 14-period average gain
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain_14,
        -- 14-period average loss
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss_14,
        -- Count periods for validation
        COUNT(*) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS period_count
    FROM gains_losses
),

rsi_calculation AS (
    SELECT
        symbol,
        date,
        close,
        price_change,
        avg_gain_14,
        avg_loss_14,
        period_count,
        -- Calculate RS (Relative Strength)
        CASE 
            WHEN avg_loss_14 = 0 THEN NULL
            ELSE avg_gain_14 / NULLIF(avg_loss_14, 0)
        END AS rs,
        -- Calculate RSI
        CASE 
            WHEN avg_loss_14 = 0 THEN 100
            WHEN avg_gain_14 = 0 THEN 0
            ELSE 100 - (100 / (1 + (avg_gain_14 / NULLIF(avg_loss_14, 0))))
        END AS rsi_14
    FROM average_gains_losses
    WHERE period_count >= 14  -- Ensure we have enough periods
)

SELECT
    symbol,
    date,
    close,
    ROUND(price_change, 2) AS price_change,
    ROUND(rsi_14, 2) AS rsi_14,
    -- RSI interpretation signals
    CASE 
        WHEN rsi_14 >= 70 THEN 'OVERBOUGHT'
        WHEN rsi_14 <= 30 THEN 'OVERSOLD'
        WHEN rsi_14 > 50 THEN 'BULLISH'
        WHEN rsi_14 < 50 THEN 'BEARISH'
        ELSE 'NEUTRAL'
    END AS rsi_signal,
    -- RSI momentum
    CASE 
        WHEN rsi_14 > LAG(rsi_14, 1) OVER (PARTITION BY symbol ORDER BY date) 
        THEN 'INCREASING'
        WHEN rsi_14 < LAG(rsi_14, 1) OVER (PARTITION BY symbol ORDER BY date) 
        THEN 'DECREASING'
        ELSE 'FLAT'
    END AS rsi_momentum
FROM rsi_calculation
ORDER BY symbol, date
        );
[0m05:22:41.091064 [debug] [Thread-3 (]: On model.stock_analytics.moving_averages: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.moving_averages"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
         as
        (

WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    WHERE has_null_prices = FALSE
        AND has_invalid_prices = FALSE
),

moving_averages AS (
    SELECT
        symbol,
        date,
        close,
        -- 7-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS sma_7,
        -- 14-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS sma_14,
        -- 30-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
        ) AS sma_30,
        -- 50-day Simple Moving Average
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS sma_50,
        -- Count of days for MA calculation validation
        COUNT(*) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS days_count
    FROM stock_data
)

SELECT
    symbol,
    date,
    close,
    ROUND(sma_7, 2) AS sma_7,
    ROUND(sma_14, 2) AS sma_14,
    ROUND(sma_30, 2) AS sma_30,
    ROUND(sma_50, 2) AS sma_50,
    -- Calculate crossover signals
    CASE 
        WHEN sma_7 > sma_14 THEN 'BULLISH_SHORT'
        WHEN sma_7 < sma_14 THEN 'BEARISH_SHORT'
        ELSE 'NEUTRAL'
    END AS signal_7_14,
    CASE 
        WHEN sma_14 > sma_30 THEN 'BULLISH_MED'
        WHEN sma_14 < sma_30 THEN 'BEARISH_MED'
        ELSE 'NEUTRAL'
    END AS signal_14_30,
    -- Price vs MA comparison
    ROUND(((close - sma_50) / NULLIF(sma_50, 0)) * 100, 2) AS pct_from_sma_50
FROM moving_averages
WHERE days_count >= 7  -- Ensure we have enough data for at least the shortest MA
        );
[0m05:22:41.091366 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:22:41.091597 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:22:42.193913 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:22:42.199175 [debug] [Thread-3 (]: Timing info for model.stock_analytics.moving_averages (execute): 05:22:41.065102 => 05:22:42.198788
[0m05:22:42.200136 [debug] [Thread-3 (]: On model.stock_analytics.moving_averages: Close
[0m05:22:42.281374 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:22:42.284701 [debug] [Thread-4 (]: Timing info for model.stock_analytics.rsi (execute): 05:22:41.078844 => 05:22:42.284492
[0m05:22:42.286031 [debug] [Thread-4 (]: On model.stock_analytics.rsi: Close
[0m05:22:42.369081 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f0aaf8e-eb69-4822-989b-1299d0a65c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63a6c170>]}
[0m05:22:42.370395 [info ] [Thread-3 (]: 2 of 4 OK created sql table model ANALYTICS_intermediate.moving_averages ....... [[32mSUCCESS 1[0m in 1.32s]
[0m05:22:42.371982 [debug] [Thread-3 (]: Finished running node model.stock_analytics.moving_averages
[0m05:22:42.414754 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f0aaf8e-eb69-4822-989b-1299d0a65c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63c7a960>]}
[0m05:22:42.416228 [info ] [Thread-4 (]: 3 of 4 OK created sql table model ANALYTICS_intermediate.rsi ................... [[32mSUCCESS 1[0m in 1.36s]
[0m05:22:42.417874 [debug] [Thread-4 (]: Finished running node model.stock_analytics.rsi
[0m05:22:42.419209 [debug] [Thread-1 (]: Began running node model.stock_analytics.stock_analytics_mart
[0m05:22:42.419813 [info ] [Thread-1 (]: 4 of 4 START sql table model ANALYTICS_marts.stock_analytics_mart .............. [RUN]
[0m05:22:42.421064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_data, now model.stock_analytics.stock_analytics_mart)
[0m05:22:42.421879 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stock_analytics_mart
[0m05:22:42.426319 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stock_analytics_mart"
[0m05:22:42.428835 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stock_analytics_mart (compile): 05:22:42.422276 => 05:22:42.428599
[0m05:22:42.429252 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stock_analytics_mart
[0m05:22:42.431866 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stock_analytics_mart"
[0m05:22:42.434542 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stock_analytics_mart"
[0m05:22:42.435007 [debug] [Thread-1 (]: On model.stock_analytics.stock_analytics_mart: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stock_analytics_mart"} */
create or replace transient table USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
         as
        (

WITH moving_averages AS (
    SELECT * FROM USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
),

rsi AS (
    SELECT * FROM USER_DB_JACKAL.ANALYTICS_intermediate.rsi
),

combined_analytics AS (
    SELECT
        ma.symbol,
        ma.date,
        ma.close,
        -- Moving Averages
        ma.sma_7,
        ma.sma_14,
        ma.sma_30,
        ma.sma_50,
        ma.signal_7_14,
        ma.signal_14_30,
        ma.pct_from_sma_50,
        -- RSI Indicators
        rsi.rsi_14,
        rsi.rsi_signal,
        rsi.rsi_momentum,
        rsi.price_change,
        -- Combined trading signal
        CASE
            WHEN rsi.rsi_14 <= 30 AND ma.signal_7_14 = 'BULLISH_SHORT' THEN 'STRONG_BUY'
            WHEN rsi.rsi_14 >= 70 AND ma.signal_7_14 = 'BEARISH_SHORT' THEN 'STRONG_SELL'
            WHEN rsi.rsi_14 < 40 AND ma.signal_14_30 = 'BULLISH_MED' THEN 'BUY'
            WHEN rsi.rsi_14 > 60 AND ma.signal_14_30 = 'BEARISH_MED' THEN 'SELL'
            WHEN rsi.rsi_14 BETWEEN 40 AND 60 THEN 'HOLD'
            ELSE 'NEUTRAL'
        END AS combined_signal,
        -- Volatility indicator (price % change)
        ROUND((rsi.price_change / NULLIF(ma.close - rsi.price_change, 0)) * 100, 2) AS daily_return_pct,
        -- Trend strength
        CASE
            WHEN ma.close > ma.sma_7 
                AND ma.sma_7 > ma.sma_14 
                AND ma.sma_14 > ma.sma_30 
            THEN 'STRONG_UPTREND'
            WHEN ma.close < ma.sma_7 
                AND ma.sma_7 < ma.sma_14 
                AND ma.sma_14 < ma.sma_30 
            THEN 'STRONG_DOWNTREND'
            WHEN ma.close > ma.sma_30 THEN 'UPTREND'
            WHEN ma.close < ma.sma_30 THEN 'DOWNTREND'
            ELSE 'SIDEWAYS'
        END AS trend_strength
    FROM moving_averages ma
    INNER JOIN rsi 
        ON ma.symbol = rsi.symbol 
        AND ma.date = rsi.date
)

SELECT
    symbol,
    date,
    close,
    sma_7,
    sma_14,
    sma_30,
    sma_50,
    rsi_14,
    signal_7_14,
    signal_14_30,
    rsi_signal,
    rsi_momentum,
    combined_signal,
    trend_strength,
    pct_from_sma_50,
    daily_return_pct,
    price_change
FROM combined_analytics
ORDER BY symbol, date DESC
        );
[0m05:22:42.435428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:22:43.584882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:22:43.589230 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stock_analytics_mart (execute): 05:22:42.429534 => 05:22:43.588933
[0m05:22:43.589979 [debug] [Thread-1 (]: On model.stock_analytics.stock_analytics_mart: Close
[0m05:22:43.708266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f0aaf8e-eb69-4822-989b-1299d0a65c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63c7ac30>]}
[0m05:22:43.709736 [info ] [Thread-1 (]: 4 of 4 OK created sql table model ANALYTICS_marts.stock_analytics_mart ......... [[32mSUCCESS 1[0m in 1.29s]
[0m05:22:43.711343 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stock_analytics_mart
[0m05:22:43.714186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:22:43.714747 [debug] [MainThread]: Connection 'model.stock_analytics.moving_averages' was properly closed.
[0m05:22:43.715171 [debug] [MainThread]: Connection 'model.stock_analytics.stock_analytics_mart' was properly closed.
[0m05:22:43.715606 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL_ANALYTICS_intermediate' was properly closed.
[0m05:22:43.715988 [debug] [MainThread]: Connection 'model.stock_analytics.rsi' was properly closed.
[0m05:22:43.716520 [info ] [MainThread]: 
[0m05:22:43.717321 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 4.70 seconds (4.70s).
[0m05:22:43.718503 [debug] [MainThread]: Command end result
[0m05:22:43.734090 [info ] [MainThread]: 
[0m05:22:43.735008 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:22:43.735403 [info ] [MainThread]: 
[0m05:22:43.735869 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:22:43.736859 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.319779, "process_user_time": 2.789438, "process_kernel_time": 0.123328, "process_mem_max_rss": "225552", "process_out_blocks": "3686", "process_in_blocks": "0"}
[0m05:22:43.737380 [debug] [MainThread]: Command `dbt run` succeeded at 05:22:43.737273 after 5.32 seconds
[0m05:22:43.737750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8957b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89509880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff639df7a0>]}
[0m05:22:43.738086 [debug] [MainThread]: Flushing usage events
[0m05:22:46.427994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c90260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c90ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6109940>]}


============================== 05:22:46.433415 | 70b8ac32-43d5-4f9f-a120-69776ba00ac8 ==============================
[0m05:22:46.433415 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:22:46.434145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:22:46.789681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70b8ac32-43d5-4f9f-a120-69776ba00ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8580fd10>]}
[0m05:22:46.819106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70b8ac32-43d5-4f9f-a120-69776ba00ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6fa6630>]}
[0m05:22:46.819447 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m05:22:46.824342 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:22:46.850298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:22:46.850513 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:22:46.852890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70b8ac32-43d5-4f9f-a120-69776ba00ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b0b770>]}
[0m05:22:46.859360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70b8ac32-43d5-4f9f-a120-69776ba00ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff848d2900>]}
[0m05:22:46.859678 [info ] [MainThread]: Found 4 models, 1 snapshot, 16 tests, 1 source, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m05:22:46.860053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70b8ac32-43d5-4f9f-a120-69776ba00ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5632f0>]}
[0m05:22:46.861156 [info ] [MainThread]: 
[0m05:22:46.861668 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:22:46.862325 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_staging'
[0m05:22:46.868148 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_intermediate'
[0m05:22:46.868484 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_staging"
[0m05:22:46.869533 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m05:22:46.869866 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_snapshots'
[0m05:22:46.870092 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_staging"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_staging limit 10000
[0m05:22:46.870378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_marts'
[0m05:22:46.870576 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_intermediate"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_intermediate limit 10000
[0m05:22:46.871544 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_snapshots"
[0m05:22:46.871737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:46.872632 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_marts"
[0m05:22:46.872853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:46.873036 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_snapshots"} */
show terse objects in USER_DB_JACKAL.snapshots limit 10000
[0m05:22:46.874103 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_marts"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_marts limit 10000
[0m05:22:46.875366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:46.875755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:47.253197 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c09942-0307-1dc6-000f-c0df008fcd56
[0m05:22:47.253768 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m05:22:47.254287 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m05:22:47.254680 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:22:47.255132 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: Close
[0m05:22:47.280318 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:47.282027 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m05:22:47.318873 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:22:47.320701 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m05:22:47.352237 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:47.353256 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m05:22:47.489546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70b8ac32-43d5-4f9f-a120-69776ba00ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff848d2990>]}
[0m05:22:47.491222 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:22:47.492160 [info ] [MainThread]: 
[0m05:22:47.501406 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:22:47.502468 [debug] [Thread-2 (]: Began running node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:22:47.502872 [debug] [Thread-3 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:22:47.503253 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_stg_stock_data_symbol__AAPL__GOOG ........... [RUN]
[0m05:22:47.503674 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:22:47.504078 [info ] [Thread-2 (]: 2 of 16 START test accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL  [RUN]
[0m05:22:47.504557 [info ] [Thread-3 (]: 3 of 16 START test dbt_utils_unique_combination_of_columns_moving_averages_symbol__date  [RUN]
[0m05:22:47.505264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_intermediate, now test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976)
[0m05:22:47.505827 [info ] [Thread-4 (]: 4 of 16 START test dbt_utils_unique_combination_of_columns_rsi_symbol__date .... [RUN]
[0m05:22:47.506437 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_marts, now test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999)
[0m05:22:47.507012 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_staging, now test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81)
[0m05:22:47.507377 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:22:47.507943 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_snapshots, now test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830)
[0m05:22:47.508308 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:22:47.508652 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:22:47.519066 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m05:22:47.519324 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:22:47.523207 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m05:22:47.529131 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81"
[0m05:22:47.531315 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830"
[0m05:22:47.533372 [debug] [Thread-1 (]: Timing info for test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976 (compile): 05:22:47.508918 => 05:22:47.533245
[0m05:22:47.533642 [debug] [Thread-2 (]: Timing info for test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999 (compile): 05:22:47.519537 => 05:22:47.533516
[0m05:22:47.533885 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:22:47.534129 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81 (compile): 05:22:47.523425 => 05:22:47.534012
[0m05:22:47.534435 [debug] [Thread-2 (]: Began executing node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:22:47.534666 [debug] [Thread-4 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830 (compile): 05:22:47.529454 => 05:22:47.534563
[0m05:22:47.543972 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m05:22:47.544186 [debug] [Thread-3 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:22:47.545480 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m05:22:47.545739 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:22:47.547141 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81"
[0m05:22:47.548821 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830"
[0m05:22:47.549369 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m05:22:47.549983 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        symbol as value_field,
        count(*) as n_records

    from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
    group by symbol

)

select *
from all_values
where value_field not in (
    'AAPL','GOOG'
)



      
    ) dbt_internal_test
[0m05:22:47.550355 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m05:22:47.550564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:22:47.550832 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        combined_signal as value_field,
        count(*) as n_records

    from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
    group by combined_signal

)

select *
from all_values
where value_field not in (
    'STRONG_BUY','BUY','HOLD','SELL','STRONG_SELL','NEUTRAL'
)



      
    ) dbt_internal_test
[0m05:22:47.551174 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81"
[0m05:22:47.551549 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830"
[0m05:22:47.552316 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:22:47.552632 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        symbol, date
    from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
    group by symbol, date
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m05:22:47.552996 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        symbol, date
    from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
    group by symbol, date
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m05:22:47.553833 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:22:47.554146 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:22:48.036971 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:48.052200 [debug] [Thread-4 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830 (execute): 05:22:47.547707 => 05:22:48.051290
[0m05:22:48.053569 [debug] [Thread-4 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830: Close
[0m05:22:48.056333 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:22:48.059755 [debug] [Thread-3 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81 (execute): 05:22:47.545989 => 05:22:48.059454
[0m05:22:48.060462 [debug] [Thread-3 (]: On test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81: Close
[0m05:22:48.106140 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:22:48.109533 [debug] [Thread-2 (]: Timing info for test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999 (execute): 05:22:47.544355 => 05:22:48.109295
[0m05:22:48.110047 [debug] [Thread-2 (]: On test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999: Close
[0m05:22:48.129774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:22:48.131840 [debug] [Thread-1 (]: Timing info for test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976 (execute): 05:22:47.534850 => 05:22:48.131612
[0m05:22:48.132280 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976: Close
[0m05:22:48.168781 [info ] [Thread-3 (]: 3 of 16 PASS dbt_utils_unique_combination_of_columns_moving_averages_symbol__date  [[32mPASS[0m in 0.66s]
[0m05:22:48.170119 [debug] [Thread-3 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:22:48.170700 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:22:48.171234 [info ] [Thread-3 (]: 5 of 16 START test not_null_moving_averages_date ............................... [RUN]
[0m05:22:48.172196 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81, now test.stock_analytics.not_null_moving_averages_date.2eb91e4683)
[0m05:22:48.172630 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:22:48.179963 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m05:22:48.182149 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_moving_averages_date.2eb91e4683 (compile): 05:22:48.172937 => 05:22:48.181952
[0m05:22:48.182495 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:22:48.185031 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m05:22:48.187280 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m05:22:48.187655 [debug] [Thread-3 (]: On test.stock_analytics.not_null_moving_averages_date.2eb91e4683: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
where date is null



      
    ) dbt_internal_test
[0m05:22:48.187999 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:22:48.202015 [info ] [Thread-4 (]: 4 of 16 PASS dbt_utils_unique_combination_of_columns_rsi_symbol__date .......... [[32mPASS[0m in 0.69s]
[0m05:22:48.202768 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:22:48.203068 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:22:48.203335 [info ] [Thread-4 (]: 6 of 16 START test not_null_moving_averages_symbol ............................. [RUN]
[0m05:22:48.203865 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830, now test.stock_analytics.not_null_moving_averages_symbol.153f328246)
[0m05:22:48.204127 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:22:48.207034 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m05:22:48.208011 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_moving_averages_symbol.153f328246 (compile): 05:22:48.204273 => 05:22:48.207857
[0m05:22:48.208285 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:22:48.209906 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m05:22:48.210763 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m05:22:48.211008 [debug] [Thread-4 (]: On test.stock_analytics.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_intermediate.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m05:22:48.211245 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:22:48.250050 [info ] [Thread-1 (]: 1 of 16 PASS accepted_values_stg_stock_data_symbol__AAPL__GOOG ................. [[32mPASS[0m in 0.74s]
[0m05:22:48.250917 [info ] [Thread-2 (]: 2 of 16 PASS accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL  [[32mPASS[0m in 0.74s]
[0m05:22:48.251313 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:22:48.251832 [debug] [Thread-2 (]: Finished running node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:22:48.252165 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:22:48.252479 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:22:48.252809 [info ] [Thread-1 (]: 7 of 16 START test not_null_rsi_date ........................................... [RUN]
[0m05:22:48.253171 [info ] [Thread-2 (]: 8 of 16 START test not_null_rsi_rsi_14 ......................................... [RUN]
[0m05:22:48.253617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976, now test.stock_analytics.not_null_rsi_date.da56752005)
[0m05:22:48.254040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999, now test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899)
[0m05:22:48.254308 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:22:48.254560 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:22:48.257080 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_date.da56752005"
[0m05:22:48.259344 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m05:22:48.260570 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_rsi_date.da56752005 (compile): 05:22:48.254743 => 05:22:48.260459
[0m05:22:48.260820 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899 (compile): 05:22:48.257292 => 05:22:48.260695
[0m05:22:48.261032 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:22:48.261300 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:22:48.262704 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_date.da56752005"
[0m05:22:48.264127 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m05:22:48.265070 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_date.da56752005"
[0m05:22:48.265380 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m05:22:48.265574 [debug] [Thread-1 (]: On test.stock_analytics.not_null_rsi_date.da56752005: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_date.da56752005"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where date is null



      
    ) dbt_internal_test
[0m05:22:48.265791 [debug] [Thread-2 (]: On test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where rsi_14 is null



      
    ) dbt_internal_test
[0m05:22:48.266009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:22:48.266205 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:22:48.554118 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:48.557800 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_moving_averages_date.2eb91e4683 (execute): 05:22:48.182985 => 05:22:48.557376
[0m05:22:48.558487 [debug] [Thread-3 (]: On test.stock_analytics.not_null_moving_averages_date.2eb91e4683: Close
[0m05:22:48.623027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:48.627423 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_rsi_date.da56752005 (execute): 05:22:48.261460 => 05:22:48.626696
[0m05:22:48.628762 [debug] [Thread-1 (]: On test.stock_analytics.not_null_rsi_date.da56752005: Close
[0m05:22:48.629831 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:48.634061 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_moving_averages_symbol.153f328246 (execute): 05:22:48.208465 => 05:22:48.633631
[0m05:22:48.635181 [debug] [Thread-4 (]: On test.stock_analytics.not_null_moving_averages_symbol.153f328246: Close
[0m05:22:48.672476 [info ] [Thread-3 (]: 5 of 16 PASS not_null_moving_averages_date ..................................... [[32mPASS[0m in 0.50s]
[0m05:22:48.673247 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:22:48.673823 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:22:48.674289 [info ] [Thread-3 (]: 9 of 16 START test not_null_rsi_symbol ......................................... [RUN]
[0m05:22:48.675148 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_moving_averages_date.2eb91e4683, now test.stock_analytics.not_null_rsi_symbol.21add3cf05)
[0m05:22:48.675587 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:22:48.680439 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m05:22:48.683889 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:48.685753 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899 (execute): 05:22:48.262886 => 05:22:48.685562
[0m05:22:48.686122 [debug] [Thread-2 (]: On test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899: Close
[0m05:22:48.687380 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_rsi_symbol.21add3cf05 (compile): 05:22:48.675895 => 05:22:48.687174
[0m05:22:48.688142 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:22:48.690490 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m05:22:48.691588 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m05:22:48.691916 [debug] [Thread-3 (]: On test.stock_analytics.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_intermediate.rsi
where symbol is null



      
    ) dbt_internal_test
[0m05:22:48.692212 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:22:48.762313 [info ] [Thread-4 (]: 6 of 16 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.56s]
[0m05:22:48.763119 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:22:48.763555 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:22:48.763949 [info ] [Thread-4 (]: 10 of 16 START test not_null_stg_stock_data_close .............................. [RUN]
[0m05:22:48.764786 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_moving_averages_symbol.153f328246, now test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db)
[0m05:22:48.765221 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:22:48.768773 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m05:22:48.769893 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db (compile): 05:22:48.765487 => 05:22:48.769730
[0m05:22:48.770212 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:22:48.773739 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m05:22:48.775367 [info ] [Thread-1 (]: 7 of 16 PASS not_null_rsi_date ................................................. [[32mPASS[0m in 0.52s]
[0m05:22:48.775978 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:22:48.776362 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:22:48.776774 [info ] [Thread-1 (]: 11 of 16 START test not_null_stg_stock_data_date ............................... [RUN]
[0m05:22:48.777259 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m05:22:48.777735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_date.da56752005, now test.stock_analytics.not_null_stg_stock_data_date.96adead1a7)
[0m05:22:48.778045 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where close is null



      
    ) dbt_internal_test
[0m05:22:48.778357 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:22:48.778661 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:22:48.781405 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m05:22:48.783488 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_date.96adead1a7 (compile): 05:22:48.778870 => 05:22:48.783319
[0m05:22:48.783846 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:22:48.785847 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m05:22:48.787477 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m05:22:48.787776 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_data_date.96adead1a7: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where date is null



      
    ) dbt_internal_test
[0m05:22:48.788024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:22:48.823982 [info ] [Thread-2 (]: 8 of 16 PASS not_null_rsi_rsi_14 ............................................... [[32mPASS[0m in 0.57s]
[0m05:22:48.824553 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:22:48.824863 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:22:48.825132 [info ] [Thread-2 (]: 12 of 16 START test not_null_stg_stock_data_symbol ............................. [RUN]
[0m05:22:48.825639 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899, now test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e)
[0m05:22:48.825917 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:22:48.828457 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m05:22:48.829386 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e (compile): 05:22:48.826091 => 05:22:48.829267
[0m05:22:48.829630 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:22:48.831154 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m05:22:48.832034 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m05:22:48.832265 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_staging.stg_stock_data
where symbol is null



      
    ) dbt_internal_test
[0m05:22:48.832490 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:22:49.088901 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:49.090442 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_rsi_symbol.21add3cf05 (execute): 05:22:48.688409 => 05:22:49.090266
[0m05:22:49.090862 [debug] [Thread-3 (]: On test.stock_analytics.not_null_rsi_symbol.21add3cf05: Close
[0m05:22:49.146739 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:49.148679 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_date.96adead1a7 (execute): 05:22:48.784087 => 05:22:49.148443
[0m05:22:49.149131 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_stock_data_date.96adead1a7: Close
[0m05:22:49.213055 [info ] [Thread-3 (]: 9 of 16 PASS not_null_rsi_symbol ............................................... [[32mPASS[0m in 0.54s]
[0m05:22:49.214209 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:22:49.214731 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:22:49.215182 [info ] [Thread-3 (]: 13 of 16 START test not_null_stock_analytics_mart_date ......................... [RUN]
[0m05:22:49.216062 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_symbol.21add3cf05, now test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b)
[0m05:22:49.216483 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:22:49.220966 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m05:22:49.222951 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b (compile): 05:22:49.216780 => 05:22:49.222755
[0m05:22:49.223339 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:22:49.225643 [debug] [Thread-3 (]: Writing runtime sql for node "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m05:22:49.227251 [debug] [Thread-3 (]: Using snowflake connection "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m05:22:49.227602 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
where date is null



      
    ) dbt_internal_test
[0m05:22:49.227951 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:22:49.280397 [info ] [Thread-1 (]: 11 of 16 PASS not_null_stg_stock_data_date ..................................... [[32mPASS[0m in 0.50s]
[0m05:22:49.281782 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:22:49.282328 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:22:49.282812 [info ] [Thread-1 (]: 14 of 16 START test not_null_stock_analytics_mart_symbol ....................... [RUN]
[0m05:22:49.283576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_date.96adead1a7, now test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0)
[0m05:22:49.283976 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:22:49.288097 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m05:22:49.289382 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0 (compile): 05:22:49.284233 => 05:22:49.289208
[0m05:22:49.289728 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:22:49.291949 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m05:22:49.292881 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m05:22:49.293152 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.ANALYTICS_marts.stock_analytics_mart
where symbol is null



      
    ) dbt_internal_test
[0m05:22:49.293407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:22:49.319566 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:49.321432 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e (execute): 05:22:48.829815 => 05:22:49.321259
[0m05:22:49.321774 [debug] [Thread-2 (]: On test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e: Close
[0m05:22:49.360534 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:22:49.362001 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db (execute): 05:22:48.770425 => 05:22:49.361832
[0m05:22:49.362331 [debug] [Thread-4 (]: On test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db: Close
[0m05:22:49.425127 [info ] [Thread-2 (]: 12 of 16 PASS not_null_stg_stock_data_symbol ................................... [[32mPASS[0m in 0.60s]
[0m05:22:49.425907 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:22:49.426315 [debug] [Thread-2 (]: Began running node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:22:49.426657 [info ] [Thread-2 (]: 15 of 16 START test source_not_null_raw_stock_data_lab_date .................... [RUN]
[0m05:22:49.427362 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e, now test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740)
[0m05:22:49.427686 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:22:49.475927 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m05:22:49.477102 [info ] [Thread-4 (]: 10 of 16 PASS not_null_stg_stock_data_close .................................... [[32mPASS[0m in 0.71s]
[0m05:22:49.477622 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:22:49.477932 [debug] [Thread-4 (]: Began running node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:22:49.478148 [debug] [Thread-2 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740 (compile): 05:22:49.427919 => 05:22:49.478052
[0m05:22:49.478378 [info ] [Thread-4 (]: 16 of 16 START test source_not_null_raw_stock_data_lab_symbol .................. [RUN]
[0m05:22:49.478672 [debug] [Thread-2 (]: Began executing node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:22:49.479031 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db, now test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f)
[0m05:22:49.480390 [debug] [Thread-2 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m05:22:49.480634 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:22:49.482796 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m05:22:49.483499 [debug] [Thread-2 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m05:22:49.483699 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from USER_DB_JACKAL.RAW.stock_data_lab
where date is null



      
    ) dbt_internal_test
[0m05:22:49.483915 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:22:49.484110 [debug] [Thread-4 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f (compile): 05:22:49.480943 => 05:22:49.484011
[0m05:22:49.484980 [debug] [Thread-4 (]: Began executing node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:22:49.486302 [debug] [Thread-4 (]: Writing runtime sql for node "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m05:22:49.486913 [debug] [Thread-4 (]: Using snowflake connection "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m05:22:49.487117 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_JACKAL.RAW.stock_data_lab
where symbol is null



      
    ) dbt_internal_test
[0m05:22:49.487347 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:22:49.699136 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:49.702534 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b (execute): 05:22:49.223598 => 05:22:49.702233
[0m05:22:49.703162 [debug] [Thread-3 (]: On test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b: Close
[0m05:22:49.792624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:49.795411 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0 (execute): 05:22:49.290013 => 05:22:49.795132
[0m05:22:49.795953 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0: Close
[0m05:22:49.852660 [info ] [Thread-3 (]: 13 of 16 PASS not_null_stock_analytics_mart_date ............................... [[32mPASS[0m in 0.64s]
[0m05:22:49.853871 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:22:49.868835 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:49.871128 [debug] [Thread-4 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f (execute): 05:22:49.485176 => 05:22:49.870921
[0m05:22:49.871541 [debug] [Thread-4 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f: Close
[0m05:22:49.914787 [info ] [Thread-1 (]: 14 of 16 PASS not_null_stock_analytics_mart_symbol ............................. [[32mPASS[0m in 0.63s]
[0m05:22:49.915649 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:22:49.989310 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:22:49.993972 [debug] [Thread-2 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740 (execute): 05:22:49.479196 => 05:22:49.993404
[0m05:22:49.999819 [info ] [Thread-4 (]: 16 of 16 PASS source_not_null_raw_stock_data_lab_symbol ........................ [[32mPASS[0m in 0.52s]
[0m05:22:50.000653 [debug] [Thread-2 (]: On test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740: Close
[0m05:22:50.001514 [debug] [Thread-4 (]: Finished running node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:22:50.120799 [info ] [Thread-2 (]: 15 of 16 PASS source_not_null_raw_stock_data_lab_date .......................... [[32mPASS[0m in 0.69s]
[0m05:22:50.123071 [debug] [Thread-2 (]: Finished running node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:22:50.126979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:22:50.127905 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b' was properly closed.
[0m05:22:50.128442 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0' was properly closed.
[0m05:22:50.128893 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f' was properly closed.
[0m05:22:50.129401 [debug] [MainThread]: Connection 'test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740' was properly closed.
[0m05:22:50.129988 [info ] [MainThread]: 
[0m05:22:50.131388 [info ] [MainThread]: Finished running 16 tests in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m05:22:50.134500 [debug] [MainThread]: Command end result
[0m05:22:50.148030 [info ] [MainThread]: 
[0m05:22:50.148755 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:22:50.149042 [info ] [MainThread]: 
[0m05:22:50.149345 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m05:22:50.150405 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.7483182, "process_user_time": 2.863204, "process_kernel_time": 0.129593, "process_mem_max_rss": "219656", "process_out_blocks": "2551", "process_in_blocks": "0"}
[0m05:22:50.150897 [debug] [MainThread]: Command `dbt test` succeeded at 05:22:50.150778 after 3.75 seconds
[0m05:22:50.151329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5cc8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84414c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa617fef0>]}
[0m05:22:50.151748 [debug] [MainThread]: Flushing usage events
[0m05:22:53.444177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87865490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87867d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff878652e0>]}


============================== 05:22:53.447234 | 63929324-fb13-414a-967f-7b237a7063f2 ==============================
[0m05:22:53.447234 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:22:53.447732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:22:53.785734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63929324-fb13-414a-967f-7b237a7063f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62892660>]}
[0m05:22:53.815837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63929324-fb13-414a-967f-7b237a7063f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68240f80>]}
[0m05:22:53.816190 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m05:22:53.821106 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:22:53.847460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:22:53.847701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:22:53.850693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63929324-fb13-414a-967f-7b237a7063f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87860d10>]}
[0m05:22:53.859202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63929324-fb13-414a-967f-7b237a7063f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62416f00>]}
[0m05:22:53.859508 [info ] [MainThread]: Found 4 models, 1 snapshot, 16 tests, 1 source, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m05:22:53.859944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63929324-fb13-414a-967f-7b237a7063f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63e58a70>]}
[0m05:22:53.860917 [info ] [MainThread]: 
[0m05:22:53.861473 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:22:53.862407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL'
[0m05:22:53.868158 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL"
[0m05:22:53.868377 [debug] [ThreadPool]: On list_USER_DB_JACKAL: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL"} */
show terse schemas in database USER_DB_JACKAL
    limit 10000
[0m05:22:53.868535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:54.282581 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m05:22:54.284552 [debug] [ThreadPool]: On list_USER_DB_JACKAL: Close
[0m05:22:54.414971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL, now create_USER_DB_JACKAL_snapshots)
[0m05:22:54.416486 [debug] [ThreadPool]: Creating schema "database: "USER_DB_JACKAL"
schema: "snapshots"
"
[0m05:22:54.425863 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_JACKAL_snapshots"
[0m05:22:54.426934 [debug] [ThreadPool]: On create_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_USER_DB_JACKAL_snapshots"} */
create schema if not exists USER_DB_JACKAL.snapshots
[0m05:22:54.427637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:22:54.813987 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:54.816242 [debug] [ThreadPool]: On create_USER_DB_JACKAL_snapshots: Close
[0m05:22:54.952329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_USER_DB_JACKAL_snapshots, now list_USER_DB_JACKAL_ANALYTICS_staging)
[0m05:22:54.953966 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_snapshots'
[0m05:22:54.961737 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_snapshots"
[0m05:22:54.962026 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_staging"
[0m05:22:54.962432 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_snapshots"} */
show terse objects in USER_DB_JACKAL.snapshots limit 10000
[0m05:22:54.963016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_marts'
[0m05:22:54.963413 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_staging"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_staging limit 10000
[0m05:22:54.963993 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_intermediate'
[0m05:22:54.964384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:54.966010 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_marts"
[0m05:22:54.966313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:22:54.967740 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m05:22:54.968975 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_marts"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_marts limit 10000
[0m05:22:54.970259 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_intermediate"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_intermediate limit 10000
[0m05:22:54.970578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:54.970905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:55.319544 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:55.322916 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m05:22:55.333851 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:22:55.336560 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m05:22:55.360772 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m05:22:55.363521 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: Close
[0m05:22:55.384005 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:22:55.386828 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m05:22:55.519466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63929324-fb13-414a-967f-7b237a7063f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff875cf830>]}
[0m05:22:55.520487 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:22:55.521313 [info ] [MainThread]: 
[0m05:22:55.529053 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.stock_prices_snapshot
[0m05:22:55.529540 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_prices_snapshot .......................... [RUN]
[0m05:22:55.530214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_snapshots, now snapshot.stock_analytics.stock_prices_snapshot)
[0m05:22:55.530544 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.stock_prices_snapshot
[0m05:22:55.540814 [debug] [Thread-1 (]: Timing info for snapshot.stock_analytics.stock_prices_snapshot (compile): 05:22:55.534182 => 05:22:55.540622
[0m05:22:55.541112 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.stock_prices_snapshot
[0m05:22:55.572064 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analytics.stock_prices_snapshot"
[0m05:22:55.573662 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.stock_prices_snapshot"
[0m05:22:55.573992 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.stock_prices_snapshot"} */
create or replace transient table USER_DB_JACKAL.snapshots.stock_prices_snapshot
         as
        (

    select *,
        md5(coalesce(cast(symbol || date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        



SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM USER_DB_JACKAL.RAW.stock_data_lab

    ) sbq



        );
[0m05:22:55.574233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:22:56.408056 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:22:56.429527 [debug] [Thread-1 (]: Timing info for snapshot.stock_analytics.stock_prices_snapshot (execute): 05:22:55.541296 => 05:22:56.429325
[0m05:22:56.430039 [debug] [Thread-1 (]: On snapshot.stock_analytics.stock_prices_snapshot: Close
[0m05:22:56.531575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63929324-fb13-414a-967f-7b237a7063f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6194dbb0>]}
[0m05:22:56.532432 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.stock_prices_snapshot .......................... [[32mSUCCESS 1[0m in 1.00s]
[0m05:22:56.533254 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.stock_prices_snapshot
[0m05:22:56.534876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:22:56.535186 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL_ANALYTICS_staging' was properly closed.
[0m05:22:56.535493 [debug] [MainThread]: Connection 'snapshot.stock_analytics.stock_prices_snapshot' was properly closed.
[0m05:22:56.535806 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL_ANALYTICS_marts' was properly closed.
[0m05:22:56.536073 [debug] [MainThread]: Connection 'list_USER_DB_JACKAL_ANALYTICS_intermediate' was properly closed.
[0m05:22:56.536402 [info ] [MainThread]: 
[0m05:22:56.536883 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m05:22:56.537416 [debug] [MainThread]: Command end result
[0m05:22:56.545509 [info ] [MainThread]: 
[0m05:22:56.545834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:22:56.546140 [info ] [MainThread]: 
[0m05:22:56.546398 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:22:56.547091 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 3.1238658, "process_user_time": 2.490966, "process_kernel_time": 0.10957, "process_mem_max_rss": "219488", "process_out_blocks": "2421", "process_in_blocks": "0"}
[0m05:22:56.547478 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:22:56.547383 after 3.12 seconds
[0m05:22:56.547773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8789d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61923a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff626e5310>]}
[0m05:22:56.548053 [debug] [MainThread]: Flushing usage events
[0m05:22:59.523776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7e0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae8f1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae8f18e0>]}


============================== 05:22:59.526758 | 1e0b85ba-665a-4ff3-a7cb-2c693ff314da ==============================
[0m05:22:59.526758 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:22:59.527064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:22:59.864282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e0b85ba-665a-4ff3-a7cb-2c693ff314da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d8ef080>]}
[0m05:22:59.894201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e0b85ba-665a-4ff3-a7cb-2c693ff314da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d897020>]}
[0m05:22:59.894552 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m05:22:59.899437 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:22:59.921661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:22:59.921911 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:22:59.924542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e0b85ba-665a-4ff3-a7cb-2c693ff314da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d567f20>]}
[0m05:22:59.926694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e0b85ba-665a-4ff3-a7cb-2c693ff314da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d38ecf0>]}
[0m05:22:59.926963 [info ] [MainThread]: Found 4 models, 1 snapshot, 16 tests, 1 source, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m05:22:59.927342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e0b85ba-665a-4ff3-a7cb-2c693ff314da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e467170>]}
[0m05:22:59.928485 [info ] [MainThread]: 
[0m05:22:59.929006 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:22:59.929612 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_marts'
[0m05:22:59.935657 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_marts"
[0m05:22:59.936031 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_intermediate'
[0m05:22:59.936204 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_marts"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_marts limit 10000
[0m05:22:59.936602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_snapshots'
[0m05:22:59.937682 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_intermediate"
[0m05:22:59.938001 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_JACKAL_ANALYTICS_staging'
[0m05:22:59.938211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:59.939206 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_snapshots"
[0m05:22:59.939431 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_intermediate"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_intermediate limit 10000
[0m05:22:59.940363 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_JACKAL_ANALYTICS_staging"
[0m05:22:59.941617 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_snapshots"} */
show terse objects in USER_DB_JACKAL.snapshots limit 10000
[0m05:22:59.941848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:59.942084 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_JACKAL_ANALYTICS_staging"} */
show terse objects in USER_DB_JACKAL.ANALYTICS_staging limit 10000
[0m05:22:59.942280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:59.943220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:23:00.314409 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:00.316446 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_marts: Close
[0m05:23:00.317197 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:23:00.319333 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_intermediate: Close
[0m05:23:00.330704 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:00.331841 [debug] [ThreadPool]: On list_USER_DB_JACKAL_snapshots: Close
[0m05:23:00.340680 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:00.341809 [debug] [ThreadPool]: On list_USER_DB_JACKAL_ANALYTICS_staging: Close
[0m05:23:00.457053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e0b85ba-665a-4ff3-a7cb-2c693ff314da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d603dd0>]}
[0m05:23:00.458439 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:23:00.459788 [info ] [MainThread]: 
[0m05:23:00.471225 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_stock_data
[0m05:23:00.471678 [debug] [Thread-2 (]: Began running node snapshot.stock_analytics.stock_prices_snapshot
[0m05:23:00.472072 [debug] [Thread-3 (]: Began running node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:23:00.472773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_staging, now model.stock_analytics.stg_stock_data)
[0m05:23:00.473183 [debug] [Thread-4 (]: Began running node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:23:00.474438 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_snapshots, now snapshot.stock_analytics.stock_prices_snapshot)
[0m05:23:00.475104 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_intermediate, now test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740)
[0m05:23:00.475513 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_stock_data
[0m05:23:00.476123 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_USER_DB_JACKAL_ANALYTICS_marts, now test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f)
[0m05:23:00.476490 [debug] [Thread-2 (]: Began compiling node snapshot.stock_analytics.stock_prices_snapshot
[0m05:23:00.476865 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:23:00.483749 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_stock_data"
[0m05:23:00.484040 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:23:00.486416 [debug] [Thread-2 (]: Timing info for snapshot.stock_analytics.stock_prices_snapshot (compile): 05:23:00.484273 => 05:23:00.486232
[0m05:23:00.493005 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740"
[0m05:23:00.495494 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f"
[0m05:23:00.495799 [debug] [Thread-2 (]: Began executing node snapshot.stock_analytics.stock_prices_snapshot
[0m05:23:00.496315 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stg_stock_data (compile): 05:23:00.477143 => 05:23:00.496187
[0m05:23:00.496680 [debug] [Thread-2 (]: Timing info for snapshot.stock_analytics.stock_prices_snapshot (execute): 05:23:00.496515 => 05:23:00.496530
[0m05:23:00.497115 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_stock_data
[0m05:23:00.497452 [debug] [Thread-4 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f (compile): 05:23:00.493401 => 05:23:00.497341
[0m05:23:00.497693 [debug] [Thread-3 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740 (compile): 05:23:00.486657 => 05:23:00.497576
[0m05:23:00.498200 [debug] [Thread-2 (]: Finished running node snapshot.stock_analytics.stock_prices_snapshot
[0m05:23:00.498479 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stg_stock_data (execute): 05:23:00.498370 => 05:23:00.498376
[0m05:23:00.499501 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_stock_data
[0m05:23:00.498949 [debug] [Thread-3 (]: Began executing node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:23:00.498706 [debug] [Thread-4 (]: Began executing node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:23:00.499928 [debug] [Thread-3 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740 (execute): 05:23:00.499822 => 05:23:00.499825
[0m05:23:00.500135 [debug] [Thread-2 (]: Began running node model.stock_analytics.moving_averages
[0m05:23:00.500312 [debug] [Thread-1 (]: Began running node model.stock_analytics.rsi
[0m05:23:00.500574 [debug] [Thread-4 (]: Timing info for test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f (execute): 05:23:00.500477 => 05:23:00.500481
[0m05:23:00.501008 [debug] [Thread-3 (]: Finished running node test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740
[0m05:23:00.501364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.stock_analytics.stock_prices_snapshot, now model.stock_analytics.moving_averages)
[0m05:23:00.501700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_stock_data, now model.stock_analytics.rsi)
[0m05:23:00.502150 [debug] [Thread-4 (]: Finished running node test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f
[0m05:23:00.502391 [debug] [Thread-3 (]: Began running node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:23:00.502627 [debug] [Thread-2 (]: Began compiling node model.stock_analytics.moving_averages
[0m05:23:00.502853 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.rsi
[0m05:23:00.503093 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:23:00.503440 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.source_not_null_raw_stock_data_lab_date.e78bdb2740, now test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976)
[0m05:23:00.505138 [debug] [Thread-2 (]: Writing injected SQL for node "model.stock_analytics.moving_averages"
[0m05:23:00.506781 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.rsi"
[0m05:23:00.507200 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.source_not_null_raw_stock_data_lab_symbol.58449d203f, now test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db)
[0m05:23:00.507454 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:23:00.507886 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:23:00.511684 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976"
[0m05:23:00.513703 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db"
[0m05:23:00.513941 [debug] [Thread-2 (]: Timing info for model.stock_analytics.moving_averages (compile): 05:23:00.503602 => 05:23:00.513832
[0m05:23:00.514264 [debug] [Thread-1 (]: Timing info for model.stock_analytics.rsi (compile): 05:23:00.505297 => 05:23:00.514158
[0m05:23:00.514596 [debug] [Thread-2 (]: Began executing node model.stock_analytics.moving_averages
[0m05:23:00.514868 [debug] [Thread-1 (]: Began executing node model.stock_analytics.rsi
[0m05:23:00.515104 [debug] [Thread-3 (]: Timing info for test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976 (compile): 05:23:00.508046 => 05:23:00.515002
[0m05:23:00.515317 [debug] [Thread-2 (]: Timing info for model.stock_analytics.moving_averages (execute): 05:23:00.515217 => 05:23:00.515222
[0m05:23:00.515490 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db (compile): 05:23:00.511920 => 05:23:00.515412
[0m05:23:00.516516 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:23:00.515894 [debug] [Thread-3 (]: Began executing node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:23:00.516313 [debug] [Thread-2 (]: Finished running node model.stock_analytics.moving_averages
[0m05:23:00.515708 [debug] [Thread-1 (]: Timing info for model.stock_analytics.rsi (execute): 05:23:00.515626 => 05:23:00.515629
[0m05:23:00.517556 [debug] [Thread-1 (]: Finished running node model.stock_analytics.rsi
[0m05:23:00.516937 [debug] [Thread-3 (]: Timing info for test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976 (execute): 05:23:00.516853 => 05:23:00.516856
[0m05:23:00.517145 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:23:00.516730 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db (execute): 05:23:00.516639 => 05:23:00.516642
[0m05:23:00.519092 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db
[0m05:23:00.518350 [debug] [Thread-3 (]: Finished running node test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976
[0m05:23:00.518684 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stock_analytics.moving_averages, now test.stock_analytics.not_null_stg_stock_data_date.96adead1a7)
[0m05:23:00.517797 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:23:00.520098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.rsi, now test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e)
[0m05:23:00.519567 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:23:00.519797 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:23:00.519308 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:23:00.522754 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_close.c8058ec9db, now test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81)
[0m05:23:00.520619 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_stg_stock_data_symbol__AAPL__GOOG.6e7371c976, now test.stock_analytics.not_null_moving_averages_date.2eb91e4683)
[0m05:23:00.522433 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_date.96adead1a7"
[0m05:23:00.520277 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:23:00.522929 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:23:00.523108 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:23:00.524828 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e"
[0m05:23:00.529458 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81"
[0m05:23:00.531088 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_moving_averages_date.2eb91e4683"
[0m05:23:00.531375 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_date.96adead1a7 (compile): 05:23:00.520789 => 05:23:00.531288
[0m05:23:00.531901 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:23:00.532156 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_date.96adead1a7 (execute): 05:23:00.532060 => 05:23:00.532065
[0m05:23:00.532355 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e (compile): 05:23:00.523291 => 05:23:00.532263
[0m05:23:00.532743 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_date.96adead1a7
[0m05:23:00.533079 [debug] [Thread-4 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81 (compile): 05:23:00.524964 => 05:23:00.532917
[0m05:23:00.533234 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_moving_averages_date.2eb91e4683 (compile): 05:23:00.529619 => 05:23:00.533164
[0m05:23:00.533366 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:23:00.533570 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:23:00.533786 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:23:00.533976 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:23:00.534215 [debug] [Thread-1 (]: Timing info for test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e (execute): 05:23:00.534118 => 05:23:00.534122
[0m05:23:00.534719 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_date.96adead1a7, now test.stock_analytics.not_null_moving_averages_symbol.153f328246)
[0m05:23:00.535694 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:23:00.535131 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_moving_averages_date.2eb91e4683 (execute): 05:23:00.535048 => 05:23:00.535051
[0m05:23:00.535511 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e
[0m05:23:00.534925 [debug] [Thread-4 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81 (execute): 05:23:00.534842 => 05:23:00.534845
[0m05:23:00.538449 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81
[0m05:23:00.537854 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_moving_averages_date.2eb91e4683
[0m05:23:00.538066 [debug] [Thread-1 (]: Began running node model.stock_analytics.stock_analytics_mart
[0m05:23:00.537431 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_moving_averages_symbol.153f328246"
[0m05:23:00.538643 [debug] [Thread-4 (]: Began running node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:23:00.538880 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:23:00.539172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_stock_data_symbol.60042b229e, now model.stock_analytics.stock_analytics_mart)
[0m05:23:00.539517 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_moving_averages_symbol__date.156d0bae81, now test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830)
[0m05:23:00.540022 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_moving_averages_date.2eb91e4683, now test.stock_analytics.not_null_rsi_date.da56752005)
[0m05:23:00.540306 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_moving_averages_symbol.153f328246 (compile): 05:23:00.535816 => 05:23:00.540214
[0m05:23:00.540464 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stock_analytics_mart
[0m05:23:00.540648 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:23:00.540836 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:23:00.540998 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:23:00.542367 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stock_analytics_mart"
[0m05:23:00.543985 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830"
[0m05:23:00.545535 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_date.da56752005"
[0m05:23:00.545812 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_moving_averages_symbol.153f328246 (execute): 05:23:00.545721 => 05:23:00.545725
[0m05:23:00.546462 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_moving_averages_symbol.153f328246
[0m05:23:00.546672 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:23:00.547005 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_moving_averages_symbol.153f328246, now test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899)
[0m05:23:00.547255 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stock_analytics_mart (compile): 05:23:00.541117 => 05:23:00.547162
[0m05:23:00.547432 [debug] [Thread-4 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830 (compile): 05:23:00.542512 => 05:23:00.547354
[0m05:23:00.548081 [debug] [Thread-4 (]: Began executing node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:23:00.547757 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_rsi_date.da56752005 (compile): 05:23:00.544126 => 05:23:00.547677
[0m05:23:00.547903 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stock_analytics_mart
[0m05:23:00.547554 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:23:00.548306 [debug] [Thread-4 (]: Timing info for test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830 (execute): 05:23:00.548218 => 05:23:00.548222
[0m05:23:00.548473 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:23:00.548678 [debug] [Thread-1 (]: Timing info for model.stock_analytics.stock_analytics_mart (execute): 05:23:00.548589 => 05:23:00.548593
[0m05:23:00.550493 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899"
[0m05:23:00.550847 [debug] [Thread-4 (]: Finished running node test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830
[0m05:23:00.551046 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_rsi_date.da56752005 (execute): 05:23:00.550968 => 05:23:00.550971
[0m05:23:00.551426 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stock_analytics_mart
[0m05:23:00.551685 [debug] [Thread-4 (]: Began running node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:23:00.552744 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.stock_analytics.dbt_utils_unique_combination_of_columns_rsi_symbol__date.e0266b1830, now test.stock_analytics.not_null_rsi_symbol.21add3cf05)
[0m05:23:00.552429 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899 (compile): 05:23:00.548950 => 05:23:00.552340
[0m05:23:00.552110 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_rsi_date.da56752005
[0m05:23:00.552933 [debug] [Thread-4 (]: Began compiling node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:23:00.553193 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:23:00.553385 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:23:00.553589 [debug] [Thread-3 (]: Began running node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:23:00.555138 [debug] [Thread-4 (]: Writing injected SQL for node "test.stock_analytics.not_null_rsi_symbol.21add3cf05"
[0m05:23:00.555443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stock_analytics_mart, now test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999)
[0m05:23:00.555674 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899 (execute): 05:23:00.555587 => 05:23:00.555590
[0m05:23:00.556250 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_date.da56752005, now test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b)
[0m05:23:00.556496 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:23:00.556886 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899
[0m05:23:00.557084 [debug] [Thread-3 (]: Began compiling node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:23:00.557410 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_rsi_symbol.21add3cf05 (compile): 05:23:00.553723 => 05:23:00.557324
[0m05:23:00.559885 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999"
[0m05:23:00.560090 [debug] [Thread-2 (]: Began running node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:23:00.561722 [debug] [Thread-3 (]: Writing injected SQL for node "test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b"
[0m05:23:00.561890 [debug] [Thread-4 (]: Began executing node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:23:00.562257 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_rsi_rsi_14.aeb44c6899, now test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0)
[0m05:23:00.562552 [debug] [Thread-4 (]: Timing info for test.stock_analytics.not_null_rsi_symbol.21add3cf05 (execute): 05:23:00.562464 => 05:23:00.562468
[0m05:23:00.562803 [debug] [Thread-1 (]: Timing info for test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999 (compile): 05:23:00.557505 => 05:23:00.562704
[0m05:23:00.562958 [debug] [Thread-2 (]: Began compiling node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:23:00.563343 [debug] [Thread-4 (]: Finished running node test.stock_analytics.not_null_rsi_symbol.21add3cf05
[0m05:23:00.563499 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b (compile): 05:23:00.560221 => 05:23:00.563422
[0m05:23:00.566147 [debug] [Thread-3 (]: Began executing node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:23:00.565887 [debug] [Thread-2 (]: Writing injected SQL for node "test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0"
[0m05:23:00.563729 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:23:00.566334 [debug] [Thread-3 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b (execute): 05:23:00.566261 => 05:23:00.566264
[0m05:23:00.566585 [debug] [Thread-1 (]: Timing info for test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999 (execute): 05:23:00.566496 => 05:23:00.566499
[0m05:23:00.566956 [debug] [Thread-3 (]: Finished running node test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b
[0m05:23:00.567332 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999
[0m05:23:00.567575 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0 (compile): 05:23:00.563850 => 05:23:00.567493
[0m05:23:00.567818 [debug] [Thread-2 (]: Began executing node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:23:00.568030 [debug] [Thread-2 (]: Timing info for test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0 (execute): 05:23:00.567932 => 05:23:00.567935
[0m05:23:00.568513 [debug] [Thread-2 (]: Finished running node test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0
[0m05:23:00.569152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:23:00.569329 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_rsi_symbol.21add3cf05' was properly closed.
[0m05:23:00.569469 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stock_analytics_mart_date.e0821da83b' was properly closed.
[0m05:23:00.569582 [debug] [MainThread]: Connection 'test.stock_analytics.not_null_stock_analytics_mart_symbol.501b5f96d0' was properly closed.
[0m05:23:00.569691 [debug] [MainThread]: Connection 'test.stock_analytics.accepted_values_stock_analytics_mart_combined_signal__STRONG_BUY__BUY__HOLD__SELL__STRONG_SELL__NEUTRAL.02e040a999' was properly closed.
[0m05:23:00.570601 [debug] [MainThread]: Command end result
[0m05:23:00.576910 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m05:23:00.577093 [info ] [MainThread]: Building catalog
[0m05:23:00.578197 [debug] [ThreadPool]: Acquiring new snowflake connection 'USER_DB_JACKAL.information_schema'
[0m05:23:00.583059 [debug] [ThreadPool]: Using snowflake connection "USER_DB_JACKAL.information_schema"
[0m05:23:00.583277 [debug] [ThreadPool]: On USER_DB_JACKAL.information_schema: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "USER_DB_JACKAL.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from USER_DB_JACKAL.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('ANALYTICS_intermediate')
                    and upper("table_name") = upper('moving_averages')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('stock_data_lab')
                )
             or 
                (
                    upper("table_schema") = upper('ANALYTICS_intermediate')
                    and upper("table_name") = upper('rsi')
                )
             or 
                (
                    upper("table_schema") = upper('snapshots')
                    and upper("table_name") = upper('stock_prices_snapshot')
                )
             or 
                (
                    upper("table_schema") = upper('ANALYTICS_marts')
                    and upper("table_name") = upper('stock_analytics_mart')
                )
             or 
                (
                    upper("table_schema") = upper('ANALYTICS_staging')
                    and upper("table_name") = upper('stg_stock_data')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from USER_DB_JACKAL.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('ANALYTICS_intermediate')
                    and upper("table_name") = upper('moving_averages')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('stock_data_lab')
                )
             or 
                (
                    upper("table_schema") = upper('ANALYTICS_intermediate')
                    and upper("table_name") = upper('rsi')
                )
             or 
                (
                    upper("table_schema") = upper('snapshots')
                    and upper("table_name") = upper('stock_prices_snapshot')
                )
             or 
                (
                    upper("table_schema") = upper('ANALYTICS_marts')
                    and upper("table_name") = upper('stock_analytics_mart')
                )
             or 
                (
                    upper("table_schema") = upper('ANALYTICS_staging')
                    and upper("table_name") = upper('stg_stock_data')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m05:23:00.583498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:23:03.371481 [debug] [ThreadPool]: SQL status: SUCCESS 61 in 3.0 seconds
[0m05:23:03.387147 [debug] [ThreadPool]: On USER_DB_JACKAL.information_schema: Close
[0m05:23:03.538317 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m05:23:03.540432 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.0373116, "process_user_time": 2.433875, "process_kernel_time": 0.114805, "process_mem_max_rss": "219488", "process_out_blocks": "5537", "process_in_blocks": "0"}
[0m05:23:03.541049 [debug] [MainThread]: Command `dbt docs generate` succeeded at 05:23:03.540920 after 4.04 seconds
[0m05:23:03.541400 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m05:23:03.541653 [debug] [MainThread]: Connection 'USER_DB_JACKAL.information_schema' was properly closed.
[0m05:23:03.541999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c71b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d490290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1df290>]}
[0m05:23:03.542355 [debug] [MainThread]: Flushing usage events
